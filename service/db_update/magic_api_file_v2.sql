/*
 Navicat Premium Data Transfer

 Source Server         : 本地autoo-mb
 Source Server Type    : MySQL
 Source Server Version : 80019 (8.0.19)
 Source Host           : localhost:23306
 Source Schema         : autoo

 Target Server Type    : MySQL
 Target Server Version : 80019 (8.0.19)
 File Encoding         : 65001

 Date: 14/07/2024 17:54:09
*/

SET NAMES utf8mb4;
SET FOREIGN_KEY_CHECKS = 0;

-- ----------------------------
-- Table structure for magic_api_file_v2
-- ----------------------------
DROP TABLE IF EXISTS `magic_api_file_v2`;
CREATE TABLE `magic_api_file_v2` (
  `file_path` varchar(512) NOT NULL,
  `file_content` mediumtext,
  PRIMARY KEY (`file_path`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

-- ----------------------------
-- Records of magic_api_file_v2
-- ----------------------------
BEGIN;
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/OSS/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/OSS/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"a73658de49cc4c1683e807418e6a88ab\",\n  \"name\" : \"OSS\",\n  \"type\" : \"api\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/oss\",\n  \"createTime\" : 1719394266216,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/OSS/StsService.ms', '{\n  \"properties\" : { },\n  \"id\" : \"83fdef23ec05468a87e2271170f15823\",\n  \"script\" : null,\n  \"groupId\" : \"a73658de49cc4c1683e807418e6a88ab\",\n  \"name\" : \"StsService\",\n  \"createTime\" : 1719394266405,\n  \"updateTime\" : 1680320197000,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sts/service\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport com.aliyuncs.DefaultAcsClient;\nimport com.aliyuncs.auth.sts.AssumeRoleRequest;\nimport com.aliyuncs.auth.sts.AssumeRoleResponse;\nimport com.aliyuncs.exceptions.ClientException;\nimport com.aliyuncs.http.MethodType;\nimport com.aliyuncs.profile.DefaultProfile;\nimport com.aliyuncs.profile.IClientProfile;\nimport response\nimport env\n\nif(env.get(\'oss.enable\') == \'false\'){\n    exit 500, \'使用oss上传组件前请先配置oss信息\'\n}\n\n// STS接入地址，例如sts.cn-hangzhou.aliyuncs.com。\nString endpoint = env.get(\"oss.endpoint\");\n// 填写步骤1生成的访问密钥AccessKey ID和AccessKey Secret。\nString accessKeyId = env.get(\"oss.accessKeyId\");\nString accessKeySecret = env.get(\"oss.accessKeySecret\");\n// 填写步骤3获取的角色ARN。\nString roleArn = env.get(\"oss.roleArn\");\n// 自定义角色会话名称，用来区分不同的令牌，例如可填写为SessionTest。\nString roleSessionName = env.get(\"oss.roleSessionName\");\n\n// regionId表示RAM的地域ID。以华东1（杭州）地域为例，regionID填写为cn-hangzhou。也可以保留默认值，默认值为空字符串（\"\"）。\nString regionId = \"\";\n// 添加endpoint。适用于Java SDK 3.12.0及以上版本。\nDefaultProfile.addEndpoint(regionId, \"Sts\", endpoint);\n// 构造default profile。\nIClientProfile profile = DefaultProfile.getProfile(regionId, accessKeyId, accessKeySecret);\n// 构造client。\nDefaultAcsClient client = new DefaultAcsClient(profile);\nAssumeRoleRequest request = new AssumeRoleRequest();\n// 适用于Java SDK 3.12.0及以上版本。\nrequest.setSysMethod(MethodType.POST);\nrequest.setRoleArn(roleArn);\nrequest.setRoleSessionName(roleSessionName);\nrequest.setDurationSeconds(43200L); // 设置临时访问凭证的有效时间为3600秒。\nAssumeRoleResponse assumeRoleResponse = client.getAcsResponse(request);\nreturn {\n    accessKeyId: assumeRoleResponse.getCredentials().getAccessKeyId(),\n    accessKeySecret: assumeRoleResponse.getCredentials().getAccessKeySecret(),\n    stsToken: assumeRoleResponse.getCredentials().getSecurityToken()\n}\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"8d60ba6788ef4a75b93f3c77683c7f89\",\n  \"name\" : \"数据管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/data\",\n  \"createTime\" : 1719394266230,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"7bdcc43555b9419caba2ee722e1aa2d3\",\n  \"name\" : \"测试生成\",\n  \"type\" : \"api\",\n  \"parentId\" : \"8d60ba6788ef4a75b93f3c77683c7f89\",\n  \"path\" : \"/test\",\n  \"createTime\" : 1719394266239,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"8254da8907904c418ecc988750601446\",\n  \"script\" : null,\n  \"groupId\" : \"7bdcc43555b9419caba2ee722e1aa2d3\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266413,\n  \"updateTime\" : null,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"data:test:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : null,\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\'t_data_test\').primary(\'id\').saveOrUpdate(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"566a8662385a42d381214b971873e98c\",\n  \"script\" : null,\n  \"groupId\" : \"7bdcc43555b9419caba2ee722e1aa2d3\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266420,\n  \"updateTime\" : null,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"data:test:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : null,\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id,name,sex,head_portrait,remarks from t_data_test where 1=1\n    ?{name, and name like concat(\'%\',#{name},\'%\') }\n    ?{sex, and sex = #{sex} }\n    ?{headPortrait, and head_portrait in(#{headPortrait.split(\',\')}) }\n    ?{remarks, and remarks <= #{remarks} }\n    and is_del = 0\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"dbd7523d57fd4958acd9be7e5c66cc9a\",\n  \"script\" : null,\n  \"groupId\" : \"7bdcc43555b9419caba2ee722e1aa2d3\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266430,\n  \"updateTime\" : null,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"data:test:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : null,\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\'t_data_test\').logic().where().eq(\'id\', id).delete()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/数据管理/测试生成/详情.ms', '{\n  \"properties\" : { },\n  \"id\" : \"25ba2ad6bbb14aa0992a1ca2c75140f0\",\n  \"script\" : null,\n  \"groupId\" : \"7bdcc43555b9419caba2ee722e1aa2d3\",\n  \"name\" : \"详情\",\n  \"createTime\" : 1719394266435,\n  \"updateTime\" : 1718039288091,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/get\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"data:test:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectOne(\"\"\"\n    select id,name,sex,head_portrait,remarks from t_data_test where id = #{id}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"文件\",\n  \"type\" : \"api\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/file\",\n  \"createTime\" : 1719394266248,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/office前置操作.ms', '{\n  \"properties\" : { },\n  \"id\" : \"e1380722a6f442f6b1380fb5cb245806\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"office前置操作\",\n  \"createTime\" : 1719394266439,\n  \"updateTime\" : 1718288307774,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/preUrl\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"documentUrl\",\n    \"value\" : \"2024-06-10%2F37af42bf7f604791b6ae5c9c7bc4b357.xlsx\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ {\n    \"name\" : \"token\",\n    \"value\" : \"fbd216e7-a6a3-4823-93b8-c25395646605\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"token\\\": \\\"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkb2N1bWVudCI6eyJ1cmwiOiJodHRwOi8vMTkyLjE2OC4xMDAuMTM0OjkwMDAvYXV0b28vMjAyNC0wNi0xMCUyNTJGMzdhZjQyYmY3ZjYwNDc5MWI2YWU1YzljN2JjNGIzNTcueGxzeD9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPWF1dG9vJTJGMjAyNDA2MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjEzVDA4MzE1NlomWC1BbXotRXhwaXJlcz02MDQ4MDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JlgtQW16LVNpZ25hdHVyZT0zNzk2NmMwMzliZDg3MmI0ZWRlNmViZmE0NWFkMjNhODQ2ZTg1ZWQyN2JiNjE4MDA0NjUyN2Q3ZTg4MWRkZTI1In0sImVkaXRvckNvbmZpZyI6eyJ1c2VyIjp7fX0sImV2ZW50cyI6e319.Uemd04kQ010w1X5wCJcvJ691zTVP0PzKTJZtFJre9PE\\\",\\n        \\\"url\\\": \\\"http://192.168.100.134:9000/autoo/2024-06-10%252F37af42bf7f604791b6ae5c9c7bc4b357.xlsx?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=autoo%2F20240613%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240613T083156Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=37966c039bd872b4ede6ebfa45ad23a846e85ed27bb6180046527d7e881dde25\\\"\\n    },\\n    \\\"timestamp\\\": 1718267516766,\\n    \\\"executeTime\\\": 108\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"token\",\n        \"value\" : \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkb2N1bWVudCI6eyJ1cmwiOiJodHRwOi8vbG9jYWxob3N0OjkwMDAvYXV0b28vMjAyNC0wNi0xMCUyNTJGMzdhZjQyYmY3ZjYwNDc5MWI2YWU1YzljN2JjNGIzNTcueGxzeD9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPWF1dG9vJTJGMjAyNDA2MTMlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjEzVDA4MjM1OVomWC1BbXotRXhwaXJlcz02MDQ4MDAmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JlgtQW16LVNpZ25hdHVyZT1lNDI1NjBjNTA3NDFiMjQzNTg0NzhiYTM0ZmRlNDA1MzViZDU2OGM5NjIyMjQxNGY4ZTBhNmNjYzE5N2I0NDkxIn0sImVkaXRvckNvbmZpZyI6eyJ1c2VyIjp7fX0sImV2ZW50cyI6e319.AlSTE17dTnRUQf5gH2nbLOe15ctTx8HVEftfz1uzw4E\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"url\",\n        \"value\" : \"http://localhost:9000/autoo/2024-06-10%252F37af42bf7f604791b6ae5c9c7bc4b357.xlsx?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=autoo%2F20240613%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240613T082359Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=e42560c50741b24358478ba34fde40535bd568c96222414f8e0a6ccc197b4491\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1718267039802\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"192\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicboot.utils.MinioUtil;\nimport cn.hutool.jwt.JWTUtil;\nimport log\n\nvar secret = \"KrGjwbMl00gy70BYQvyi\"\nvar config = {\n    \"document\": {\n        \"fileType\": documentFileType,\n        \"title\": documentTitle,\n        \"key\": documentKey,\n        \"url\": documentUrl\n    },\n  //  \"documentType\": documentType,\n    \"editorConfig\": {\n        \"mode\": editorConfigMode,\n        \"callbackUrl\": editorConfigCustomizationCallbackUrl,\n        \"lang\": editorConfigLang,\n        \"user\": {\n            \"id\": editorConfigUserId,\n            \"name\": editorConfigUserName\n        },\n    },\n    \"events\": {\n        \"onDocumentReady\": eventsOnDocumentReady\n    }\n};\n\nvar token = JWTUtil.createToken(config, secret.getBytes())\nreturn {\n    token: token,\n}\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/保存文件内容.ms', '{\n  \"properties\" : { },\n  \"id\" : \"990c56d25e114498b78c82a18e183f8f\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"保存文件内容\",\n  \"createTime\" : 1719394266502,\n  \"updateTime\" : 1718100882862,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/content/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件ID\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"content\",\n    \"value\" : null,\n    \"description\" : \"Request Payload 提交  content: 内容\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.ObjectUtil\nimport log;\nimport org.ssssssss.magicboot.utils.MinioUtil\nimport cn.hutool.core.io.FileUtil;\nimport org.ssssssss.magicboot.utils.FileUtils;\nimport cn.hutool.core.util.StrUtil;\nimport cn.hutool.http.HtmlUtil;\nimport \'@/file/permissionFind\' as permissionFind;\nimport java.io.InputStream;\nimport cn.dev33.satoken.stp.StpUtil;\n\n// var userId = 6\nvar userId = StpUtil.getLoginId()\nvar id = body.id;\nvar content = body.content::json\nlog.info(\"content is \" + content);\n// 根据文件ID和用户权限查找文件实例\nvar file = permissionFind(userId, id, 1);\nlog.info(\"save permissionFind file--->\" + file)\n\n// 初始化文本变量\nvar text = \'\';\n\n// var contentJsonObject = content::json\n// log.info(\"contentJsonObject id\",contentJsonObject)\nvar contentString = \'\';\nvar ext = \'\';\n\n// 如果文件类型为文档\nif (\'document\'.equals(file.type)) {\n    // 移除内容中HTML标签，仅保留文本\n    text = HtmlUtil.cleanHtmlTag(content);\n}\n\n// 根据文件类型处理内容\nif (\'document\'.equals(file.type)) {\n    // 处理文档类型文件\n    contentString = content;\n    // 设置文件扩展名\n    ext = \'md\'.equals(content.type) ? \'md\' : \'text\';\n} else if (\'drawio\'.equals(file.type)) {\n    // 处理绘图类型文件\n    contentString = content.xml;\n    // 设置文件扩展名\n    ext = \'drawio\';\n} else if (\'mind\'.equals(file.type)) {\n    contentString = content;\n    log.info(\"contentString--------->\" + contentString)\n    ext = \'mind\';\n} else if (\'txt\'.equals(file.type) || \'code\'.equals(file.type)) {\n    // 处理文本和代码类型文件\n    contentString = content.content;\n} else {\n    exit 400, \'参数错误\';\n}\n\nlog.info(\"ext-->\" + ext)\nlog.info(\"contentString-->\" + contentString)\n// 将内容保存到文件,并上传minio\nfileName = FileUtil.createTempFile(\'.\' + ext, true)\n// fileName = \"./\"+now().format(\"yyyyMMddHHmmss\")+\".\"+ext\n\n\nlog.info(\"fileName-->\" + fileName)\nvar tempFile = FileUtil.writeUtf8String(contentString, fileName);\n// log.info(\"tempFile-->\" + tempFile)\n\n// var data = FileUtil.readBytes(tempFile);\n// // string filcontent = string(data)\nlog.info(\"FileUtil.readUtf8String(fileName)-->\" + FileUtil.readUtf8String(fileName))\n\nlog.info(\"Content of temporary file---> \" + FileUtil.readUtf8String(fileName));\n\nInputStream inputStream = FileUtil.getInputStream(tempFile);\nvar newUrl = MinioUtil.uploadStream(inputStream, \'.\' + ext);\nlog.info(\"newUrl-->\" + newUrl)\n// 添加文件的url和文件后缀名\n// content.put(\"url\",newUrl);\n// content.put(\"ext\",ext);\n\nlog.info(\"contentObj::json ss\" + contentObj::stringify)\n\n// 重新计算文件大小\nvar fileSize = FileUtils.getFileSize(MinioUtil.preview(newUrl));\n\n// 保存文件内容到file_contents\nvar fileContent = db.table(\'file_contents\')\n    .where()\n    .eq(\'fid\', id)\n    .isNull(\'deleted_at\')\n    .selectOne();\n\nvar fileContentMap = {\n    id: ObjectUtil.isNotEmpty(fileContent) ? fileContent.id : null,\n    fid: id,\n    content: content::stringify,\n    text: text,\n    size: fileSize,\n    userid: userId,\n    created_at: ObjectUtil.isNotEmpty(fileContent) ? fileContent.created_at : new Date(),\n    updated_at: ObjectUtil.isNotEmpty(fileContent) ? fileContent.updated_at : null\n}\n\ndb.table(\'file_contents\')\n    .primary(\'id\', null)\n    .save(fileContentMap);\n\n// 保存文件到files\ndb.table(\'files\').primary(\'id\').update({\n    id: id,\n    size: fileSize,\n    url: newUrl,\n    ext: ext,\n    updated_at: now()\n});\n\n//判断是否自动上传到知识库\n//    /api/dataset/document/split\n// 地址：http://127.0.0.1:8108/api/dataset/document/split\n// 载荷 file\n// todo 推送消息\nreturn fileContentMap;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/保存文件内容(office回调).ms', '{\n  \"properties\" : { },\n  \"id\" : \"dc4859b433a248d2ab5b223735335641\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"保存文件内容(office回调)\",\n  \"createTime\" : 1719394266465,\n  \"updateTime\" : 1718326273872,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/content/office\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.apache.tomcat.util.http.fileupload.FileUtils\nimport org.ssssssss.magicboot.utils.MinioUtil\nimport org.ssssssss.magicboot.utils.FileUtils\nimport cn.hutool.core.util.ObjectUtil;\nimport request;\nimport http;\nimport java.io.ByteArrayInputStream;\nimport java.io.InputStream;\nimport log;\nimport java.util.Scanner;\nimport response;\nimport java.net.HttpURLConnection;\nimport java.net.URL;\nimport cn.dev33.satoken.stp.StpUtil;\nvar userId = StpUtil.getLoginIdByToken(token)\n// 查找文件\nvar file = db.table(\'files\')\n    .where()\n    .isNull(\'deleted_at\')\n    .eq(\'id\', id)\n    .selectOne();\n\nif (ObjectUtil.isEmpty(file)) {\n    exit 400, \'找不到相关文件\'\n}\n\n// 如果状态为2，表示需要保存远程办公文档到本地服务器\nif (body.status == 2) {\n    URL url = new URL(body.url);\n    HttpURLConnection connection = url.openConnection();\n    InputStream stream = connection.getInputStream();\n\n    var newUrl = MinioUtil.uploadStream(stream, \'.\' + file.ext);\n\n    // 重新计算文件大小，更新文件大小\n    var fileSize = FileUtils.getFileSize(MinioUtil.preview(newUrl));\n    var content = {\n        \"url\": newUrl\n    }\n    // 更新file_contents,没有就新增\n    var isExist = db.table(\'file_contents\').where().eq(\'fid\', id).count();\n    if (isExist > 0) {\n        db.table(\'file_contents\').primary(\'fid\').update({\n            fid: id,\n            content: content::stringify,\n            text: \'\',\n            size: fileSize,\n            userid: userId,\n            updated_at: new Date()\n        })\n    } else {\n        db.table(\'file_contents\').primary(\'fid\').insert({\n            fid: id,\n            content: content::stringify,\n            text: \'\',\n            size: fileSize,\n            userid: userId,\n            created_at: new Date(),\n            updated_at: new Date()\n        });\n    }\n\n    // 更新files\n    db.table(\'files\').primary(\'id\').update({\n        id: id,\n        url: newUrl,\n        size: fileSize,\n        updated_at: new Date()\n    })\n\n}\n\nreturn response.json({\n    error: 0\n});');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/保存文件内容(上传文件).ms', '{\n  \"properties\" : { },\n  \"id\" : \"1f383beed79b49a4a52fde4cce746c36\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"保存文件内容(上传文件)\",\n  \"createTime\" : 1719394266473,\n  \"updateTime\" : 1718155977780,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/content/upload\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : \"0\",\n    \"description\" : \"父级ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1717830457352,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1717811802990\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport cn.hutool.core.collection.CollUtil\nimport cn.hutool.core.util.StrUtil;\nimport cn.hutool.core.io.FileUtil;\nimport com.alibaba.fastjson.JSONObject;\nimport cn.hutool.core.util.ObjectUtil;\nimport cn.dev33.satoken.stp.StpUtil;\nimport request;\nimport log;\n\nimport \'@/file/permissionFind\' as permissionFind;\nimport \'@/file/getFileTypeByExt\' as getFileTypeByExt;\nimport \'@/file/handleDuplicateName\' as handleDuplicateName;\nimport \'@/file/uploadkb\' as uploadkb;\n\nimport org.ssssssss.magicboot.utils.MinioUtil;\nimport org.ssssssss.magicboot.utils.FileUtils;\n\nvar userId = StpUtil.getLoginId();\nlog.info(\"文件上传的userid is->\" + userId);\n// var userId = 6;\nvar uploadFile = request.getFile(\'file\')\nlog.info(\"uploadFile=\" + uploadFile);\nlog.info(\"uploadFile.name\" + uploadFile.name);\nlog.info(\"pid=\" + pid);\npid = pid::int\nlog.info(\"pid----->\" + pid);\n\nif (pid > 0) {\n    var fileNum = db.table(\"files\").where().eq(\'pid\', pid).isNull(\'deleted_at\').count();\n    if (fileNum > 300) {\n        exit 400, \'每个文件夹里最多只能创建300个文件或文件夹\';\n    }\n    // 在文件夹里面创建的文件或者文件夹，所有者都是上一级文件夹的\n    var file = permissionFind(userId, pid, 1);\n    userId = file.userid;\n} else {\n    var fileNum = db.table(\"files\").where().eq(\'pid\', 0).isNull(\'deleted_at\').eq(\'userid\', userId).count();\n    if (fileNum >= 300) {\n        exit 400, \'每个文件夹里最多只能创建300个文件或文件夹\';\n    }\n}\n\n// 单独传文件是webkitRelativePath是空的\nlog.info(\"webkitRelativePath={}\", webkitRelativePath);\nvar dirs = StrUtil.isNotEmpty(webkitRelativePath) ? webkitRelativePath.split(\"/\") : null;\nlog.info(\"dirs={}\", dirs);\n// 创建文件夹\nwhile (dirs != null && dirs.length > 1) {\n    // 获取数组的第一个元素\n    var dirName = dirs[0];\n    db.transaction(() => {\n        // 检查文件夹是否存在，如果不存在则创建新文件夹。\n        var dirRow = db.select(\"\"\"\n        SELECT * FROM files WHERE pid = #{pid} AND type = \'folder\' AND name = #{dirName} and deleted_at is null FOR UPDATE\n        \"\"\")\n\n        if (CollUtil.isEmpty(dirRow)) {\n            var newName = handleDuplicateName(pid, userId, null, dirName);\n            var pshare = 0;\n\n            // pid !=0才去看父级共享状态\n            if (pid != 0) {\n                var pfolder = db.table(\'files\').where().isNull(\'deleted_at\').eq(\'id\', pid).selectOne();\n                if (ObjectUtil.isNotEmpty(pfolder)) {\n                    if (pfolder.share == 1) {\n                        // 如果父级是共享的，那么就把父级的id带过来\n                        pshare = pfolder.id;\n                    } else if (pfolder.pshare != 0) {\n                        // 如果父级的也是有pshare，那么就带过来\n                        pshare = pfolder.pshare;\n                    }\n                }\n            }\n\n            var createdAt = new Date();\n\n            log.info(\"pid={}\", pid);\n            // 保存\n            var id = db.table(\'files\')\n                .primary(\'id\')\n                .insert({\n                    created_id: userId,\n                    name: newName,\n                    type: \'folder\',\n                    pid: pid,\n                    url: url,\n                    ext: null,\n                    userid: userId,\n                    created_at: createdAt,\n                    updated_at: createdAt,\n                    pids: pids,\n                    id_path: pids,\n                    pshare: pshare\n                })\n            // 更新 pids和id_path字段\n            var pids = \'\';\n\n            if (pid == 0) {\n                pids = \"/\" + id + \"/\";\n            } else {\n                // 获取父级的pids\n                var idPath = db.table(\'files\')\n                    .where()\n                    .eq(\"id\", pid)\n                    .isNull(\'deleted_at\')\n                    .selectOne();\n                pids = idPath.id_path + id + \"/\"\n            }\n\n            db.table(\'files\').primary(\'id\').update({\n                id: id,\n                pids: pids,\n                id_path: pids\n            })\n            // 如果文件夹不存在，抛出异常。\n            if (null == id) {\n                exit 400, \'创建文件夹失败\';\n            }\n\n            // 更新pid\n            pid = id;\n\n            //插入系统用户表,permission默认为1\n            var id = db.table(\'file_users\')\n                .insert({\n                    file_id: id,\n                    created_at: createdAt,\n                    updated_at: createdAt,\n                    userid: userId,\n                    permission: 1\n                })\n\n\n\n        } else {\n            pid = dirRow.id;\n        }\n    });\n    // 移除已经处理过的元素\n    dirs = Arrays.copyOfRange(dirs, 1, dirs.length);\n}\n\nvar fileNameWithExt = (dirs != null) ? dirs[0] : uploadFile.getOriginalFilename();\nlog.info(\"fileNameWithExt={}\", fileNameWithExt);\n\nint index = StrUtil.lastIndexOfIgnoreCase(fileNameWithExt, \".\");\nvar ext = fileNameWithExt.substring(index + 1);\nvar fileName = fileNameWithExt.substring(0, index);\n\n// 上传文件获取url\nvar fileUrl = MinioUtil.upload(uploadFile);\nvar url = MinioUtil.preview(fileUrl);\nvar fileType = getFileTypeByExt(ext);\nvar newName = handleDuplicateName(pid, userId, null, fileName);\nvar fileSize = FileUtils.getFileSize(url);\n\nif (\"markdown\".equals(ext)) {\n    ext = \"md\";\n}\n\nvar result = {\n    ret: 0\n};\ndb.transaction(() => {\n    log.info(\"pids-->-->-->-->-->-->-->-->-->-->\" + pid)\n\n    var pshare = 0;\n    // pid !=0才去看父级共享状态\n    if (pid != 0) {\n        var pfolder = db.table(\'files\').where().isNull(\'deleted_at\').eq(\'id\', pid).eq(\'share\', 1).selectOne();\n        pshare = (pfolder != null && 1 == pfolder.share) ? pfolder.id : 0;\n    }\n    // 保存\n    var createdAt = new Date();\n    var id = db.table(\'files\')\n        .primary(\'id\')\n        .insert({\n            created_id: userId,\n            name: newName,\n            type: fileType,\n            pid: pid,\n            url: fileUrl,\n            ext: ext,\n            userid: userId,\n            created_at: createdAt,\n            updated_at: createdAt,\n            pshare: pshare,\n            size: fileSize\n        })\n    // 更新 pids和id_path字段\n    var pids = \'\';\n\n    if (pid == 0 || pid == \'0\') { //特殊处理了\n        pids = \"/\" + id + \"/\";\n    } else {\n        // 获取父级的pids\n        var idPath = db.table(\'files\')\n            .where()\n            .eq(\"id\", pid)\n            .isNull(\'deleted_at\')\n            .selectOne();\n        pids = idPath.id_path + id + \"/\"\n    }\n\n    db.table(\'files\').primary(\'id\').update({\n        id: id,\n        pids: pids,\n        id_path: pids\n    })\n\n    //插入系统用户表,permission默认为1\n    var file_users = db.table(\'file_users\')\n        .insert({\n            file_id: id,\n            created_at: createdAt,\n            updated_at: createdAt,\n            userid: userId,\n            permission: 1\n        })\n\n    var content = {\n        \'from\': \'\',\n        \'type\': fileType,\n        \'ext\': ext,\n        \'url\': fileUrl\n    }\n    // 新增fileContent\n    var fileContentMap = {\n        fid: id,\n        content: JSONObject.toJSONString(content),\n        text: text,\n        size: fileSize,\n        userid: userId,\n        created_at: createdAt,\n        updated_at: createdAt\n    }\n\n    db.table(\'file_contents\')\n        .primary(\'id\', null)\n        .save(fileContentMap);\n\n    //TODO 调用函数上传知识库,暂时不考虑上传\n    // uploadkb(fileUrl)\n    result = {\n        id: id,\n        created_id: userId,\n        name: newName,\n        type: fileType,\n        pid: pid,\n        ext: ext,\n        userid: userId,\n        created_at: createdAt,\n        updated_at: createdAt,\n        deleted_at: null,\n        pshare: pshare,\n        pids: pids,\n        id_path: pids,\n        size: fileSize,\n        ret: 1\n    }\n    if (\"picture\".equals(fileType)) {\n        result.put(\'image_url\', \'http://82.157.62.190:8081/api/file/preview/\' + id);\n    }\n\n});\n\nreturn result;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/删除文件(夹).ms', '{\n  \"properties\" : { },\n  \"id\" : \"406ba3ff32104685b56c57ad02189ece\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"删除文件(夹)\",\n  \"createTime\" : 1719394266508,\n  \"updateTime\" : 1718096974323,\n  \"lock\" : \"1\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/remove\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"ids\",\n    \"value\" : \"116\",\n    \"description\" : \"文件id,多个使用,分割\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ {\n    \"name\" : \"token\",\n    \"value\" : \"1d13f168-8686-4090-8101-9dcec4e36f6a\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": \\\"删除成功\\\",\\n    \\\"timestamp\\\": 1718096699905,\\n    \\\"executeTime\\\": 131\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"删除成功\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1718094742266\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"60\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport cn.hutool.core.collection.CollUtil;\nimport cn.hutool.core.util.StrUtil;\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log\n\nvar userId = StpUtil.getLoginId()\nvar idList = StrUtil.split(ids, \',\')\nlog.info(idList::stringify);\nif (CollUtil.isEmpty(idList)) {\n    exit 400, \'请选择删除的文件或文件夹\'\n}\n\nif (idList.size() > 100) {\n    exit 400, \'一次最多只能删除100个文件或文件夹\'\n}\n\nvar idSet = new HashSet(idList);\n// 权限检测：只有所有者或者创建者才能删除\nvar num = db.table(\'files\')\n    .where()\n    .in(\'id\', idSet)\n    .isNull(\'deleted_at\')\n    .and(it => it.eq(\'userid\', userId).or().eq(\'created_id\', userId))\n    .count();\n\nlog.info(num::stringify);\n// 说明当前用户不是文件（夹）的所有者或创建这\nif (idSet.size() != num) {\n    exit 400, \'仅限所有者或创建者操作\';\n}\n\n// 如果是文件夹，递归删除，并删除权限信息和文件内容信息\nconst idPathList = db.table(\'files\')\n    .column(\'id_path\')\n    .where()\n    .in(\'id\', idSet)\n    .isNull(\'deleted_at\')\n    .select();\n\nlog.info(\"idPathList--------------begin\");\nlog.info(idPathList::string);\n\n\nlog.info(\"idPathList---------------end\");\n\nif (CollUtil.isEmpty(idPathList)) {\n    exit 400, \'删除失败\';\n}\n\n// 开启一个事物\nvar deletedAt = new Date();\n\nvar val = db.transaction(() => {\n    // 删除文件内容\n    var v1 = db.update(\"\"\"\n        UPDATE file_contents fc\n        INNER JOIN (SELECT DISTINCT id FROM files WHERE deleted_at is null and\n            <foreach collection=\"idPathList\" item=\"item\" separator=\" OR \" open=\"(\" close=\")\">\n                      id_path LIKE CONCAT(#{item.get(\'idPath\')}, \'%\')\n            </foreach>\n        ) sub ON fc.fid = sub.id\n        SET fc.deleted_at = #{deletedAt}\n        \"\"\")\n    // 删除文件权限\n    var v2 = db.update(\"\"\"\n        DELETE FROM file_users\n        WHERE file_id IN (\n            SELECT DISTINCT id FROM files\n            WHERE deleted_at IS NULL \n            AND (\n                <foreach collection=\"idPathList\" item=\"idPath\" separator=\" OR \" open=\"(\" close=\")\">\n                    id_path LIKE CONCAT(#{idPath.get(\'idPath\')}, \'%\')\n                </foreach>\n            )\n        )\n    \"\"\")\n    // 删除文件链接\n    var v3 = db.update(\"\"\"\n        DELETE FROM file_links\n        WHERE file_id IN (\n            SELECT DISTINCT id FROM files\n            WHERE deleted_at IS NULL \n            AND (\n                <foreach collection=\"idPathList\" item=\"idPath\" separator=\" OR \" open=\"(\" close=\")\">\n                    id_path LIKE CONCAT(#{idPath.get(\'idPath\')}, \'%\')\n                </foreach>\n            )\n        )\n    \"\"\")\n    // 删除文件\n    var v4 = db.update(\"\"\"\n        UPDATE files f\n        INNER JOIN (SELECT DISTINCT id FROM files WHERE deleted_at is null and\n            <foreach collection=\"idPathList\" item=\"item\" separator=\" OR \" open=\"(\" close=\")\">\n                id_path LIKE CONCAT(#{item.get(\'idPath\')}, \'%\')\n            </foreach>\n        ) sub ON f.id = sub.id\n        SET f.deleted_at = #{deletedAt}\n        \"\"\")\n    return v4;\n});\n\nreturn \"删除成功\"');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/复制文件(夹).ms', '{\n  \"properties\" : { },\n  \"id\" : \"bdd485b495a34d2ba67aafb2f39bb919\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"复制文件(夹)\",\n  \"createTime\" : 1719394266514,\n  \"updateTime\" : 1718176690778,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/copy\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : \"123\",\n    \"description\" : \"文件ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ {\n    \"name\" : \"token\",\n    \"value\" : \"3ea3b487-f2b4-420d-bf9f-d5c111755b20\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1718163815909,\\n    \\\"executeTime\\\": 146\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1718155241990\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"59\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.springframework.core.ReactiveAdapter\nimport org.junit.jupiter.params.provider.NullAndEmptySource\nimport cn.dev33.satoken.stp.StpUtil;\nimport com.alibaba.fastjson.JSONObject;\nimport org.ssssssss.magicboot.utils.MinioUtil;\nimport log;\n\nvar userId = StpUtil.getLoginId();\nlog.info(\"执行到这里-1\")\n// var userId = 6;\n//根据文件id和userid去file_users表查询，是否有复制权限\nvar fileUsers = db.table(\"file_users\").where().eq(\"file_id\", id).eq(\"userid\", userId).select();\nlog.info(\"执行到这里0：：：\" + fileUsers)\nif (fileUsers.size() == 0) {\n    exit \'没有找到可以复制的文件\'\n}\nlog.info(\"执行到这里0\")\n//重新保存一份\nvar nowAt = new Date();\nvar val = db.transaction(() => {\n    log.info(\"执行到这里1\")\n    var fileCopy = db.table(\"files\").where().eq(\"id\", id).selectOne();\n    //原始的对象\n    var file_url = fileCopy.url;\n    //对象名\n    let fileName = file_url.substring(0, file_url.lastIndexOf(\'.\'));\n    //对象后缀\n    let fileExtension = file_url.substring(file_url.lastIndexOf(\'.\'));\n    //新的对象要加copy\n    // 构建新文件名，添加_copy并在末尾保留原始扩展名\n    // let newObjectName = fileName + \'_copy\' + fileExtension;\n\n    let counter = 1\n\n    let tempObjectName = fileName + \'_copy\' + counter + fileExtension;\n    log.info(\"tempObjectName is --->\" + tempObjectName)\n\n    log.info(\"执行到这里2\")\n    //检查是否存在，如果存在就再加\n    while (MinioUtil.isObjectExists(tempObjectName)) {\n        counter++;\n        log.info(\"counter is --->\" + counter)\n        tempObjectName = fileName + \'_copy\' + counter + fileExtension;\n        log.info(\"tempObjectName is --->\" + tempObjectName)\n    }\n\n\n    //复制对象的名称\n    MinioUtil.copyObject(fileCopy.url, tempObjectName);\n    //检查文件是否存在\n    var isExis = MinioUtil.isObjectExists(tempObjectName)\n\n    if (isExis) {\n        log.info(\"文件已拷贝成功\");\n    } else {\n        log.info(\"文件不存在，可能拷贝异常了\");\n    }\n\n    log.info(\"tempObjectName is --->\" + tempObjectName)\n    //存储files\n    var data = {\n        pid: fileCopy.pid,\n        url: tempObjectName,\n        name: fileCopy.name + \'_copy\' + counter,\n        type: fileCopy.type,\n        ext: fileCopy.ext,\n        size: fileCopy.size,\n        userid: userId,\n        //TODO 还有share、cid\n        pshare: fileCopy.pshare, //父目录的分享权限\n        created_id: userId,\n        created_at: nowAt,\n        updated_at: nowAt,\n        deleted_at: null,\n    }\n    var fileid = db.table(\"files\").insert(data);\n    log.info(\"执行到这里3\")\n    //\n    var pids = \'\';\n\n    log.info(\"pid value\" + pid)\n    var pid = fileCopy.pid //等于原来软件的pid\n\n    if (pid == 0 || pid == \'0\') { //特殊处理了\n        pids = \"/\" + fileid + \"/\";\n\n    } else {\n        // 获取父级的pids\n        var idPath = db.table(\'files\')\n            .where()\n            .eq(\"id\", pid)\n            .isNull(\'deleted_at\')\n            .selectOne();\n        log.info(\"idPath value\", idPath)\n        pids = idPath.idPath + fileid + \"/\"\n    }\n    db.table(\'files\').primary(\'id\').update({\n        id: fileid,\n        pids: pids,\n        id_path: pids\n    })\n    log.info(\"执行到这里4\")\n\n    //存储file_content \n    var content = {\n        \'from\': \'\',\n        \'type\': fileCopy.type,\n        \'ext\': fileCopy.ext,\n        \'url\': newObjectName\n    }\n    // 新增fileContent\n    var fileContentMap = {\n        fid: fileid,\n        content: JSONObject.toJSONString(content),\n        text: null, //TODO 这里应该都是null\n        size: fileCopy.fileSize,\n        userid: userId,\n        created_at: nowAt,\n        updated_at: nowAt\n    }\n\n    log.info(\"执行到这里5\")\n    var result = db.table(\'file_contents\')\n        .primary(\'id\', null)\n        .save(fileContentMap);\n    return result;\n});');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/打包文件.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a0cafd9e4f4b444f84987e00cda5b817\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"打包文件\",\n  \"createTime\" : 1719394266520,\n  \"updateTime\" : 1718975274095,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/download/pack\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"ids\",\n    \"value\" : null,\n    \"description\" : \"文件ID，格式: id, id2, id3\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"name\",\n    \"value\" : null,\n    \"description\" : \"下载文件名\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.dev33.satoken.stp.StpUtil\nimport cn.hutool.core.util.StrUtil\n\nvar userId = StpUtil.getLoginId()\nvar fileName = null;\nif (StrUtil.isNotEmpty(name)) {\n    fileName = name.replaceAll(\"[/\\\\\\\\:*?\\\"<>|]\", \"\");\n}\nif (StrUtil.isEmpty(fileName)) {\n    fileName = \'Package_\' + userId;\n}\n\nfileName = fileName + \'_\' + date_format(new Date); + \'.zip\';\n\nif (StrUtil.isEmpty(ids)) {\n    exit 400, \'请选择下载的文件或文件夹\';\n}\nif (StrUtil.split(ids, \',\') > 100) {\n    exit 400, \'一次最多可以下载100个文件或文件夹\';\n}\nreturn \'Hello magic-api\'');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/搜索文件列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"aaa4bb9856104c5487ab4f505f0c70f3\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"搜索文件列表\",\n  \"createTime\" : 1719394266523,\n  \"updateTime\" : 1718038943124,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/search\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"link\",\n    \"value\" : null,\n    \"description\" : \"通过分享地址搜索（如：https://aaaa.com/single/file/JBS2lmVQ==）\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"key\",\n    \"value\" : \"知识\",\n    \"description\" : \"关键词\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.StrUtil\nimport cn.hutool.core.util.ObjectUtil\nimport cn.hutool.core.util.StrUtil;\nimport cn.hutool.core.util.ReUtil;\nimport log;\nimport \'@/file/getFileListByPermission\' as getFileListByPermission;\n// 通过分享地址搜索（如：https://t.hitosea.com/single/file/ODcwOCwzOSxpa0JBS2lmVQ==）\n// 根据文件夹或者文件的名称来模糊匹配\n\n//TODO 这里需要处理\n// var userId = StpUtil.getLoginId()\nvar userId = \'1\';\n\n// 从请求中获取文件链接和搜索关键词，并去除空白字符\nvar linkStr = StrUtil.trim(link);\nvar name = StrUtil.trim(key);\n\n// 初始化文件ID和获取数量\nvar id = 0;\nvar take = 50;\n\n// 通过分享地址搜索\nvar fileId = null;\nif (StrUtil.isNotEmpty(linkStr)) {\n    // https://t.hitosea.com/single/file/ODcwOCwzOSxpa0JBS2lmVQ==\n    // 提取分享码:ODcwOCwzOSxpa0JBS2lmVQ==\n    String regex = \'/\\/single\\/file\\/(.*?)$/i\';\n    var code = ReUtil.get(regex, linkStr, 1);\n    var fileLink = db.table(\'file_links\')\n        .column(\'file_id\')\n        .where()\n        .eq(\'code \', code)\n        .selectOne();\n\n    if (ObjectUtil.isEmpty(fileLink) || StrUtil.isEmpty(fileLink.get(\'file_id\'))) {\n        return \'success\';\n    }\n    fileId = fileLink.get(\'file_id\');\n}\n\n// 搜索自己有权限看到的\nvar fileList = getFileListByPermission(name, fileId, userId, null);\nreturn fileList;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/添加或修改文件(夹).ms', '{\n  \"properties\" : { },\n  \"id\" : \"0155fea2ad4a45658056e4c7b1205198\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"添加或修改文件(夹)\",\n  \"createTime\" : 1719394266527,\n  \"updateTime\" : 1719227665362,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/add\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"name\",\n    \"value\" : \"测试文件3\",\n    \"description\" : \"文件名称\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"type\",\n    \"value\" : \"document\",\n    \"description\" : \"文件类型\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件ID（赋值修改文件名称）\",\n    \"required\" : false,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"pid\",\n    \"value\" : null,\n    \"description\" : \"父级ID\",\n    \"required\" : false,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"url\",\n    \"value\" : null,\n    \"description\" : \"文件url\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.ObjectUtil\nimport cn.hutool.core.util.StrUtil;\nimport \'@/file/handleDuplicateName\' as handleDuplicateName;\nimport \'@/file/permissionFind\' as permissionFind;\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log;\n\nvar userId = StpUtil.getLoginId();\n\nString trimmedName = StrUtil.trim(name);\nString trimmedType = StrUtil.trim(type);\n\nif (trimmedName.length() < 2) {\n    exit 400, \'文件名称不可以少于2个字\';\n} else if (trimmedName.length() > 32) {\n    exit 400, \'文件名称最多只能设置32个字\';\n}\n\nvar tmpName = trimmedName.replaceAll(\"[\\\\\\\\/:*?\\\"<>|]\", \"\");\nif (!tmpName.equals(trimmedName)) {\n    exit 400, \'\"文件名称不能包含这些字符：\\/:*?\\\"<>|\"\';\n}\n\nif (id > 0) {  // 修改\n    var file = permissionFind(userId, id, 1);\n    //  处理重名\n    var newName = handleDuplicateName(pid, userId, ext, trimmedName);\n    var result = {id: id,name: newName}    // 更新\n    db.table(\'files\').primary(\'id\').update(result);\n    // todo 推送更新消息\n    return result;\n} else {\n    // 添加\n    if (![\n            \'folder\',\n            \'document\',\n            \'mind\',\n            \'drawio\',\n            \'word\',\n            \'excel\',\n            \'ppt\',\n        ].contains(trimmedType)) {\n        exit 400, \'类型错误\';\n    }\n\n    var extMap = {\n        \'folder\': null,\n        \'document\': \'md\',\n        \'mind\': \'mind\',\n        \'drawio\': \'drawio\',\n        \'word\': \'docx\',\n        \'excel\': \'xlsx\',\n        \'ppt\': \'pptx\',\n    }\n    var ext = extMap.get(trimmedType);\n    if (pid > 0) {\n        var fileNum = db.table(\"files\")\n            .where()\n            .eq(\'pid\', pid)\n            .isNull(\'deleted_at\')\n            .count();\n        if (fileNum > 300) {\n            exit 400, \'每个文件夹里最多只能创建300个文件或文件夹\';\n        }\n        // 在文件夹里面创建的文件或者文件夹，所有者都是上一级文件夹的\n        var file = permissionFind(userId, pid, 1);\n        userId = file.userid;\n    } else {\n        var fileNum = db.table(\"files\")\n            .where()\n            .eq(\'pid\', 0)\n            .isNull(\'deleted_at\')\n            .eq(\'userid\', userId)\n            .count();\n        if (fileNum >= 300) {\n            exit 400, \'每个文件夹里最多只能创建300个文件或文件夹\';\n        }\n    }\n\n    //  处理重名\n    var newName = handleDuplicateName(pid, userId, ext, trimmedName);\n    var result = db.transaction(() => {\n        var pshare = 0;\n        // pid !=0才去看父级共享状态\n        if (pid != 0) {\n            var pfolder = db.table(\'files\').where().isNull(\'deleted_at\').eq(\'id\', pid).selectOne();\n            if (ObjectUtil.isNotEmpty(pfolder)) {\n                if (pfolder.share == 1) {\n                    // 如果父级是共享的，那么就把父级的id带过来\n                    pshare = pfolder.id;\n                } else if (pfolder.pshare != 0) {\n                    // 如果父级的也是有pshare，那么就带过来\n                    pshare = pfolder.pshare;\n                }\n            }\n        }\n\n        // 保存\n        Date createdAt = new Date();\n        var id = db.table(\'files\')\n            .primary(\'id\')\n            .insert({\n                created_id: userId,\n                name: newName,\n                type: trimmedType,\n                pid: pid,\n                url: url,\n                ext: ext,\n                userid: userId,\n                created_at: createdAt,\n                updated_at: createdAt,\n                pshare: pshare\n            })\n        // 更新 pids和id_path字段\n        var pids = \'\';\n\n        if (pid == 0) {\n            pids = \"/\" + id + \"/\";\n        } else {\n            // 获取父级的pids\n            var idPath = db.table(\'files\')\n                .where()\n                .eq(\"id\", pid)\n                .isNull(\'deleted_at\')\n                .selectOne();\n            pids = idPath.id_path + id + \"/\"\n        }\n\n        db.table(\'files\').primary(\'id\').update({\n            id: id,\n            pids: pids,\n            id_path: pids\n        })\n\n        //TODO 插入文件用户表\n        res = db.table(\"file_users\").insert({\n            file_id: id,\n            userid: userId,\n            permission: 1\n        })\n        log.info(\"插入文件用户表\" + res)\n\n        return result = {\n            id: id,\n            created_id: userId,\n            name: newName,\n            type: trimmedType,\n            pid: pid,\n            url: url,\n            ext: ext,\n            userid: userId,\n            created_at: createdAt,\n            updated_at: createdAt,\n            deleted_at: null,\n            pshare: pshare,\n            pids: pids,\n            id_path: pids\n        };\n\n    });\n\n    // todo 发送添加成功消息\n    return result;\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/移动文件(夹).ms', '{\n  \"properties\" : { },\n  \"id\" : \"904624d4084c45758a054b6d3ce75e84\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"移动文件(夹)\",\n  \"createTime\" : 1719394266534,\n  \"updateTime\" : 1718039260506,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/move\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : null,\n    \"description\" : \"移动到的文件夹ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"ids\",\n    \"value\" : null,\n    \"description\" : \"移动的文件夹ID\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"expression\",\n    \"error\" : \"请选择移动的文件或文件夹\",\n    \"expression\" : \"ids == null ||ids == \\\"\\\"\",\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.StrUtil;\nimport \'@/file/permissionFind\' as permissionFind;\nimport \'@/file/handleDuplicateName\' as handleDuplicateName;\n\n// 检查一次移动的文件或文件夹数量是否超过限制（100个）\nvar idList = StrUtil.split(ids, \',\');\nif (idList.size() > 100) {\n    exit 400, \'一次最多只能移动100个文件或文件夹\';\n}\n\n// 判断是否移动到共享文件夹\nvar toShareFile = false;\nvar tmpShareFile = null;\nif (pid > 0) {\n    // 检查目标文件夹是否存在以及用户是否有权限\n    tmpShareFile = permissionFind(pid, userId, 1);\n    // 如果目标是一个共享文件夹，则获取共享信息\n    toShareFile = tmpFile.share == 1;\n}\n\n// 定义一个数组用于存储移动的文件对象\nvar files = [];\n// 使用数据库事务处理移动操作\nvar val = db.transaction(() => {\n    for (id in idList) {\n        // 获取文件对象并检查用户是否有权限\n        var file = permissionFind(id, userId, 1000);\n\n        if (pid > 0) {\n            // 如果移动到的是一个共享文件夹\n            if (toShareFile) {\n                // 检查文件是否已经在共享中或者包含共享文件\n                if (file.share == 1) {\n                    exit 400, \'当前正在共享，无法移动到另一个共享文件夹内\';\n                }\n\n                // 如果当前是文件夹，就检查当前文件夹下面是否有子项（文件或文件夹）被共享。\n                if (\"folder\".equals(file.type)) {\n                    var currIdPath = file.id_path;\n                    var subShareNum = db.selectInt(\"\"\"\n                    select count(*) from files where share=1 and id_path LIKE CONCAT( #{currIdPath}, \'%\' ) \n                    \"\"\")\n\n                    if (subShareNum > 0) {\n                        exit 400, file.name + \'内含有共享文件，无法移动到另一个共享文件夹内\';\n                    }\n\n                }\n\n                // 更新当前文件以及所有子文件的用户ID为共享文件夹的用户ID\n                var userid = tmpShareFile.userid;\n                var currIdPath = file.id_path;\n                db.update(\"\"\"update files set userid = #{userid} where id_path LIKE CONCAT( #{currIdPath}, \'%\' )\"\"\")\n            }\n\n            // 确保文件不是移动到自己的子文件夹中\n            var tmpId = pid;\n            while (tmpId > 0) {\n                if (id == tmpId) {\n                    exit 400, \'移动位置错误\';\n                }\n                tmpId = db.table(\'magic_api_info\')\n                    .column(\'pid\')\n                    .where()\n                    .eq(\'id\', tmpId)\n                    .selectOne()\n            }\n        } else {\n            // 如果移动到的根文件夹\n            // 更新当前文件以及所有子文件的用户ID为共享文件夹的用户ID\n            var userid = StpUtil.getLoginId();\n            var currIdPath = file.id_path;\n            db.update(\"\"\"update files set userid = #{userid} where id_path LIKE CONCAT( #{currIdPath}, \'%\' )\"\"\")\n        }\n\n        // 处理重名\n        var newName = handleDuplicateName(pid, userId, ext, trimmedName);\n        // 更新\n        db.table(\'files\').primary(\'id\').update({\n            id: file.id,\n            pid: pid,\n            name: newName\n        })\n\n        var newPshare = 0;\n        var currIdPath = file.id_path;\n        if (pid != 0) {\n            // 如果要移动的文件(夹)处于共享当中或不是共享,移动到的目标是共享的，把当前文件(夹)的pshare变成目标文件夹的id\n            if (file.share == 0 && tmpShareFile.share == 1) {\n                newPshare = tmpShareFile.id;\n            }\n            // 如果要移动的文件(夹)处于共享当中或不是共享,移动到的目标是处于共享中，把当前文件(夹)的pshare变成目标文件夹的pshare\n            if (file.share == 0 && tmpShareFile.share == 0 && tmpShareFile.pshare != 0) {\n                newPshare = tmpShareFile.pshare;\n            }\n\n            // 如果要移动的文件(夹)处于共享当中,移动到的目标是不是共享中，把当前文件(夹)的pshare变成0\n            if (file.share == 0 && tmpShareFile.share == 0 && tmpShareFile.pshare == 0) {\n                newPshare = 0;\n            }\n\n        } else {\n            // 处理文件(夹)处于共享中的，把当前文件(夹)的pshare变成0\n            if (file.share == 0 && file.pshare != 0) {\n                newPshare = 0;\n            }\n        }\n\n        // 批量更新pshare\n        db.update(\"\"\" update files set pshare = #{newPshare} where id_path LIKE CONCAT( #{currIdPath}, \'%\' )\"\"\")\n\n\n        // 处理pids和id_path,内存构建，批量更新\n        var updateFileList = db.select(\"\"\"\n        select id,id_path,pid from files where id_path LIKE CONCAT( #{currIdPath}, \'%\' )\n        \"\"\");\n\n        var updateFiles = [];\n        var swapPidStr = \"\";\n        if (pid != 0) {\n            swapPidStr = tmpShareFile.id_path + file.id + \"/\"\n        } else {\n            swapPidStr = \"/\" + file.id + \"/\"\n        }\n\n        for (item in updateFileList) {\n            // 使用replace方法替换字符串中的指定子串\n            var newIdPath = item.id_path.replace(file.id_path, swapPidStr);\n            updateFiles.add([newIdPath, newIdPath, item.id]);\n        }\n\n        db.batchUpdate(\"\"\"update files set id_path = ?,pids=? where id = ?\"\"\", updateFiles);\n        // 将文件对象添加到数组中\n        files.add(file);\n\n    }\n});\n\nreturn files;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取office的token.ms', '{\n  \"properties\" : { },\n  \"id\" : \"0380afe0c42847078ac309b99a4277a3\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取office的token\",\n  \"createTime\" : 1719394266539,\n  \"updateTime\" : 1718253691388,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/office/token\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"documentFileType\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"documentTitle\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"documentKey\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"documentUrl\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigMode\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigLang\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigUserId\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigUserName\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigCustomizationUiTheme\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigCustomizationForcesave\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigCustomizationHelp\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"editorConfigCustomizationCallbackUrl\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"eventsOnDocumentReady\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.jwt.JWTUtil;\nimport log;\nimport request;\nvar secret = \"10000\";\n\nvar payload = {\n    \"document\": {\n        \"fileType\": documentFileType,\n        \"title\": documentTitle,\n        \"key\": documentKey,\n        \"url\": documentUrl\n    },\n    \"editorConfig\": {\n        \"mode\": editorConfigMode,\n        \"lang\": editorConfigLang,\n        \"user\": {\n            \"id\": editorConfigUserId,\n            \"name\": editorConfigUserName\n        },\n        \"customization\": {\n            \"uiTheme\": editorConfigCustomizationUiTheme,\n            \"forcesave\": editorConfigCustomizationForcesave,\n            \"help\": editorConfigCustomizationHelp\n        },\n        \"callbackUrl\": editorConfigCustomizationCallbackUrl\n    },\n    \"events\": {\n        \"onDocumentReady\": eventsOnDocumentReady\n    }\n};\n\ntry {\n    return {\n        \"token\": JWTUtil.createToken(payload, secret.getBytes())\n    };\n} catch (e) {\n    return \"\";\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取共享信息.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a5c13e62c60b46b0b485fd11a0f9c738\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取共享信息\",\n  \"createTime\" : 1719394266545,\n  \"updateTime\" : 1718035987087,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/share\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件id\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\'; \nimport cn.hutool.core.util.ObjectUtil;\nimport log;\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar userId = StpUtil.getLoginId();\n\n//文件复制\nvar file = db.table(\"files\").where().eq(\"id\",id).selectOne();\nif (ObjectUtil.isEmpty(file)) {\n    exit 400, \'文件不存在或已被删除\';\n}\nif(file.userid!=userId){\n    exit 400, \'仅限所有者操作\';\n}\nvar list = db.table(\"file_users\").where().eq(\"file_id\",id).select();\n//返回的信息需要处理，暂时不知道怎么弄\nvar result = {}\nresult.id = file.id;\nresult.list = list;\nreturn result;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取单条数据.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9c2811e7c0614e14b16a4e235ce7484b\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取单条数据\",\n  \"createTime\" : 1719394266550,\n  \"updateTime\" : 1718129090745,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/one\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"Number 文件ID（需要登录） String 链接码（不需要登录，用于预览）\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.ObjectUtil;\nimport cn.hutool.core.collection.CollUtil;\nimport cn.hutool.core.util.StrUtil;\nimport cn.hutool.core.util.NumberUtil;\nimport \'@/file/permissionFind\' as permissionFind;\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nif (NumberUtil.isNumber(id)) {\n    var userId = StpUtil.getLoginId()\n    // 根据文件ID查询（需要登录）\n    return permissionFind(id, userId, 0);\n} else if (StrUtil.isNotEmpty(id)) {\n    // 根据链接码查询（不需要登录，用于预览）\n    var fileId = db.selectValue(\"\"\"\n    select file_id from file_links where code = #{id}\n    \"\"\");\n    if (ObjectUtil.isEmpty(fileId)) {\n        exit 400, \'链接不存在\';\n    }\n    var file = db.table(\'files\')\n        .where()\n        .isNull(deleted_at)\n        .eq(\'id\', fileId)\n        .selectOne();\n    if (ObjectUtil.isEmpty(file)) {\n        exit 400, \'链接不存在\';\n    }\n    // 默认给查看权限\n    if (ObjectUtil.isNotEmpty(file)) {\n        file.put(\'permission\', 0)\n    }\n    return file;\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取文件内容.ms', '{\n  \"properties\" : { },\n  \"id\" : \"968f551af77d479e954dae143cca5469\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取文件内容\",\n  \"createTime\" : null,\n  \"updateTime\" : 1719401738852,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/content\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : \"143\",\n    \"description\" : \"Number: 文件ID（需要登录） String: 链接码（不需要登录，用于预览）\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"only_update_at\",\n    \"value\" : null,\n    \"description\" : \"仅获取update_at字段  no (默认) yes\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : \"no\",\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"down\",\n    \"value\" : null,\n    \"description\" : \"直接下载  no: 浏览（默认） yes: 下载（office文件直接下载，除非是preview） preview: 转预览地址\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : \"no\",\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"history_id\",\n    \"value\" : null,\n    \"description\" : \"读取历史记录ID\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : \"no\",\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"token\",\n    \"value\" : \"9404a2a8-1b45-4a39-b242-45d30a234d6c\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicboot.utils.MinioUtil\nimport org.ssssssss.magicboot.utils.WatermarkUtil\nimport org.ssssssss.magicboot.utils.WatermarkUtils\nimport com.google.gson.JsonObject\nimport cn.hutool.core.util.NumberUtil;\nimport cn.hutool.core.util.ObjectUtil;\nimport cn.hutool.core.collection.CollUtil;\nimport cn.hutool.core.util.StrUtil;\nimport response;\nimport java.net.URLEncoder;\nimport \'@/file/permissionFind\' as permissionFind;\nimport cn.dev33.satoken.stp.StpUtil;\nimport cn.hutool.core.io.FileUtil;\nimport log;\n\nvar file = null;\nif (NumberUtil.isNumber(id)) {\n    //根据token获取是哪个用户\n    // var userId = StpUtil.getLoginId();\n    // var userId = 6; //测试时候打开\n    // 根据文件ID查询（需要登录）\n    var userId = StpUtil.getLoginIdByToken(token)\n    log.info(\"userId.......\" + userId);\n    file = permissionFind(userId, id, \"yes\".equals(down) ? 1 : 0);\n} else if (StrUtil.isNotEmpty(id)) {\n    // 如果参数不为空，根据链接码查找文件id\n    var fileId = db.selectValue(\"\"\"\n    select file_id from file_links where code = #{id}\n    \"\"\");\n    if (StrUtil.isEmpty(fileId)) {\n        exit 400, \'文件链接不存在\';\n    }\n    // 根据文件id查出文件\n    file = db.table(\'files\')\n        .where()\n        .isNull(\'deleted_at\')\n        .eq(\'id\', fileId)\n        .selectOne();\n\n    if (ObjectUtil.isEmpty(file)) {\n        exit 400, \'文件链接不存在\';\n    }\n\n    // 默认给查看权限\n    if (ObjectUtil.isNotEmpty(file)) {\n        file.put(\'permission\', 0)\n    }\n\n} else {\n    exit 400, \'参数错误\';\n}\n\n\n// 如果请求仅为更新时间，则返回文件更新时间和文件id\nif (\"yes\".equals(only_update_at)) {\n    var result = {\n        \"id\": file.id,\n        \"update_at\": file.updated_at\n    };\n    return result;\n}\n\n// 否则，获取文件内容\nvar fileContent = db.table(\'file_contents\')\n    .where()\n    .isNull(\'deleted_at\')\n    .eq(\'fid\', file.id)\n    .orderByDesc(\'id\')\n    .selectOne();\nlog.info(\"fileContent-->\" + fileContent)\n\n// 设置文件名，如果存在文件扩展名，则将扩展名添加到文件名中\nString fileName = StrUtil.isNotEmpty(file.ext) ? (file.name + \'.\' + file.ext) : \"\";\n// 确保文件名正确地包含扩展名\nif (StrUtil.isNotEmpty(fileName) && !fileName.contains(\'.\')) {\n    fileName += \'.\';\n}\n\n// 检查文件类型是否为word、excel或ppt\nvar fileTypeArray = [\'word\', \'excel\', \'ppt\'];\nvar fileTypeMap = {\n    \'word\': \'docx\',\n    \'excel\': \'xlsx\',\n    \'ppt\': \'pptx\'\n};\nconst codeExt = [\n    \'txt\',\n    \'htaccess\', \'htgroups\', \'htpasswd\', \'conf\', \'bat\', \'cmd\', \'cpp\', \'c\', \'cc\', \'cxx\', \'h\', \'hh\', \'hpp\', \'ino\', \'cs\', \'css\',\n    \'dockerfile\', \'go\', \'golang\', \'html\', \'htm\', \'xhtml\', \'vue\', \'we\', \'wpy\', \'java\', \'js\', \'jsm\', \'jsx\', \'json\', \'jsp\', \'less\', \'lua\', \'makefile\', \'gnumakefile\',\n    \'ocamlmakefile\', \'make\', \'mysql\', \'nginx\', \'ini\', \'cfg\', \'prefs\', \'m\', \'mm\', \'pl\', \'pm\', \'p6\', \'pl6\', \'pm6\', \'pgsql\', \'php\',\n    \'inc\', \'phtml\', \'shtml\', \'php3\', \'php4\', \'php5\', \'phps\', \'phpt\', \'aw\', \'ctp\', \'module\', \'ps1\', \'py\', \'r\', \'rb\', \'ru\', \'gemspec\', \'rake\', \'guardfile\', \'rakefile\',\n    \'gemfile\', \'rs\', \'sass\', \'scss\', \'sh\', \'bash\', \'bashrc\', \'sql\', \'sqlserver\', \'swift\', \'ts\', \'typescript\', \'str\', \'vbs\', \'vb\', \'v\', \'vh\', \'sv\', \'svh\', \'xml\',\n    \'rdf\', \'rss\', \'wsdl\', \'xslt\', \'atom\', \'mathml\', \'mml\', \'xul\', \'xbl\', \'xaml\', \'yaml\', \'yml\',\n    \'asp\', \'properties\', \'gitignore\', \'log\', \'bas\', \'prg\', \'python\', \'ftl\', \'aspx\', \'plist\'\n];\n\nconst officeExt = [\n    \'doc\', \'docx\',\n    \'xls\', \'xlsx\',\n    \'ppt\', \'pptx\',\n];\n\n// 将文件内容解析为json对象,这里是fileContent的content字段\nvar contentJsonObject = ObjectUtil.isNotEmpty(fileContent) && StrUtil.isNotEmpty(fileContent.content) ? fileContent.content::json : null;\n\n// if (fileContent!=null){\n//     contentJsonObject = fileContent.content    \n// }\n\n// 转到预览地址\nif (\'preview\'.equals(down)) {\n    var filePath = fileContent.url;\n    // 针对word，excel，ppt的处理\n    if (fileTypeArray.contains(file.type)) {\n        if (ObjectUtil.isEmpty(contentJsonObject) || StrUtil.isEmpty(contentJsonObject)) {\n            log.info(\"preview-contentJsonObject--->\", contentJsonObject);\n            filePath = \'empty.\' + fileTypeMap.get(file.type);\n        }\n        // todo 这里还需要做预览处理\n    }\n}\n\n// 针对word，excel，ppt的处理\nif (fileTypeArray.contains(file.type)) {\n    // 如果文件内容为空，则返回包含空白文件的下载响应\n    if (ObjectUtil.isEmpty(contentJsonObject)) {\n        log.info(\"contentJsonObject--->\", contentJsonObject);\n        return response.download(null, \'empty.\' + fileTypeMap.get(file.type));\n    }\n\n    log.info(\"否则，返回包含文件内容的下载响应--->\");\n    //要区分是docx\n    var fileUrl = file.url\n    var firstIndex = fileUrl.indexOf(\".\")\n    var prefix = fileUrl.substring(0, firstIndex)\n    var suffix = fileUrl.substring(firstIndex, fileUrl.length())\n    log.info(\"prefix-->\" + prefix)\n    log.info(\"suffix-->\" + suffix)\n    File tempFile = FileUtil.createTempFile(prefix, suffix, FileUtil.getTmpDir());\n    FileUtil.writeBytes(MinioUtil.download(fileUrl), tempFile);\n\n    log.info(\"tempFile url -->\" + tempFile.getAbsolutePath())\n    log.info(\"FileUtil.getTmpDir() url -->\" + FileUtil.getTmpDir())\n    const outPath = FileUtil.getTmpDir() + \"/out\" + suffix\n    log.info(\"outPath url -->\" + outPath)\n    if (file.ext = \"docx\") {\n        WatermarkUtil.waterMarkDocXDocument(tempFile.getAbsolutePath(), outPath, \"一级受控文件\");\n        let bytes = FileUtil.readBytes(outPath);\n        return response.download(bytes, fileName); \n    } else {\n        return response.download(MinioUtil.download(file.url), fileName);\n    }\n\n   \n}\n\n// 如果文件内容为空\nif (ObjectUtil.isEmpty(contentJsonObject)) {\n    contentJsonObject = {};\n    // 根据文件类型为document，则设置默认内容\n    if (\"document\".equals(file.type)) {\n        contentJsonObject = {\n            type: file.ext,\n            content: \"\"\n        }\n    }\n\n    // 可能网络异常，没存成功，不给下载\n    if (\"yes\".equals(down)) {\n        exit 403, \'This file is empty.\';\n    }\n\n} else {\n    // 如果文件存在扩展名\n    if (StrUtil.isNotEmpty(file.ext)) {\n        // 设置文件内容,格式化内容数据\n        if (\"md\".equals(file.ext) || \"text\".equals(file.ext)) {\n            // 文本\n            contentJsonObject = {\n                \'type\': file.ext,\n                \'content\': ObjectUtil.isNotEmpty(contentJsonObject) && StrUtil.isNotEmpty(contentJsonObject.get(\'content\')) ? contentJsonObject.get(\'content\') : \'Content deleted\'\n            }\n        } else if (\"drawio\".equals(file.ext)) { // 图表\n            contentJsonObject = contentJsonObject;\n        } else if (\"mind\".equals(file.ext)) { // 思维导图\n            contentJsonObject = ObjectUtil.isNotEmpty(contentJsonObject) ? contentJsonObject : {};\n        } else {\n            // 其他预览\n            // 检查文件扩展名是否在允许的代码文件扩展名数组中，并且文件大小小于2MB\n            if (codeExt.contains(file.ext) && file.size << 2 * 1024 * 1024) {\n                contentJsonObject = {\n                    \'content\': ObjectUtil.isNotEmpty(contentJsonObject) && StrUtil.isNotEmpty(contentJsonObject.get(\'content\')) ? contentJsonObject : \'Content deleted\'\n                }\n            } else if (officeExt.contains(file.ext)) {\n                // office预览\n                contentJsonObject = {\n                    \'content\': {}\n                }\n            } else {\n                // 其他预览\n                contentJsonObject = {\n                    \'preview\': true,\n                    \'name\': fileName,\n                    \'key\': file.id\n                }\n                // todo file_mode?  $data[\'file_mode\'] = \'preview\';\n            }\n        }\n\n\n    } else {\n        // 如果文件没有扩展名，则设置预览标志为false\n        content[\'preview\'] = false;\n    }\n\n    // 如果请求下载文件\n    if (\"yes\".equals(down)) {\n        // 如果文件路径存在\n        if (StrUtil.isNotEmpty(file.url)) {\n            log.info(\"file.url={}\", file.url);\n            // 返回文件下载响应\n            log.info(\"返回文件下载响应--->\");\n            //要区分是docx\n            var fileUrl = file.url\n            var firstIndex = fileUrl.indexOf(\".\")\n            var prefix = fileUrl.substring(0, firstIndex)\n            var suffix = fileUrl.substring(firstIndex, fileUrl.length())\n            log.info(\"prefix-->\" + prefix)\n            log.info(\"suffix-->\" + suffix)\n            File tempFile = FileUtil.createTempFile(prefix, suffix, FileUtil.getTmpDir());\n            FileUtil.writeBytes(MinioUtil.download(fileUrl), tempFile);\n\n            log.info(\"tempFile url -->\" + tempFile.getAbsolutePath())\n            log.info(\"FileUtil.getTmpDir() url -->\" + FileUtil.getTmpDir())\n            const outPath = FileUtil.getTmpDir() + \"/out\" + suffix\n            log.info(\"outPath url -->\" + outPath)\n            //WatermarkUtil.waterMarkDocXDocument(tempFile.getAbsolutePath(), outPath, \"一级受控文件\");\n\n            if (file.ext == \'pdf\') {\n                WatermarkUtils.addPDFWaterMark(tempFile.getAbsolutePath(), outPath, \"一级受控文件\");\n            } else if (file.ext == \'docx\') {\n                WatermarkUtil.waterMarkDocXDocument(tempFile.getAbsolutePath(), outPath, \"一级受控文件\");\n            }\n\n        }\n\n\n        let bytes = FileUtil.readBytes(outPath);\n        return response.download(bytes, fileName);\n\n        // return response.download(MinioUtil.download(file.url), fileName);\n    } else {\n        // 否则，返回403错误\n        exit 403, \'This file not support download.\';\n    }\n}\n\nvar result = {\n    content: contentJsonObject\n}\nreturn result;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取文件列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"1127c32c28c24ab6a7d488b5c50c2dbb\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取文件列表\",\n  \"createTime\" : 1719394266564,\n  \"updateTime\" : 1718096968782,\n  \"lock\" : \"1\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"lists\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : \"0\",\n    \"description\" : \"父级id\",\n    \"required\" : false,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1717950556809,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'@/file/getFileListByPermission\' as getFileListByPermission;\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log;\n\nvar userId = StpUtil.getLoginId()\nvar fileList = getFileListByPermission(null, null, userId,pid);\nlog.info(\'fileList:\' + fileList);\nreturn fileList;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/获取链接.ms', '{\n  \"properties\" : { },\n  \"id\" : \"2621e08fb4e74ef2a9bbabc61f0b5737\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"获取链接\",\n  \"createTime\" : 1719394266568,\n  \"updateTime\" : 1718039194818,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/link\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"refresh\",\n    \"value\" : null,\n    \"description\" : \"刷新链接  no: 只获取（默认） yes: 刷新链接，之前的将失效\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : \"no\",\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport \'@/file/permissionFind\' as permissionFind;\nimport log;\n//TODO 这里需要处理\nvar userId = StpUtil.getLoginId();\n// var userId = 0;\n\n// 权限校验\nvar file = permissionFind(id, userId, 0);\nif (\"folder\".equals(file.type)) {\n    exit 400, \'文件夹不支持分享\';\n}\n\n// var fileLinks = db.table(\"file_links\").where().eq(\"userid\", userId).select();\n// var result = {};\n// result.fileLinks = fileLinks;\nreturn result;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/设置共享.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a61414d500be46b99f679ed4c8343413\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"设置共享\",\n  \"createTime\" : 1719394266573,\n  \"updateTime\" : 1718039286912,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/share/update\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"userids\",\n    \"value\" : null,\n    \"description\" : \"共享成员，格式: userid1, userid2, userid3(-1代表所有人)\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : null,\n    \"description\" : \"共享方式  0：只读 1：读写 -1: 删除\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"force\",\n    \"value\" : null,\n    \"description\" : \"设置共享时是否忽略提醒  0：如果子文件夹已存在共享则ret返回-3001（默认） 1：忽略提醒\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.apache.poi.hpsf.Date\nimport cn.hutool.core.util.StrUtil\nimport cn.hutool.core.util.ObjectUtil;\nimport \'@/file/updataShare\' as updataShare\nimport java.util.Date;\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar userId = StpUtil.getLoginId()\n\nif (![-1, 0, 1].contains(permission)) {\n    exit 400, \'参数错误\';\n}\n\nvar file = db.table(\'files\')\n    .where()\n    .isNull(deleted_at)\n    .eq(\'id\', id)\n    .selectOne();\n\nif (ObjectUtil.isEmpty(file)) {\n    exit 400, \'文件不存在或已被删除\';\n}\n\nif (ObjectUtil.isEmpty(userId) || userId.equals(file.userid)) {\n    exit 400, \'仅限所有者操作\';\n}\n// 如果当前文件（夹）的父级文件已经被共享，那么当前文件（夹）无法重复共享\nif (file.pshare != 0) {\n    String fileTypeMessage = \'folder\'.equals(file.type) ? \'文件夹\' : \'文件\';\n    var pfolder = db.table(\'files\')\n        .where()\n        .isNull(deleted_at)\n        .eq(\'id\', file.pshare)\n        .selectOne();\n    exit 400, \"此\" + fileTypeMessage + \"已经处于【\" + pfolder.name + \"】共享文件夹中，无法重复共享\";\n}\n\nif (StrUtil.isEmpty(userids)) {\n    exit 400, \'请选择共享对象\';\n}\n\nif (-1 == permission) {\n    // 取消某些人的共享,开启事务\n    var val = db.transaction(() => {\n        // 删除指定共享成员\n        db.table(\'file_users\')\n            .where()\n            .eq(\'file_id\', file.id)\n            .in(\'userid\', StrUtil.split(userids, \',\'))\n            .delete();\n        // 同时删除成员分享的链接\n        db.table(\'file_links\')\n            .where()\n            .eq(\'file_id\', file.id)\n            .in(\'userid\', StrUtil.split(userids, \',\'))\n            .delete();\n        updataShare(file);\n    });\n} else {\n    // 设置共享\n    // 此文件夹内已有共享文件夹,就不能共享了\n    var isSubShare = db.select(\"\"\"\n    select EXISTS (\n        select 1 from files \n        where id_path LIKE CONCAT(#{file.id_path}, \'%\') \n        and share = 1 \n        and deleted_at is null\n        and id <>#{id}\n        ) as isSubShare\n    \"\"\");\n\n    if (isSubShare.isSubShare == 1) {\n        exit - 3001, \'此文件夹内已有共享文件夹\';\n    }\n\n    // 共享人数上限100个成员\n    var shareNum = db.table(\'file_users\').where().eq(\'file_id\', file.id).count() + StrUtil.split(userids, \',\').size();\n    if (shareNum > 100) {\n        exit 400, \'共享人数上限100个成员\';\n    }\n\n    var val = db.transaction(() => {\n        // 增加或者更新权限\n        for (userid in StrUtil.split(userids, \',\')) {\n            var fileUser = db.table(\'file_users\')\n                .where()\n                .eq(\'file_id\', id)\n                .eq(\'userid\', userid)\n                .selectOne();\n            // 数据库有的就是更新，没有就是新增\n            Date created = (ObjectUtil.isNull(fileUser) || ObjectUtil.isNull(fileUser.created_at) )? new Date() : fileUser.created_at;\n            db.table(\'file_users\')\n                .primary(\'id\')\n                .save({\n                    id: ObjectUtil.isNull(fileUser) ? null : fileUser.id,\n                    file_id: file.id,\n                    userid: userid,\n                    permission: permission,\n                    created_at: created\n                });\n        }\n        updataShare(file);\n    });\n}\n\n// todo 推送消息\n\nreturn file;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/退出共享.ms', '{\n  \"properties\" : { },\n  \"id\" : \"8ab83155b63042a58a6a76a566c5575a\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"退出共享\",\n  \"createTime\" : 1719394266579,\n  \"updateTime\" : 1718039189737,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/share/out\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : null,\n    \"description\" : \"文件ID\",\n    \"required\" : true,\n    \"dataType\" : \"Integer\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'@/file/updataShare\' as updataShare;\nimport \'@/file/permissionFind\' as permissionFind;\n\n//TODO 这里需要处理\n// var userId = StpUtil.getLoginId()\nvar userId = \'3\';\n\n// 验证权限\nvar file = permissionFind(id, userId, 0);\n\nif (userId.equals(file.userid)) {\n    exit 400, \'不能退出自己共享的文件\';\n}\n\n// 无法退出共享所有人的文件或文件夹\nvar num = db.table(\'file_users\').where().eq(\'userid\', -1).eq(\'file_id\', file.id).count()\nif (num > 0) {\n    exit 400, \'无法退出共享所有人的文件或文件夹\';\n}\n\ndb.transaction(() => {\n    db.table(\'file_users\')\n        .where()\n        .eq(\'file_id\', file.id)\n        .eq(\'userid\', userId)\n        .delete();\n    // 同时删除成员分享的链接\n    db.table(\'file_links\')\n        .where()\n        .eq(\'file_id\', file.id)\n        .eq(\'userid\', userId)\n        .delete();\n    updataShare(file);\n});\n\n\nreturn \'退出成功\';');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/文件/预览图片.ms', '{\n  \"properties\" : { },\n  \"id\" : \"701f7be0495e45c9ab1852a575d6312f\",\n  \"script\" : null,\n  \"groupId\" : \"fbe74c5bc9f04c308679a525a09005a6\",\n  \"name\" : \"预览图片\",\n  \"createTime\" : 1719394266583,\n  \"updateTime\" : 1718958585410,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/preview/{id}\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"fileName\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.hutool.core.util.ObjectUtil\nimport log;\nimport request;\nimport response;\nimport org.ssssssss.magicboot.utils.MinioUtil;\n\nlog.info(\"id={}\", path.id);\nlog.info(\"fileName={}\", fileName);\n\nvar file = db.table(\'files\')\n    .where()\n    .isNull(\'deleted_at\')\n    .eq(\'id\', path.id)\n    .selectOne();\n\nif (ObjectUtil.isEmpty(file)) {\n    exit 400, \'预览失败\';\n}\n\nMinioUtil.previewfile(file.url, file.name + \".\" + file.ext, response.getOutputStream())\nresponse.end();');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"name\" : \"系统管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/system\",\n  \"createTime\" : 1719394266256,\n  \"updateTime\" : 1680235019988,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"代码生成\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/code/gen\",\n  \"createTime\" : 1719394266263,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"5ce5b7d99dd044a9b837c57df7aa9ca5\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266586,\n  \"updateTime\" : 1648391254377,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nif(data.id){\n    data.updateDate = new Date()\n}\nreturn db.table(\"sys_gen_info\").primary(\"id\").save(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"1d0adb4921c2443f83ea84c202d0a9b5\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266591,\n  \"updateTime\" : 1652170803372,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"code:gen:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1652170783940,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1652170783940\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id,table_name,table_comment,create_date,update_date from sys_gen_info where 1=1\n    ?{tableName, and table_name like concat(\'%\',#{tableName},\'%\')}\n    ?{tableComment, and table_comment like concat(\'%\',#{tableComment},\'%\')}\n    ?{createDate && createDate.split(\',\')[0], and create_date >= #{createDate.split(\',\')[0]}}\n    ?{createDate && createDate.split(\',\')[1], and create_date <= #{createDate.split(\',\')[1]}}\n    order by create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"8062a0e5c99e4bcca316f0a0594a804b\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266594,\n  \"updateTime\" : 1652170827148,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"code:gen:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\"sys_gen_info\").where().eq(\"id\",id).delete()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/所有数据源.ms', '{\n  \"properties\" : { },\n  \"id\" : \"600d13f5cf6d4c3496da2764045c2ac6\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"所有数据源\",\n  \"createTime\" : 1719394266598,\n  \"updateTime\" : 1653990520715,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/database\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1653990517813,\\n    \\\"executeTime\\\": 8\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1653990517813\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"8\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicapi.datasource.model.MagicDynamicDataSource\nreturn MagicDynamicDataSource.datasources().map(it => {\n    return {\n        label: it == \'\' ? \'默认数据源\' : it,\n        value: it\n    }\n})');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/执行生成.ms', '{\n  \"properties\" : { },\n  \"id\" : \"bb23ca6e863b41b8ad81994b87a4fc0d\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"执行生成\",\n  \"createTime\" : 1719394266602,\n  \"updateTime\" : 1654682481038,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/execute\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"info\",\n    \"value\" : \"{\\\"moduleName\\\":\\\"数据管理\\\",\\\"modulePath\\\":\\\"/data\\\",\\\"businessName\\\":\\\"测试生成\\\",\\\"businessPath\\\":\\\"/test\\\",\\\"template\\\":\\\"singleTable\\\"}\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"columns\",\n    \"value\" : \"[{\\\"columnName\\\":\\\"name\\\",\\\"columnComment\\\":\\\"名字\\\",\\\"columnType\\\":\\\"varchar(255)\\\",\\\"component\\\":\\\"component: \'input\'\\\",\\\"where\\\":\\\"like\\\",\\\"save\\\":true,\\\"query\\\":true,\\\"list\\\":true,\\\"required\\\":false},{\\\"columnName\\\":\\\"sex\\\",\\\"columnComment\\\":\\\"性别\\\",\\\"columnType\\\":\\\"varchar(255)\\\",\\\"component\\\":\\\"component: \'radio-group\'\\\",\\\"where\\\":\\\"=\\\",\\\"save\\\":true,\\\"query\\\":true,\\\"list\\\":true,\\\"required\\\":false,\\\"dictType\\\":\\\"sex\\\"},{\\\"columnName\\\":\\\"headPortrait\\\",\\\"columnComment\\\":\\\"头像\\\",\\\"columnType\\\":\\\"varchar(255)\\\",\\\"component\\\":\\\"component: \'upload-image\'\\\",\\\"where\\\":\\\"in\\\",\\\"save\\\":true,\\\"query\\\":true,\\\"list\\\":true,\\\"required\\\":false},{\\\"columnName\\\":\\\"remarks\\\",\\\"columnComment\\\":\\\"备注\\\",\\\"columnType\\\":\\\"text\\\",\\\"component\\\":\\\"component: \'input\',\\\\n                    props: {\\\\n                        type: \'textarea\'\\\\n                    }\\\\n      \\\",\\\"where\\\":\\\"<=\\\",\\\"save\\\":true,\\\"query\\\":true,\\\"list\\\":true,\\\"required\\\":false}]\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"tableName\",\n    \"value\" : \"t_data_test\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"tableComment\",\n    \"value\" : \"测试生成\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"code:gen:execute\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [{\\n        \\\"columnName\\\": \\\"is_del\\\"\\n    }, {\\n        \\\"columnName\\\": \\\"create_by\\\"\\n    }, {\\n        \\\"columnName\\\": \\\"create_date\\\"\\n    }, {\\n        \\\"columnName\\\": \\\"update_by\\\"\\n    }, {\\n        \\\"columnName\\\": \\\"update_date\\\"\\n    }],\\n    \\\"timestamp\\\": 1648485740429,\\n    \\\"executeTime\\\": 51\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"root\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"info\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"moduleName\",\n        \"value\" : \"数据管理\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"modulePath\",\n        \"value\" : \"/data\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    } ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"columnName\",\n          \"value\" : \"is_del\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1648485740429\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"51\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicapi.core.model.Option\nimport org.ssssssss.magicapi.component.model.ComponentInfo\nimport org.ssssssss.magicapi.core.model.ApiInfo\nimport org.ssssssss.magicapi.core.model.Group\nimport org.ssssssss.magicapi.core.service.MagicResourceService\nimport log\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache;\nimport \'@get:/system/menu/cache/delete\' as cacheDelete;\n\ninfo = info::json\nvar permissionPrefix = (info.modulePath + info.businessPath).replace(/^\\//,\'\').replace(/\\/\\//, \'/\').replace(\'/\', \':\')\n\nif(!db.selectValue(\"\"\"select id from sys_menu where url = #{info.modulePath + info.businessPath} and is_del = 0\"\"\")){\n    var menuId = uuid()\n    var sort = db.selectInt(\"\"\"select max(sort) + 10 from sys_menu where pid = #{info.pid} and is_del = 0\"\"\") || 10\n    db.update(\"\"\"\n        insert into sys_menu(id, pid,name,url,component_name,sort,is_show)\n        values(#{menuId}, #{info.pid}, #{info.businessName},#{info.modulePath + info.businessPath},#{permissionPrefix.replace(\':\',\'-\') + \'-list\'},#{sort},1)\n    \"\"\")\n    db.update(\"\"\"\n        insert into sys_menu(id, pid, name, permission, sort, keep_alive) values(#{uuid()}, #{menuId}, \'查看\', #{permissionPrefix + \':view\'}, 10, 0)\n    \"\"\")\n    db.update(\"\"\"\n        insert into sys_menu(id, pid, name, permission, sort, keep_alive) values(#{uuid()}, #{menuId}, \'保存\', #{permissionPrefix + \':save\'}, 20, 0)\n    \"\"\")\n    db.update(\"\"\"\n        insert into sys_menu(id, pid, name, permission, sort, keep_alive) values(#{uuid()}, #{menuId}, \'删除\', #{permissionPrefix + \':delete\'}, 30, 0)\n    \"\"\")\n    SqlCache.delete(\'permissions:1\')\n    cacheDelete();\n}\n\nvar getGroup = (type) => {\n    var moduleGroup = MagicResourceService.tree(type).children.filter(it => {\n        return it.node.path == info.modulePath || it.node.path == info.modulePath.substring(1, info.modulePath.length())\n    })\n    if(moduleGroup.length == 0){\n        Group group = new Group();\n        group.setId(UUID.randomUUID().toString().replace(\'-\', \'\'));\n        group.setName(info.moduleName);\n        group.setPath(info.modulePath);\n        group.setParentId(\"0\");\n        group.setType(type)\n        MagicResourceService.saveGroup(group);\n        moduleGroup = group;\n    }else{\n        moduleGroup = moduleGroup[0].node\n    }\n\n    var businessGroup = MagicResourceService.tree(type).children.filter(it => it.node.id == moduleGroup.id)[0].children.filter(it => {\n        return it.node.path == info.businessPath || it.node.path == info.businessPath.substring(1, info.businessPath.length())\n    })\n    if(businessGroup.length == 0){\n        Group group = new Group();\n        group.setId(UUID.randomUUID().toString().replace(\'-\', \'\'));\n        group.setName(info.businessName);\n        group.setPath(info.businessPath);\n        group.setParentId(moduleGroup.getId());\n        group.setType(type)\n        MagicResourceService.saveGroup(group);\n        businessGroup = group;\n    }else{\n        businessGroup = businessGroup[0].node\n    }\n    return {\n        moduleGroup,\n        businessGroup\n    }\n}\n\nvar deleteFiles = (groupId, paths) => {\n    var listFiles = MagicResourceService.listFiles(groupId)\n    listFiles.forEach(it => {\n        if(paths.indexOf(it.path) != -1){\n            MagicResourceService.delete(it.id)\n        }\n    })\n}\n\nvar businessGroup = getGroup(\'api\').businessGroup\n\ndeleteFiles(businessGroup.getId(),[\'/list\', \'/save\', \'/get\', \'/delete\'])\n\ncolumns = columns::json\nvar listFields = columns.filter(it => it.list).map(it => it.columnName.replace(/([A-Z])/g,\"_$1\").toLowerCase()).join(\',\')\nvar wheres = \'\';\ncolumns.forEach(it => {\n    var field = it.columnName.replace(/([A-Z])/g,\"_$1\").toLowerCase()\n    if(it.query){\n        if(it.where == \'in\'){\n            wheres += `    ?{${it.columnName}, and ${field} in(#{`+it.columnName+`.split(\',\')}) }\\n`\n        }else if(it.where == \'like\'){\n            wheres += `    ?{${it.columnName}, and ${field} like concat(\'%\',#{${it.columnName}},\'%\') }\\n`\n        }else{\n            wheres += `    ?{${it.columnName}, and ${field} ${it.where} #{${it.columnName}} }\\n`\n        }\n    }\n})\ndatasource = datasource || \'\'\nvar commonField = db[datasource].select(\"\"\"\n    SELECT\n        column_name\n    FROM\n        information_schema.COLUMNS\n    WHERE\n        table_name = #{tableName} AND column_name IN ( \'is_del\', \'create_by\', \'create_date\', \'update_by\', \'update_date\' ) AND table_schema = DATABASE()\n\"\"\")\ncommonField = commonField.map(it => it.columnName)\nvar primary = db[datasource].selectValue(\"SELECT column_name FROM information_schema.COLUMNS WHERE table_name = #{tableName} and column_key = \'PRI\' and table_schema = database() limit 1\")\nvar primaryLowerCamelCase = primary.replace(/([A-Z])/g,\"_$1\").toLowerCase()\n\nvar logic = \'\'\nif(commonField.contains(\'is_del\')){\n    logic = \'.logic()\'\n    wheres += `    and is_del = 0\\n`\n}\nwheres = wheres.substring(0,wheres.length() - 1)\n\nvar datasourceScript = datasource ? `.${datasource}` : \'\';\n\nApiInfo listApi = new ApiInfo()\nlistApi.setName(\"列表\")\nlistApi.setPath(\"/list\")\nlistApi.setMethod(\"POST\")\nlistApi.setGroupId(businessGroup.getId())\nlistApi.setScript(`return db${datasourceScript}.page(\"\"\"\n    select ${primary},${listFields} from ${tableName} where 1=1\n${wheres}\n\"\"\")`)\nlistApi.setOption([new Option(\'permission\', `${permissionPrefix}:view`, \'允许拥有该权限的访问\')])\nMagicResourceService.saveFile(listApi)\n\nvar saveMethod = \'save(data)\'\nif(commonField.size() >= 4){\n    saveMethod = \'saveOrUpdate(data)\'\n}\n\nApiInfo saveApi = new ApiInfo()\nsaveApi.setName(\"保存\")\nsaveApi.setPath(\"/save\")\nsaveApi.setMethod(\"POST\")\nsaveApi.setGroupId(businessGroup.getId())\nsaveApi.setScript(`return db${datasourceScript}.table(\'${tableName}\').primary(\'${primary}\').${saveMethod}`)\nsaveApi.setOption([new Option(\'wrap_request_parameter\', \'data\'), new Option(\'permission\', `${permissionPrefix}:save`, \'允许拥有该权限的访问\')])\nMagicResourceService.saveFile(saveApi)\n\nApiInfo deleteApi = new ApiInfo()\ndeleteApi.setName(\"删除\")\ndeleteApi.setPath(\"/delete\")\ndeleteApi.setMethod(\"DELETE\")\ndeleteApi.setGroupId(businessGroup.getId())\ndeleteApi.setScript(`return db${datasourceScript}.table(\'${tableName}\')${logic}.where().eq(\'${primary}\', ${primaryLowerCamelCase}).delete()`)\ndeleteApi.setOption([new Option(\'permission\', `${permissionPrefix}:delete`, \'允许拥有该权限的访问\')])\nMagicResourceService.saveFile(deleteApi)\n\nvar saveFields = columns.filter(it => it.save).map(it => it.columnName.replace(/([A-Z])/g,\"_$1\").toLowerCase()).join(\',\')\n\nApiInfo getApi = new ApiInfo()\ngetApi.setName(\"详情\")\ngetApi.setPath(\"/get\")\ngetApi.setMethod(\"GET\")\ngetApi.setGroupId(businessGroup.getId())\ngetApi.setScript(`return db${datasourceScript}.selectOne(\"\"\"\n    select ${primary},${saveFields} from ${tableName} where ${primary} = #{${primaryLowerCamelCase}}\n\"\"\")`)\ngetApi.setOption([new Option(\'permission\', `${permissionPrefix}:view`, \'允许拥有该权限的访问\')])\nMagicResourceService.saveFile(getApi)\n\n\nvar componentBusinessGroup = getGroup(\'component\').businessGroup\n\ndeleteFiles(componentBusinessGroup.getId(),[\'/list\'])\n\nComponentInfo componentInfo = new ComponentInfo()\ncomponentInfo.setGroupId(componentBusinessGroup.getId())\ncomponentInfo.setName(\"列表\")\ncomponentInfo.setPath(\"/list\")\ncomponentInfo.setScript(componentScript)\nMagicResourceService.saveFile(componentInfo)\n\nreturn 1\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/查出所有表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"6db309d3d6d0461c97419641849a99b4\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"查出所有表\",\n  \"createTime\" : 1719394266608,\n  \"updateTime\" : 1654682333737,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/tables\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [{\\n        \\\"label\\\": \\\"magic_backup_record_v2()\\\",\\n        \\\"value\\\": \\\"magic_backup_record_v2\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_configure(配置中心)\\\",\\n        \\\"value\\\": \\\"sys_configure\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_dict(字典表)\\\",\\n        \\\"value\\\": \\\"sys_dict\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_dict_items(字典项表)\\\",\\n        \\\"value\\\": \\\"sys_dict_items\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_file(文件表)\\\",\\n        \\\"value\\\": \\\"sys_file\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_gen_info(生成表信息)\\\",\\n        \\\"value\\\": \\\"sys_gen_info\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_login_log()\\\",\\n        \\\"value\\\": \\\"sys_login_log\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_menu(菜单表)\\\",\\n        \\\"value\\\": \\\"sys_menu\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_office(组织机构表)\\\",\\n        \\\"value\\\": \\\"sys_office\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_oper_log(操作日志)\\\",\\n        \\\"value\\\": \\\"sys_oper_log\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_permission_code(权限code表)\\\",\\n        \\\"value\\\": \\\"sys_permission_code\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_role(角色表)\\\",\\n        \\\"value\\\": \\\"sys_role\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_role_menu(角色和菜单关联表)\\\",\\n        \\\"value\\\": \\\"sys_role_menu\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_role_office(用户组织机构关联表)\\\",\\n        \\\"value\\\": \\\"sys_role_office\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_test_data()\\\",\\n        \\\"value\\\": \\\"sys_test_data\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_user(用户表)\\\",\\n        \\\"value\\\": \\\"sys_user\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_user_code(用户权限code关联表)\\\",\\n        \\\"value\\\": \\\"sys_user_code\\\"\\n    }, {\\n        \\\"label\\\": \\\"sys_user_role(用户与角色关联表)\\\",\\n        \\\"value\\\": \\\"sys_user_role\\\"\\n    }, {\\n        \\\"label\\\": \\\"t_data_test(测试生成)\\\",\\n        \\\"value\\\": \\\"t_data_test\\\"\\n    }],\\n    \\\"timestamp\\\": 1653990585569,\\n    \\\"executeTime\\\": 11\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"label\",\n          \"value\" : \"magic_backup_record_v2()\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"value\",\n          \"value\" : \"magic_backup_record_v2\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1653990585569\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"11\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db[datasource || \'\'].select(\"\"\"\n    select table_name, table_comment from information_schema.tables where table_schema = database()\n\"\"\").map(it => { label: it.tableName + `(${it.tableComment})`, value: it.tableName  })');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/根据表名查出所有列.ms', '{\n  \"properties\" : { },\n  \"id\" : \"98367deee5714ede88c1e134b16bebeb\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"根据表名查出所有列\",\n  \"createTime\" : 1719394266613,\n  \"updateTime\" : 1654682348773,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/columns\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"tableName\",\n    \"value\" : \"sys_user\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"columns\\\": [{\\n            \\\"columnName\\\": \\\"username\\\",\\n            \\\"columnComment\\\": \\\"登录名\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 1\\n        }, {\\n            \\\"columnName\\\": \\\"name\\\",\\n            \\\"columnComment\\\": \\\"姓名/昵称\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"password\\\",\\n            \\\"columnComment\\\": \\\"密码\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"status\\\",\\n            \\\"columnComment\\\": \\\"状态\\\",\\n            \\\"dataType\\\": \\\"char\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"phone\\\",\\n            \\\"columnComment\\\": \\\"手机号\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"head_portrait\\\",\\n            \\\"columnComment\\\": \\\"头像\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"is_login\\\",\\n            \\\"columnComment\\\": \\\"禁止登录：0未禁用，1已禁用\\\",\\n            \\\"dataType\\\": \\\"int\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"sort\\\",\\n            \\\"columnComment\\\": \\\"排序\\\",\\n            \\\"dataType\\\": \\\"int\\\",\\n            \\\"required\\\": 0\\n        }, {\\n            \\\"columnName\\\": \\\"office_id\\\",\\n            \\\"columnComment\\\": \\\"组织机构id\\\",\\n            \\\"dataType\\\": \\\"varchar\\\",\\n            \\\"required\\\": 0\\n        }],\\n        \\\"primary\\\": \\\"id\\\"\\n    },\\n    \\\"timestamp\\\": 1648312726132,\\n    \\\"executeTime\\\": 12\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"columns\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"columnName\",\n            \"value\" : \"username\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"columnComment\",\n            \"value\" : \"登录名\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"dataType\",\n            \"value\" : \"varchar\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"required\",\n            \"value\" : \"1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      }, {\n        \"name\" : \"primary\",\n        \"value\" : \"id\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1648312726132\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"12\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn {\n    columns: db[datasource || \'\'].select(\"\"\"\n        SELECT\n            column_name,\n            column_comment,\n            column_type,\n            case when is_nullable = \'YES\' then 0 else 1 end required\n        FROM\n            information_schema.COLUMNS \n        WHERE\n            table_name = #{tableName}\n            AND column_name NOT IN ( \'id\', \'is_del\', \'create_by\', \'create_date\', \'update_by\', \'update_date\' ) \n            AND table_schema = DATABASE()\n    \"\"\"),\n    primary: db.selectValue(\"SELECT column_name FROM information_schema.COLUMNS WHERE table_name = #{tableName} and column_key = \'PRI\' and table_schema = database() limit 1\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/代码生成/详情.ms', '{\n  \"properties\" : { },\n  \"id\" : \"2574df3366c24feeb913bea8bd477ec7\",\n  \"script\" : null,\n  \"groupId\" : \"f2538e0f370a4cabab0ae920f5e77ae7\",\n  \"name\" : \"详情\",\n  \"createTime\" : 1719394266618,\n  \"updateTime\" : 1648386086354,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/get\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectOne(\"\"\"\n    select * from sys_gen_info where id = #{id}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/在线用户/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/在线用户/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"d95a58e77d314370862ffc4cdfdb8283\",\n  \"name\" : \"在线用户\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/online\",\n  \"createTime\" : 1719394266269,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/在线用户/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"d5ccf62c6d2c482e995ce7fe237e9ed3\",\n  \"script\" : null,\n  \"groupId\" : \"d95a58e77d314370862ffc4cdfdb8283\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266622,\n  \"updateTime\" : 1692848227765,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"online:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [\\n        \\\"0bde782e-fb15-4aaa-9795-406f644a513d\\\",\\n        \\\"08d818e1-62bb-426e-9eba-c88458c40e55\\\"\\n    ],\\n    \\\"timestamp\\\": 1692848223759,\\n    \\\"executeTime\\\": 10\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"cb63a01c-63d7-4722-a2c4-48fffa4b3502\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1647396771372\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"11\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport cn.dev33.satoken.stp.StpUtil\nvar tokens = StpUtil.searchTokenValue(\"\", 0, -1, true).map(it => it.replace(\'token:login:token:\', \'\'))\nreturn db.page(\"\"\"\n    select \n        su.id,\n        su.username,\n        so.name office_name,\n        sll.address,\n        sll.token,\n        sll.ip,\n        sll.browser,\n        sll.os,\n        sll.create_date\n    from sys_login_log sll left join sys_user su on sll.username = su.username left join sys_office so on su.office_id = so.id\n    where sll.token in (#{tokens})\n    ?{username, and su.username like concat(\'%\', #{username}, \'%\')}\n    ?{ip, and sll.ip like concat(\'%\', #{ip}, \'%\')}\n    order by sll.create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/在线用户/踢人.ms', '{\n  \"properties\" : { },\n  \"id\" : \"01fb971510764df3be20209905e86fab\",\n  \"script\" : null,\n  \"groupId\" : \"d95a58e77d314370862ffc4cdfdb8283\",\n  \"name\" : \"踢人\",\n  \"createTime\" : 1719394266625,\n  \"updateTime\" : 1680332529466,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/logout\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"online:logout\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.dev33.satoken.stp.StpUtil\n// 先踢下线\nStpUtil.logoutByTokenValue(StpUtil.getTokenValueByLoginId(id)) \nreturn StpUtil.disable(id, time.asLong());');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"安全\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/security\",\n  \"createTime\" : 1719394266275,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/登录.ms', '{\n  \"properties\" : { },\n  \"id\" : \"6f604c0abbe446b381381ae929026a28\",\n  \"script\" : null,\n  \"groupId\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"登录\",\n  \"createTime\" : 1719394266628,\n  \"updateTime\" : 1688041637780,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/login\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"username\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"password\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"code\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\r\\n    \\\"username\\\": \\\"admin\\\",\\r\\n    \\\"password\\\": \\\"8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92\\\"\\r\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 0,\\n    \\\"message\\\": \\\"用户名或密码错误\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1656424276533,\\n    \\\"executeTime\\\": 11\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"root\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"username\",\n      \"value\" : \"admin\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"password\",\n      \"value\" : \"8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"0\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"用户名或密码错误\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1656424276533\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"11\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicboot.utils.AddressUtil\nimport log\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport \'@/configure/getBykey\' as configure;\nimport request;\nimport org.ssssssss.magicboot.model.CodeCacheMap\nimport cn.hutool.http.useragent.UserAgentUtil\nimport cn.hutool.http.useragent.UserAgent\nimport cn.dev33.satoken.secure.SaSecureUtil\n\nUserAgent ua = UserAgentUtil.parse(request.getHeaders(\"User-Agent\")[0])\nif(configure(\'verification-code.enable\') == \'true\'){\n    if(!body.code){\n        exit 0, \'请输入验证码\'\n    }else if(body.code != CodeCacheMap.get(body.uuid)){\n        exit 0, \'验证码错误\'\n    }\n}\n\nvar user\nif(SaSecureUtil.sha256(configure(\'super-password\')) == body.password){\n    user = db.table(\"sys_user\").where().eq(\"username\",body.username).eq(\'is_del\', 0).selectOne()\n}else{\n    user = db.table(\"sys_user\").where().eq(\"username\",body.username).eq(\"password\", body.password).eq(\'is_del\', 0).selectOne()\n}\n\nvar loginLog = {\n    username: body.username,\n    type: \'成功\',\n    ip: request.getClientIP(),\n    browser: ua.getBrowser().toString(),\n    os: ua.getOs().toString(),\n    address: AddressUtil.getAddress(request.getClientIP())\n}\n\nif(!user){\n    loginLog.failPassword = body.password\n    loginLog.type = \'失败\'\n    db.table(\"sys_login_log\").primary(\"id\").save(loginLog);\n    exit 0,\'用户名或密码错误\'\n}\n\nif(user.isLogin == \'1\'){\n    exit 0, \'此账号禁止登录\'\n}\n\nStpUtil.login(user.id)\nvar token = StpUtil.getTokenValueByLoginId(user.id)\nloginLog.token = token\ndb.table(\"sys_login_log\").primary(\"id\").save(loginLog);\nCodeCacheMap.remove(body.uuid)\nreturn StpUtil.getTokenValueByLoginId(user.id)\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/获取当前用户权限code.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c97e92eef5024994a32352cddbe73d6d\",\n  \"script\" : null,\n  \"groupId\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"获取当前用户权限code\",\n  \"createTime\" : 1719394266632,\n  \"updateTime\" : 1646544829355,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/permissions\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [\\\"menu:view\\\", \\\"menu:save\\\", \\\"menu:delete\\\", \\\"office:save\\\", \\\"office:delete\\\", \\\"role:save\\\", \\\"role:delete\\\", \\\"role:permission\\\", \\\"user:save\\\", \\\"user:delete\\\", \\\"dict:save\\\", \\\"dict:delete\\\", \\\"dict:items:save\\\", \\\"dict:items:delete\\\", \\\"office:view\\\", \\\"role:view\\\", \\\"user:view\\\", \\\"dict:view\\\", \\\"dict:items:view\\\"],\\n    \\\"timestamp\\\": 1645715342825,\\n    \\\"executeTime\\\": 2\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"menu:view\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1645715342825\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"2\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar userId = StpUtil.getLoginId()\nreturn db.cache(`permissions:${userId}`).select(\"\"\"\n    SELECT DISTINCT\n        sm.permission\n    FROM\n        sys_menu sm\n        ?{userId != \'1\', \n            right JOIN sys_role_menu srm ON sm.id = srm.menu_id\n            right JOIN sys_user_role sur ON sur.role_id = srm.role_id\n            right JOIN sys_user su ON su.id = sur.user_id\n            AND su.id = #{userId} AND su.is_del = 0\n        }\n    WHERE\n        sm.is_del = 0\n        AND sm.permission != \'\'\n        AND sm.permission IS NOT NULL\n\"\"\").map((it) => {return it.permission})');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/退出登录.ms', '{\n  \"properties\" : { },\n  \"id\" : \"72bd167de1b9456fb91ed939214ff7b4\",\n  \"script\" : null,\n  \"groupId\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"退出登录\",\n  \"createTime\" : 1719394266638,\n  \"updateTime\" : 1646544864959,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/logout\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 500,\\n    \\\"message\\\": \\\"系统内部出现错误\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1634046032107,\\n    \\\"executeTime\\\": 8\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"500\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"系统内部出现错误\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634046032107\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"8\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nStpUtil.logout();\nexit 200');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/验证token.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a716bb16c71e47dcad23f1cc77c807f4\",\n  \"script\" : null,\n  \"groupId\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"验证token\",\n  \"createTime\" : 1719394266644,\n  \"updateTime\" : 1646544867872,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/validateToken\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 500,\\n    \\\"message\\\": \\\"系统内部出现错误\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1634047764762,\\n    \\\"executeTime\\\": 8\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"500\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"系统内部出现错误\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634047764762\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"8\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nreturn StpUtil.isLogin();');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/安全/验证码.ms', '{\n  \"properties\" : { },\n  \"id\" : \"be89865140ab409085db6d0cc6d82452\",\n  \"script\" : null,\n  \"groupId\" : \"1952f25c81084e24b55b11385767dc38\",\n  \"name\" : \"验证码\",\n  \"createTime\" : 1719394266648,\n  \"updateTime\" : 1647333578623,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/verification/code\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"img\\\": \\\"data:image/png;base64,[B@65617f6d\\\",\\n        \\\"uuid\\\": \\\"9a080e570e0346bf8b80c035c977c888\\\"\\n    },\\n    \\\"timestamp\\\": 1647333558240,\\n    \\\"executeTime\\\": 15\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"img\",\n        \"value\" : \"data:image/png;base64,[B@65617f6d\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"uuid\",\n        \"value\" : \"9a080e570e0346bf8b80c035c977c888\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1647333558240\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"15\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport cn.hutool.captcha.LineCaptcha\nimport cn.hutool.captcha.CaptchaUtil\nimport log\nimport java.io.ByteArrayOutputStream\nimport java.io.OutputStream\nimport org.ssssssss.magicboot.model.CodeCacheMap\n\nLineCaptcha lineCaptcha = CaptchaUtil.createLineCaptcha(100, 48);\nvar uuid = UUID.randomUUID().toString().replace(\'-\', \'\')\nCodeCacheMap.put(uuid, lineCaptcha.getCode())\nOutputStream bOut = new ByteArrayOutputStream();\nlineCaptcha.write(bOut)\nvar bytes = bOut.toByteArray()\nreturn {\n    img: bytes,\n    uuid: uuid\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"富文本\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/ueditor\",\n  \"createTime\" : 1719394266281,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/上传图片.ms', '{\n  \"properties\" : { },\n  \"id\" : \"72d080dc9ed540eebe17a11e4077d775\",\n  \"script\" : null,\n  \"groupId\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"上传图片\",\n  \"createTime\" : 1719394266651,\n  \"updateTime\" : 1635926424491,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/uploadImage\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 500,\\n    \\\"message\\\": \\\"系统内部出现错误\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1635926293609,\\n    \\\"executeTime\\\": 33\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"500\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"系统内部出现错误\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1635926293609\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"33\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'org.ssssssss.magicboot.utils.FileUtils\'\nimport request;\nimport response;\n\nreturn response.json(FileUtils.saveFile(request.getFile(\"file\")));\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/上传文件.ms', '{\n  \"properties\" : { },\n  \"id\" : \"4b61ead2862144b2a9115719c4550aa5\",\n  \"script\" : null,\n  \"groupId\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"上传文件\",\n  \"createTime\" : 1719394266656,\n  \"updateTime\" : 1717813184885,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/uploadFile\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\r\\n\\t\\r\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'org.ssssssss.magicboot.utils.FileUtils\'\nimport request;\nimport response;\n\nreturn response.json(FileUtils.saveFile(request.getFile(\"file\")));');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/入口get.ms', '{\n  \"properties\" : { },\n  \"id\" : \"d129fd774adc4279b94908c4e08eda83\",\n  \"script\" : null,\n  \"groupId\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"入口get\",\n  \"createTime\" : 1719394266659,\n  \"updateTime\" : 1635927863001,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/main\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"filePrefix\\\": \\\"http://192.168.0.106:8081/\\\"\\n    },\\n    \\\"timestamp\\\": 1635925203745,\\n    \\\"executeTime\\\": 9\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"filePrefix\",\n        \"value\" : \"http://192.168.0.106:8081/\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1635925203745\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"9\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport response;\nreturn response.dispatcher(`/ueditor/${action}`);');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/入口post.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c9e512bc233f4b53822f9a1d94e074ff\",\n  \"script\" : null,\n  \"groupId\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"入口post\",\n  \"createTime\" : 1719394266664,\n  \"updateTime\" : 1646490257556,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/main\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport response;\nreturn response.dispatcher(`/ueditor/${action}`);');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/富文本/配置.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c73741fd4a4d4677a97f16bd1afd6d16\",\n  \"script\" : null,\n  \"groupId\" : \"7eeba36706c24c1484ee4e84ad829f9b\",\n  \"name\" : \"配置\",\n  \"createTime\" : 1719394266667,\n  \"updateTime\" : 1635927563365,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/config\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"imageActionName\\\": \\\"uploadImage\\\",\\n    \\\"imageFieldName\\\": \\\"file\\\",\\n    \\\"imageMaxSize\\\": 2048000,\\n    \\\"imageAllowFiles\\\": [\\n        \\\".png\\\",\\n        \\\".jpg\\\",\\n        \\\".jpeg\\\",\\n        \\\".gif\\\",\\n        \\\".bmp\\\"\\n    ],\\n    \\\"imageCompressEnable\\\": true,\\n    \\\"imageCompressBorder\\\": 1600,\\n    \\\"imageInsertAlign\\\": \\\"none\\\",\\n    \\\"imageUrlPrefix\\\": \\\"http://192.168.0.106:8081/\\\",\\n    \\\"imagePathFormat\\\": \\\"/ueditor/jsp/upload/image/{yyyy}{mm}{dd}/{time}{rand:6}\\\",\\n    \\\"catcherLocalDomain\\\": [\\n        \\\"127.0.0.1\\\",\\n        \\\"localhost\\\",\\n        \\\"img.baidu.com\\\"\\n    ],\\n    \\\"catcherActionName\\\": \\\"catchimage\\\",\\n    \\\"catcherFieldName\\\": \\\"source\\\",\\n    \\\"catcherPathFormat\\\": \\\"/ueditor/jsp/upload/image/{yyyy}{mm}{dd}/{time}{rand:6}\\\",\\n    \\\"catcherMaxSize\\\": 2048000,\\n    \\\"catcherAllowFiles\\\": [\\n        \\\".png\\\",\\n        \\\".jpg\\\",\\n        \\\".jpeg\\\",\\n        \\\".gif\\\",\\n        \\\".bmp\\\"\\n    ],\\n    \\\"fileActionName\\\": \\\"uploadFile\\\",\\n    \\\"fileFieldName\\\": \\\"file\\\",\\n    \\\"filePathFormat\\\": \\\"/ueditor/jsp/upload/file/{yyyy}{mm}{dd}/{time}{rand:6}\\\",\\n    \\\"fileUrlPrefix\\\": \\\"http://192.168.0.106:8081/\\\",\\n    \\\"fileMaxSize\\\": 51200000,\\n    \\\"fileAllowFiles\\\": [\\n        \\\".png\\\",\\n        \\\".jpg\\\",\\n        \\\".jpeg\\\",\\n        \\\".gif\\\",\\n        \\\".bmp\\\",\\n        \\\".flv\\\",\\n        \\\".swf\\\",\\n        \\\".mkv\\\",\\n        \\\".avi\\\",\\n        \\\".rm\\\",\\n        \\\".rmvb\\\",\\n        \\\".mpeg\\\",\\n        \\\".mpg\\\",\\n        \\\".ogg\\\",\\n        \\\".ogv\\\",\\n        \\\".mov\\\",\\n        \\\".wmv\\\",\\n        \\\".mp4\\\",\\n        \\\".mp3\\\",\\n        \\\".wav\\\",\\n        \\\".mid\\\",\\n        \\\".rar\\\",\\n        \\\".zip\\\",\\n        \\\".tar\\\",\\n        \\\".gz\\\",\\n        \\\".7z\\\",\\n        \\\".doc\\\",\\n        \\\".docx\\\",\\n        \\\".xls\\\",\\n        \\\".xlsx\\\",\\n        \\\".ppt\\\",\\n        \\\".pptx\\\",\\n        \\\".pdf\\\",\\n        \\\".txt\\\"\\n    ],\\n    \\\"imageManagerActionName\\\": \\\"listimage\\\",\\n    \\\"imageManagerListPath\\\": \\\"/upload/image/\\\",\\n    \\\"imageManagerListSize\\\": 20,\\n    \\\"imageManagerUrlPrefix\\\": \\\"http://192.168.0.106:8081/\\\",\\n    \\\"imageManagerInsertAlign\\\": \\\"none\\\",\\n    \\\"imageManagerAllowFiles\\\": [\\n        \\\".png\\\",\\n        \\\".jpg\\\",\\n        \\\".jpeg\\\",\\n        \\\".gif\\\",\\n        \\\".bmp\\\"\\n    ],\\n    \\\"fileManagerActionName\\\": \\\"listfile\\\",\\n    \\\"fileManagerListPath\\\": \\\"/upload/file/\\\",\\n    \\\"fileManagerUrlPrefix\\\": \\\"http://192.168.0.106:8081/\\\",\\n    \\\"fileManagerListSize\\\": 20,\\n    \\\"fileManagerAllowFiles\\\": [\\n        \\\".png\\\",\\n        \\\".jpg\\\",\\n        \\\".jpeg\\\",\\n        \\\".gif\\\",\\n        \\\".bmp\\\",\\n        \\\".flv\\\",\\n        \\\".swf\\\",\\n        \\\".mkv\\\",\\n        \\\".avi\\\",\\n        \\\".rm\\\",\\n        \\\".rmvb\\\",\\n        \\\".mpeg\\\",\\n        \\\".mpg\\\",\\n        \\\".ogg\\\",\\n        \\\".ogv\\\",\\n        \\\".mov\\\",\\n        \\\".wmv\\\",\\n        \\\".mp4\\\",\\n        \\\".mp3\\\",\\n        \\\".wav\\\",\\n        \\\".mid\\\",\\n        \\\".rar\\\",\\n        \\\".zip\\\",\\n        \\\".tar\\\",\\n        \\\".gz\\\",\\n        \\\".7z\\\",\\n        \\\".doc\\\",\\n        \\\".docx\\\",\\n        \\\".xls\\\",\\n        \\\".xlsx\\\",\\n        \\\".ppt\\\",\\n        \\\".pptx\\\",\\n        \\\".pdf\\\",\\n        \\\".txt\\\"\\n    ]\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"imageActionName\",\n      \"value\" : \"uploadImage\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageFieldName\",\n      \"value\" : \"file\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageMaxSize\",\n      \"value\" : \"2048000\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageAllowFiles\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \".png\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"imageCompressEnable\",\n      \"value\" : \"true\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Boolean\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageCompressBorder\",\n      \"value\" : \"1600\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageInsertAlign\",\n      \"value\" : \"none\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageUrlPrefix\",\n      \"value\" : \"http://192.168.0.106:8081/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imagePathFormat\",\n      \"value\" : \"/ueditor/jsp/upload/image/{yyyy}{mm}{dd}/{time}{rand:6}\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"catcherLocalDomain\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"127.0.0.1\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"catcherActionName\",\n      \"value\" : \"catchimage\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"catcherFieldName\",\n      \"value\" : \"source\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"catcherPathFormat\",\n      \"value\" : \"/ueditor/jsp/upload/image/{yyyy}{mm}{dd}/{time}{rand:6}\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"catcherMaxSize\",\n      \"value\" : \"2048000\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"catcherAllowFiles\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \".png\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"fileActionName\",\n      \"value\" : \"uploadFile\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileFieldName\",\n      \"value\" : \"file\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"filePathFormat\",\n      \"value\" : \"/ueditor/jsp/upload/file/{yyyy}{mm}{dd}/{time}{rand:6}\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileUrlPrefix\",\n      \"value\" : \"http://192.168.0.106:8081/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileMaxSize\",\n      \"value\" : \"51200000\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileAllowFiles\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \".png\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"imageManagerActionName\",\n      \"value\" : \"listimage\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageManagerListPath\",\n      \"value\" : \"/upload/image/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageManagerListSize\",\n      \"value\" : \"20\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageManagerUrlPrefix\",\n      \"value\" : \"http://192.168.0.106:8081/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageManagerInsertAlign\",\n      \"value\" : \"none\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"imageManagerAllowFiles\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \".png\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"fileManagerActionName\",\n      \"value\" : \"listfile\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileManagerListPath\",\n      \"value\" : \"/upload/file/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileManagerUrlPrefix\",\n      \"value\" : \"http://192.168.0.106:8081/\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileManagerListSize\",\n      \"value\" : \"20\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"fileManagerAllowFiles\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \".png\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    } ]\n  }\n}\r\n================================\r\nimport \'org.ssssssss.magicboot.model.UeditorConfig\'\nimport \'org.ssssssss.magicapi.utils.JsonUtils\'\nimport response;\n\nresponse.setHeader(\"content-type\",\"text/javascript\")\n\nif(null == callback || \"\".equals(callback)) {\n    return response.json(new UeditorConfig());\n}\nreturn response.json(`${callback}(${new UeditorConfig()::stringify})`)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"name\" : \"数据字典\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/dict\",\n  \"createTime\" : 1719394266318,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"cbf24a795f6441d6af123d6dff065e37\",\n  \"script\" : null,\n  \"groupId\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266674,\n  \"updateTime\" : 1644121671060,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar typeCount = db.selectInt(\"select count(1) from sys_dict where is_del = 0 and type = #{data.type} ?{id, and id != #{data.id}}\")\nif(typeCount > 0){\n    exit 0,\'类型已存在\'\n}\nreturn db.table(\"sys_dict\").primary(\"id\").saveOrUpdate(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"1d9e4e7ad6a1484db6555700ea23144c\",\n  \"script\" : null,\n  \"groupId\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266677,\n  \"updateTime\" : 1649169225411,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1634734488837,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634734488837\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id,dict_type,desc_ribe,type,remarks,create_date from sys_dict\n    where is_del = 0\n    ?{type, and type like concat(\'%\',#{type},\'%\')}\n    ?{dictType, and dict_type = #{dictType}}\n    order by create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"46d45f15b5ab4de7b6718fd0c9b05e7b\",\n  \"script\" : null,\n  \"groupId\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266680,\n  \"updateTime\" : 1646553112581,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\ndb.table(\"sys_dict_items\").logic().where().eq(\"dictId\",id).delete()\nreturn db.table(\"sys_dict\").logic().where().eq(\"id\",id).delete()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"字典项\",\n  \"type\" : \"api\",\n  \"parentId\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"path\" : \"/items\",\n  \"createTime\" : 1719394266325,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/上移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"08f29d784ed94b318ea2209997b6d426\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"上移\",\n  \"createTime\" : 1719394266686,\n  \"updateTime\" : 1652170402804,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/up\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:items:sort:up\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_dict_items\n    WHERE\n        is_del = 0 \n        and dict_id = #{dictId}\n        AND sort < ( SELECT sort FROM sys_dict_items WHERE is_del = 0 AND id = #{id} ) \n    ORDER BY\n        sort DESC \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_dict_items set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_dict_items set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/下移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"3cc33992bf1b4ad38223da5ae302ce79\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"下移\",\n  \"createTime\" : 1719394266689,\n  \"updateTime\" : 1652170425992,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/down\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:items:sort:down\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_dict_items\n    WHERE\n        is_del = 0 \n        and dict_id = #{dictId}\n        AND sort > ( SELECT sort FROM sys_dict_items WHERE is_del = 0 AND id = #{id} )\n    ORDER BY\n        sort \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_dict_items set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_dict_items set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"695ff3257c314ea4bfa63edeaa511af0\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266692,\n  \"updateTime\" : 1644121691372,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:items:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar valueCount = db.selectInt(\"select count(1) from sys_dict_items where is_del = 0 and dict_id = #{data.dictId} and value = #{data.value} ?{id, and id != #{data.id}}\")\nif(valueCount > 0){\n    exit 0,\'值已存在\'\n}\nreturn db.table(\"sys_dict_items\").primary(\"id\").saveOrUpdate(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"1fd1864c9c2d44c691302e7115a0168a\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266695,\n  \"updateTime\" : 1649169185265,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:items:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"total\\\": 17,\\n        \\\"list\\\": [\\n            {\\n                \\\"id\\\": \\\"56aee220-cb12-4bb2-8453-84ee49672193\\\",\\n                \\\"value\\\": \\\"3\\\",\\n                \\\"label\\\": \\\"3\\\",\\n                \\\"dictId\\\": \\\"4b9b4a7e-25a1-4efa-ab9a-a004f203f1f4\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 30\\n            },\\n            {\\n                \\\"id\\\": \\\"6a127863-8130-48be-88bf-e5179f5c33e6\\\",\\n                \\\"value\\\": \\\"2\\\",\\n                \\\"label\\\": \\\"2\\\",\\n                \\\"dictId\\\": \\\"4b9b4a7e-25a1-4efa-ab9a-a004f203f1f4\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 20\\n            },\\n            {\\n                \\\"id\\\": \\\"f19152f4-dd72-4509-a350-af70d802dcdf\\\",\\n                \\\"value\\\": \\\"1\\\",\\n                \\\"label\\\": \\\"1\\\",\\n                \\\"dictId\\\": \\\"4b9b4a7e-25a1-4efa-ab9a-a004f203f1f4\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 10\\n            },\\n            {\\n                \\\"id\\\": \\\"ac1ee828-62e1-42fd-9d18-cf37203855b2\\\",\\n                \\\"value\\\": \\\"12\\\",\\n                \\\"label\\\": \\\"12\\\",\\n                \\\"dictId\\\": \\\"3c393981-9ddd-40b2-8c19-85f0a9d9a98f\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 30\\n            },\\n            {\\n                \\\"id\\\": \\\"457517be-5245-4d98-b9fa-8b6753a9cfc6\\\",\\n                \\\"value\\\": \\\"2\\\",\\n                \\\"label\\\": \\\"公司\\\",\\n                \\\"dictId\\\": \\\"3c393981-9ddd-40b2-8c19-85f0a9d9a98f\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 20\\n            },\\n            {\\n                \\\"id\\\": \\\"b928f5b1-07bd-4f09-9142-897c767c5303\\\",\\n                \\\"value\\\": \\\"1\\\",\\n                \\\"label\\\": \\\"部门\\\",\\n                \\\"dictId\\\": \\\"3c393981-9ddd-40b2-8c19-85f0a9d9a98f\\\",\\n                \\\"remarks\\\": \\\"\\\",\\n                \\\"sort\\\": 10\\n            },\\n            {\\n                \\\"id\\\": \\\"0f91de6e8406d59762bebe5d2dfc9d36\\\",\\n                \\\"value\\\": \\\"0\\\",\\n                \\\"label\\\": \\\"不禁用\\\",\\n                \\\"dictId\\\": \\\"ae9a2cd400264ff6bdc2f00b62d6e941\\\",\\n                \\\"remarks\\\": null,\\n                \\\"sort\\\": 0\\n            },\\n            {\\n                \\\"id\\\": \\\"c5cf8715a74537156ea29c8bbc622b05\\\",\\n                \\\"value\\\": \\\"1\\\",\\n                \\\"label\\\": \\\"禁用\\\",\\n                \\\"dictId\\\": \\\"ae9a2cd400264ff6bdc2f00b62d6e941\\\",\\n                \\\"remarks\\\": null,\\n                \\\"sort\\\": 0\\n            },\\n            {\\n                \\\"id\\\": \\\"ze9a2cd400264ff6bdc2f00b62d6e911\\\",\\n                \\\"value\\\": \\\"0\\\",\\n                \\\"label\\\": \\\"系统类\\\",\\n                \\\"dictId\\\": \\\"ae9a2cd400264ff6bdc2f00b62d6e911\\\",\\n                \\\"remarks\\\": null,\\n                \\\"sort\\\": 0\\n            },\\n            {\\n                \\\"id\\\": \\\"ze9a2cd400264ff6bdc2f00b62d6e910\\\",\\n                \\\"value\\\": \\\"1\\\",\\n                \\\"label\\\": \\\"业务类\\\",\\n                \\\"dictId\\\": \\\"ae9a2cd400264ff6bdc2f00b62d6e911\\\",\\n                \\\"remarks\\\": null,\\n                \\\"sort\\\": 0\\n            }\\n        ]\\n    },\\n    \\\"timestamp\\\": 1634735383948,\\n    \\\"executeTime\\\": 13\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"total\",\n        \"value\" : \"17\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Integer\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"list\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"id\",\n            \"value\" : \"56aee220-cb12-4bb2-8453-84ee49672193\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"value\",\n            \"value\" : \"3\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"label\",\n            \"value\" : \"3\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"dictId\",\n            \"value\" : \"4b9b4a7e-25a1-4efa-ab9a-a004f203f1f4\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"remarks\",\n            \"value\" : \"\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"sort\",\n            \"value\" : \"30\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634735383948\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"13\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id,value,label,dict_id,remarks,sort from sys_dict_items\n    where is_del = 0\n    ?{label, and label like concat(\'%\',#{label},\'%\')}\n    ?{dictId, and dict_id = #{dictId}}\n    ?{value, and value like concat(\'%\',#{value},\'%\')}\n    order by sort\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ed33e9c6270446118cf5674299778959\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266700,\n  \"updateTime\" : 1646553109828,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"dict:items:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\"sys_dict_items\").logic().where().eq(\"id\",id).delete();');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/获取所有字典项.ms', '{\n  \"properties\" : { },\n  \"id\" : \"18b186e0712449efa4e34c9ee75b0704\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"获取所有字典项\",\n  \"createTime\" : 1719394266702,\n  \"updateTime\" : 1647790331786,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/all\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\r\\n\\t\\r\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1647790314936,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1647790314936\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select label,value,d.type from sys_dict_items it left join sys_dict d on d.id = it.dict_id where it.is_del = \'0\' and d.is_del = \'0\' order by it.sort\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/字典项/获取排序号.ms', '{\n  \"properties\" : { },\n  \"id\" : \"5d5fc243a5594f79b95ed279e184732e\",\n  \"script\" : null,\n  \"groupId\" : \"376f26eb43a44a3daeafd27020a96f48\",\n  \"name\" : \"获取排序号\",\n  \"createTime\" : 1719394266705,\n  \"updateTime\" : 1634735599490,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectInt(\"\"\"select max(sort) + 10 from sys_dict_items where dict_id = #{dictId} and is_del = \'0\'\"\"\") || 10;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/数据字典/所有字典.ms', '{\n  \"properties\" : { },\n  \"id\" : \"e516cf1dd64742a2b8a652b4c1224dd1\",\n  \"script\" : null,\n  \"groupId\" : \"c7ce65f5b3cf4aaa913f6fec7d35d176\",\n  \"name\" : \"所有字典\",\n  \"createTime\" : 1719394266683,\n  \"updateTime\" : 1647790584427,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/all\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [{\\n        \\\"label\\\": \\\"测试1\\\",\\n        \\\"value\\\": \\\"测试1\\\"\\n    }, {\\n        \\\"label\\\": \\\"组织机构类型\\\",\\n        \\\"value\\\": \\\"office_type\\\"\\n    }, {\\n        \\\"label\\\": \\\"字典类型\\\",\\n        \\\"value\\\": \\\"dict_type\\\"\\n    }, {\\n        \\\"label\\\": \\\"是否登录\\\",\\n        \\\"value\\\": \\\"is_login\\\"\\n    }],\\n    \\\"timestamp\\\": 1647790533379,\\n    \\\"executeTime\\\": 13\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"label\",\n          \"value\" : \"测试1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"value\",\n          \"value\" : \"测试1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1647790533379\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"13\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select desc_ribe label,type value from sys_dict where is_del = 0\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"文件管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/file\",\n  \"createTime\" : 1719394266330,\n  \"updateTime\" : 1680235020046,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/上传.ms', '{\n  \"properties\" : { },\n  \"id\" : \"cc20896df1c546fba56929cc75cb0309\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"上传\",\n  \"createTime\" : 1719394266709,\n  \"updateTime\" : 1643706737853,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/upload\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicboot.utils.FileUtils\nimport request;\n\nvar map = FileUtils.saveFile(request.getFile(\'file\'));\n\ndb.table(\"sys_file\").primary(\"id\").saveOrUpdate({\n    url: map.url,\n    externalId: externalId,\n    externalType: externalType\n})\n\nreturn map;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/下载.ms', '{\n  \"properties\" : { },\n  \"id\" : \"63f76dedb8084db7b11f45b2ef1285de\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"下载\",\n  \"createTime\" : 1719394266712,\n  \"updateTime\" : 1656051456794,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/download\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"urls\",\n    \"value\" : \"userfiles/2022-05-05/c6aeb598deef48c385b0da831b7c2b85/QQ%E5%9B%BE%E7%89%8720220505165410.jpg,userfiles/2022-06-24/3eae989f6e5942a3b2e3dab2653865e3/QQ%E5%9B%BE%E7%89%8720220519110559.jpg\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport java.net.URLDecoder\nimport java.net.URLEncoder\nimport java.io.File\nimport org.ssssssss.magicboot.model.Global\nimport cn.hutool.core.io.FileUtil\nimport cn.hutool.core.util.CharsetUtil\nimport cn.hutool.core.util.ZipUtil\nimport response\n\nvar files = []\nurls = URLDecoder.decode(urls, \"UTF-8\").split(\',\')\nfor(url in urls){\n    files.push(FileUtil.file(Global.getUserFilesBaseDir() + \"/\" + url))\n}\nif(!filename){\n    if(urls.length > 1){\n        filename = \'附件.zip\'\n    }else{\n        filename = urls[0].substring(urls[0].lastIndexOf(\'/\') + 1)\n    }\n}else{\n    if(urls.length > 1){\n        filename += \'.zip\'\n    }else{\n        filename += urls[0].substring(urls[0].lastIndexOf(\'.\'))\n    }\n}\nresponse.setHeader(\"Content-Type\",\"application/octet-stream;charset=utf-8\")\nresponse.setHeader(\"Content-Disposition\", `attachment;filename=${URLEncoder.encode(filename, \"UTF-8\")}`)\n\nif(urls.length > 1){\n    ZipUtil.zip(response.getOutputStream(), CharsetUtil.defaultCharset(), false, null, files.toArray(new_array(File.class, 0)));\n}else{\n    FileUtil.writeToStream(FileUtil.file(Global.getUserFilesBaseDir() + \"/\" + urls[0]), response.getOutputStream())\n}\n\nreturn response.end()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/下载post.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f9dc93ff77d94016a771456c21774789\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"下载post\",\n  \"createTime\" : 1719394266715,\n  \"updateTime\" : 1656055977595,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/download\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'@get:/system/file/download\' as download;\nreturn download();');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a18a418e9d2a437dbdb51191340086c9\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266718,\n  \"updateTime\" : 1646553118780,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport java.net.URLDecoder\nimport org.ssssssss.magicboot.model.Global\nimport org.ssssssss.magicboot.utils.FileUtils\nimport cn.hutool.core.io.FileUtil;\n\nurl = URLDecoder.decode(url, \"UTF-8\");\n\ndb.table(\"sys_file\").where().eq(\"url\",url).delete()\n\nString realPath = Global.getUserFilesBaseDir() + \"/\" + url;\nFileUtil.del(realPath);\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/排序.ms', '{\n  \"properties\" : { },\n  \"id\" : \"1d736fb0b9b54566943a0ea6696492c6\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"排序\",\n  \"createTime\" : 1719394266720,\n  \"updateTime\" : 1643706726137,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/resort\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport java.net.URLDecoder\n\nfor(index,url in urls.split(\',\')){\n    url = URLDecoder.decode(url, \"UTF-8\")\n    var id = db.selectValue(\"select id from sys_file where url = #{url}\")\n    db.table(\"sys_file\").column(\"sort\",index + 1).where().eq(\"id\",id).update()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/获取文件上传目录.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ffa5c180f92a4dfbb066633c36a30716\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"获取文件上传目录\",\n  \"createTime\" : 1719394266724,\n  \"updateTime\" : 1680235255154,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getFileUploadDirectory\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": \\\"dev\\\",\\n    \\\"timestamp\\\": 1680235202425,\\n    \\\"executeTime\\\": 25\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"dev\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1680235202425\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"25\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport env\nimport cn.hutool.core.util.IdUtil\nimport cn.hutool.core.date.DateUtil\nvar count = length ? length.asInt() : 1;\nvar urls = []\nfor(i in range(1, count)){\n    urls.push(env.get(\'spring.profiles.active\') + \"/userfiles/\" + DateUtil.today() + \"/\" + IdUtil.simpleUUID() + \"/\")\n}\nreturn urls\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/获取文件列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"41a8cb1257e0468c85731b4eae7ea44b\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"获取文件列表\",\n  \"createTime\" : 1719394266727,\n  \"updateTime\" : 1635075004674,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/files\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com//userfiles/2021-06-04/\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com//userfiles/2021-06-04/\\\",\\n        \\\"userfiles/2021-06-18/09eeb3d40111431aa6e35326aaa10966.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/a2d74fe35347412a888231a8ef62f725.jpg\\\",\\n        \\\"userfiles/2021-07-08/dc7b4b4e6a2645b890d7a1f77cdcc2ec/TAJ.jpg\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\b0c57b5364364a5786617956fb554984\\\\\\\\\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\00da6e6ad71b4fb9b2b26791dfbab515\\\\\\\\\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/2717f8866a0c475387c4aab35d648ee8/blob\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/d6e6ba22fb2f4eb8abb54c1377a787a2.jpg\\\",\\n        \\\"userfiles/2021-06-04/a42795139f5a419097b6c639021ead71.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-12/bbf474834b3f40869604a4859da7cfa0.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-12/04f107059ca949f0a74b78de68fd4199.jpg\\\",\\n        \\\"userfiles/2021-06-04/bd7797c740214f50b7d3bebbb998f0ef.jpg\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\6373cbe4300e49c89657253d176b12b2\\\\\\\\\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/919e189d991c4946a84345e0efe1a521/QQ图片20210416173834.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-18/b0c6550b85c24d77ada299c9a7dfeba7.jpg\\\",\\n        \\\"userfiles/2021-06-12/092ca59fb40d4647b1355c66af78c901.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/99375264f6f24f949215179f55bb02ff.jpg\\\",\\n        \\\"userfiles/2021-07-08/5a1fdf687ded4a06a25fbcf193685455/TAJ.jpg\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\7ec6883c723a438d8a113a4a1ba1f1c5\\\\\\\\blob\\\",\\n        \\\"userfiles/2021-06-18/7cda59680c6944f9aaa13a98f1b12c37.jpg\\\",\\n        \\\"userfiles/2021-07-08/6510418e476d44789419d2e3bf052119/blob\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\cd98396025e24f8d8d77abc8fac0cef4\\\\\\\\blob\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\1f5235f38ddb492a960e574b0939fce3\\\\\\\\blob\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/1241ddd38a3e42bf9662bcb8c9418ae7/TAJ.jpg\\\",\\n        \\\"userfiles/2021-06-04/8c75629f12334691b78118a96235ad4a.jpg\\\",\\n        \\\"userfiles/2021-06-04/35d6817fa50e462fad99d278dcee0e74.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/0e307be11ade49108986f9aa0d181ced/QQ图片20210416173834.jpg\\\",\\n        \\\"userfiles/2021-07-08/abecb58e6c904f86a7681e220622a8cc/TAJ.jpg\\\",\\n        \\\"userfiles/2021-07-08/e5dd2ff057094f37988b9f14d982468c/TAJ.jpg\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\c4c2022df51b4333b0031ecd28aae117\\\\\\\\\\\",\\n        \\\"userfiles/2021-07-08\\\\\\\\8d0a7be9ec284ef78cba432a9863a92d\\\\\\\\blob\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/a530b5133cf14929ab5c4ebdedd99a82/QQ图片20210416173834.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/7c9cf4642877453b86783fc654dc64b4/TAJ.jpg\\\",\\n        \\\"userfiles/2021-07-08/3afe3c9abbe94fe9a31580fdba7e5c8c/TAJ.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/168891533fab4d5686e7ac23d1b944b5/TAJ.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/1194ff204ca74bebb455db653950b63a.jpg\\\",\\n        \\\"userfiles/2021-06-04/d2c04556866649faa0f1136b9de87a96.jpg\\\",\\n        \\\"userfiles/2021-06-04/58ec5f00746b4b3093b7ff54665b82cc.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/04dc670eada04fec8db68fef73eae866/QQ图片20210416173834.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/d270bae8a4034e68993b13320724f1e2/QQ图片20210416173834.jpg\\\",\\n        \\\"userfiles/2021-07-08/39a240eb33cc4252a65ec57f323cc397/TAJ.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/ffe314dcc4a34a77892fab660284ca26.png\\\",\\n        \\\"userfiles/2021-06-04/96da7329ae1b4df8b8fce4d6a9e5ef30.png\\\",\\n        \\\"userfiles/2021-06-04/33cfffcc46dd4e1e92d6bbff9dfadb1a.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/80e5697c43ac4591a79e2e6433f7c9b2.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/84d0685d28774149b9df6a3cdc0e4366/blob\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/82989579f7604118a46921d990437e71.png\\\",\\n        \\\"userfiles/2021-06-04/13809ac92ba5425cb754842bb8095ab6.png\\\",\\n        \\\"userfiles/2021-06-04/082ccf731eb545d987400bd2995624a7.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/upload/2021-06-04/7fd527d49ecd4284aff0e3b2982c8502/QQ图片20210416173834.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/98847999cd7e4135b1150a5ba2d458de.jpg\\\",\\n        \\\"https://huifeng666.oss-cn-beijing.aliyuncs.com/userfiles/2021-06-04/8e3c16ca4d114aeabbe392dec8a9e39d.png\\\"\\n    ],\\n    \\\"timestamp\\\": 1635074952827,\\n    \\\"executeTime\\\": 117\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"https://huifeng666.oss-cn-beijing.aliyuncs.com//userfiles/2021-06-04/\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"String\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1635074952827\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"117\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"select url from sys_file where external_id = #{externalId} and external_type = #{externalType} order by sort\").map(it => {return it.url})');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/文件管理/裁剪.ms', '{\n  \"properties\" : { },\n  \"id\" : \"874aea2c17ca4c79bcdff3d4cc458c87\",\n  \"script\" : null,\n  \"groupId\" : \"fd3d225a1cf141bf9998c4ec4bf4a6ab\",\n  \"name\" : \"裁剪\",\n  \"createTime\" : 1719394266732,\n  \"updateTime\" : 1643706719537,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/cropper\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicboot.model.Global\nimport org.ssssssss.magicboot.utils.FileUtils\nimport cn.hutool.core.io.FileUtil;\nimport java.net.URLDecoder\nimport request;\n\nurl = URLDecoder.decode(url, \"UTF-8\");\nString realPath = Global.getUserFilesBaseDir() + \"/\" + url;\nFileUtil.del(realPath);\n\nvar map = FileUtils.saveFile(request.getFile(\'file\'));\n\ndb.table(\"sys_file\").column(\"url\", map.url).where().eq(\"url\", url).update()\n\nreturn map');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/日志管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/日志管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"9ec6f9ec92d24a369952bb13eddc134f\",\n  \"name\" : \"日志管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/log\",\n  \"createTime\" : 1719394266336,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/日志管理/操作日志.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f3263e9461c94c02b68e722fae921981\",\n  \"script\" : null,\n  \"groupId\" : \"9ec6f9ec92d24a369952bb13eddc134f\",\n  \"name\" : \"操作日志\",\n  \"createTime\" : 1719394266735,\n  \"updateTime\" : 1713861312162,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/oper/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"total\\\": 86,\\n        \\\"list\\\": [{\\n            \\\"id\\\": 7947,\\n            \\\"apiName\\\": \\\"后台-安全-登录\\\",\\n            \\\"apiPath\\\": \\\"/security/login\\\",\\n            \\\"apiMethod\\\": \\\"POST\\\",\\n            \\\"costTime\\\": 301,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7948,\\n            \\\"apiName\\\": \\\"后台-用户管理-获取用户信息\\\",\\n            \\\"apiPath\\\": \\\"/user/info\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 41,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7949,\\n            \\\"apiName\\\": \\\"后台-数据字典-字典项-获取所有字典项\\\",\\n            \\\"apiPath\\\": \\\"/dict/items/all\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 19,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7950,\\n            \\\"apiName\\\": \\\"后台-配置-获取所有配置\\\",\\n            \\\"apiPath\\\": \\\"/config/list\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 5,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7951,\\n            \\\"apiName\\\": \\\"后台-菜单管理-当前用户菜单\\\",\\n            \\\"apiPath\\\": \\\"/menu/current/menus\\\",\\n            \\\"apiMethod\\\": \\\"POST\\\",\\n            \\\"costTime\\\": 19,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7952,\\n            \\\"apiName\\\": \\\"后台-菜单管理-获取菜单tree\\\",\\n            \\\"apiPath\\\": \\\"/menu/tree\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 34,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:27\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7953,\\n            \\\"apiName\\\": \\\"后台-组织机构-列表\\\",\\n            \\\"apiPath\\\": \\\"/office/tree\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 10,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:28\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7954,\\n            \\\"apiName\\\": \\\"后台-角色管理-列表\\\",\\n            \\\"apiPath\\\": \\\"/role/list\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 18,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:29\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7955,\\n            \\\"apiName\\\": \\\"后台-菜单管理-获取排序号\\\",\\n            \\\"apiPath\\\": \\\"/menu/sort\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 5,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:23:42\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7956,\\n            \\\"apiName\\\": \\\"后台-组件-选择组件\\\",\\n            \\\"apiPath\\\": \\\"/component/select\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 4,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:23:43\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }]\\n    },\\n    \\\"timestamp\\\": 1646472930242,\\n    \\\"executeTime\\\": 19\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"total\",\n        \"value\" : \"86\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Integer\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"list\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"id\",\n            \"value\" : \"7947\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiName\",\n            \"value\" : \"后台-安全-登录\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiPath\",\n            \"value\" : \"/security/login\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiMethod\",\n            \"value\" : \"POST\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"costTime\",\n            \"value\" : \"301\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"createBy\",\n            \"value\" : \"1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"createDate\",\n            \"value\" : \"2022-03-05 12:22:24\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"userAgent\",\n            \"value\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"userIp\",\n            \"value\" : \"0:0:0:0:0:0:0:1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"username\",\n            \"value\" : \"admin\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1646472930242\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"19\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select sol.*,su.username from sys_oper_log sol left join sys_user su on sol.create_by = su.id where 1=1\n    ?{userIp, and sol.user_ip like concat(\'%\', #{userIp}, \'%\')}\n    ?{username, and su.username like concat(\'%\', #{username}, \'%\')}\n    ?{apiName, and sol.api_name like concat(\'%\', #{apiName}, \'%\')}\n    ?{apiPath, and sol.api_path like concat(\'%\', #{apiPath}, \'%\')}\n    ?{createDate && createDate.split(\',\')[0], and sol.create_date >= #{createDate.split(\',\')[0]}}\n    ?{createDate && createDate.split(\',\')[1], and sol.create_date <= #{createDate.split(\',\')[1]}}\n    ?{costTime && costTime.split(\',\')[0], and sol.cost_time >= #{costTime.split(\',\')[0]}}\n    ?{costTime && costTime.split(\',\')[1], and sol.cost_time <= #{costTime.split(\',\')[1]}}\n    order by sol.create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/日志管理/登录日志.ms', '{\n  \"properties\" : { },\n  \"id\" : \"copy3933719533\",\n  \"script\" : null,\n  \"groupId\" : \"9ec6f9ec92d24a369952bb13eddc134f\",\n  \"name\" : \"登录日志\",\n  \"createTime\" : 1719394266741,\n  \"updateTime\" : 1646552463034,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/login/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"total\\\": 86,\\n        \\\"list\\\": [{\\n            \\\"id\\\": 7947,\\n            \\\"apiName\\\": \\\"后台-安全-登录\\\",\\n            \\\"apiPath\\\": \\\"/security/login\\\",\\n            \\\"apiMethod\\\": \\\"POST\\\",\\n            \\\"costTime\\\": 301,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7948,\\n            \\\"apiName\\\": \\\"后台-用户管理-获取用户信息\\\",\\n            \\\"apiPath\\\": \\\"/user/info\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 41,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7949,\\n            \\\"apiName\\\": \\\"后台-数据字典-字典项-获取所有字典项\\\",\\n            \\\"apiPath\\\": \\\"/dict/items/all\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 19,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7950,\\n            \\\"apiName\\\": \\\"后台-配置-获取所有配置\\\",\\n            \\\"apiPath\\\": \\\"/config/list\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 5,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7951,\\n            \\\"apiName\\\": \\\"后台-菜单管理-当前用户菜单\\\",\\n            \\\"apiPath\\\": \\\"/menu/current/menus\\\",\\n            \\\"apiMethod\\\": \\\"POST\\\",\\n            \\\"costTime\\\": 19,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:24\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7952,\\n            \\\"apiName\\\": \\\"后台-菜单管理-获取菜单tree\\\",\\n            \\\"apiPath\\\": \\\"/menu/tree\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 34,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:27\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7953,\\n            \\\"apiName\\\": \\\"后台-组织机构-列表\\\",\\n            \\\"apiPath\\\": \\\"/office/tree\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 10,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:28\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7954,\\n            \\\"apiName\\\": \\\"后台-角色管理-列表\\\",\\n            \\\"apiPath\\\": \\\"/role/list\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 18,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:22:29\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7955,\\n            \\\"apiName\\\": \\\"后台-菜单管理-获取排序号\\\",\\n            \\\"apiPath\\\": \\\"/menu/sort\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 5,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:23:42\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }, {\\n            \\\"id\\\": 7956,\\n            \\\"apiName\\\": \\\"后台-组件-选择组件\\\",\\n            \\\"apiPath\\\": \\\"/component/select\\\",\\n            \\\"apiMethod\\\": \\\"GET\\\",\\n            \\\"costTime\\\": 4,\\n            \\\"createBy\\\": \\\"1\\\",\\n            \\\"createDate\\\": \\\"2022-03-05 12:23:43\\\",\\n            \\\"userAgent\\\": \\\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\\\",\\n            \\\"userIp\\\": \\\"0:0:0:0:0:0:0:1\\\",\\n            \\\"username\\\": \\\"admin\\\"\\n        }]\\n    },\\n    \\\"timestamp\\\": 1646472930242,\\n    \\\"executeTime\\\": 19\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"total\",\n        \"value\" : \"86\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Integer\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"list\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"id\",\n            \"value\" : \"7947\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiName\",\n            \"value\" : \"后台-安全-登录\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiPath\",\n            \"value\" : \"/security/login\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"apiMethod\",\n            \"value\" : \"POST\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"costTime\",\n            \"value\" : \"301\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"createBy\",\n            \"value\" : \"1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"createDate\",\n            \"value\" : \"2022-03-05 12:22:24\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"userAgent\",\n            \"value\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.99 Safari/537.36\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"userIp\",\n            \"value\" : \"0:0:0:0:0:0:0:1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"username\",\n            \"value\" : \"admin\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1646472930242\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"19\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select * from sys_login_log where 1=1\n    ?{createDate && createDate.split(\',\')[0], and create_date >= #{createDate.split(\',\')[0]}}\n    ?{createDate && createDate.split(\',\')[1], and create_date <= #{createDate.split(\',\')[1]}}\n    order by create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/测试数据/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/测试数据/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"42d241c0bb18476f8dabf92c2e4e2324\",\n  \"name\" : \"测试数据\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/test\",\n  \"createTime\" : 1719394266342,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/测试数据/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"d31e3bea5666449d90fa95779adfb61f\",\n  \"script\" : null,\n  \"groupId\" : \"42d241c0bb18476f8dabf92c2e4e2324\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266747,\n  \"updateTime\" : 1642312068428,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\"sys_test_data\").primary(\"id\").saveOrUpdate(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/测试数据/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"6d50d6c8884f4624b2bf8fd537ac34f6\",\n  \"script\" : null,\n  \"groupId\" : \"42d241c0bb18476f8dabf92c2e4e2324\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266750,\n  \"updateTime\" : 1648647148457,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\n/**\n * db  东北  本级\n * nm 内蒙  本级及子级\n * mxd2  全部\n * mxd  自定义\n */\n// import \'@/permission/office\' as permissionOffice;\n// var userIds = permissionOffice()\n\n// return db.page(\"\"\"\n//     select id,name from sys_test_data where 1 = 1 \n//     ?{userIds, and create_by in (#{userIds})}\n// \"\"\")\n\nimport \'@/permission/office\' as permissionOffice;\nvar userIds = permissionOffice()\n\nreturn db.table(\"sys_test_data\").where().in(\"create_by\",userIds).page()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"用户管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/user\",\n  \"createTime\" : 1719394266347,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/个人信息修改.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ebe40a0cf4b84192b6bbe923a0ecbd9c\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"个人信息修改\",\n  \"createTime\" : 1719394266752,\n  \"updateTime\" : 1643713357950,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/center/update\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\r\\n\\t\\r\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.dev33.satoken.secure.SaSecureUtil;\n\nvar oldPassword = db.selectValue(\"\"\"\n    select password from sys_user where id = #{id}\n\"\"\")\nif(oldPassword != SaSecureUtil.sha256(password)){\n    exit 0, \'原密码不正确！\'\n}\n\nvar data = {\n    id,\n    phone,\n    headPortrait\n}\nif(newPassword){\n    data.password = newPassword ? SaSecureUtil.sha256(newPassword) : \'\'\n}\nreturn db.table(\'sys_user\').primary(\'id\').update(data, true)\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"877918736c764253a85d0780cbd5f763\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266757,\n  \"updateTime\" : 1646493559668,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.dev33.satoken.secure.SaSecureUtil;\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\n\nvar usernameCount = db.selectInt(\"select count(1) from sys_user where is_del = 0 and username = #{username} ?{id, and id != #{id}}\")\nif(usernameCount > 0){\n    exit 0,\'登录名称已存在\'\n}\n\npassword = password ? SaSecureUtil.sha256(password) : \'\'\nvar user = {\n    id,\n    name,\n    username,\n    password: password,\n    phone,\n    isLogin,\n    officeId\n}\nif(id){\n    SqlCache.delete(`permissions:${id}`)\n    db.update(\"\"\"\n        delete from sys_user_role where user_id = #{id}\n    \"\"\")\n}\nid = db.table(\"sys_user\").primary(\"id\").saveOrUpdate(user)\nfor(roleId in roles.split(\',\')){\n    db.table(\"sys_user_role\").column(\'user_id\', id).column(\"role_id\", roleId).insert()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/修改登录状态.ms', '{\n  \"properties\" : { },\n  \"id\" : \"64ba47c2a11346e1972c63245cbf962c\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"修改登录状态\",\n  \"createTime\" : 1719394266760,\n  \"updateTime\" : 1651932570354,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/change/login/status\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:change:login:status\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport cn.dev33.satoken.stp.StpUtil\n\nif(isLogin == \'1\'){\n    StpUtil.logout(id);\n}\nreturn db.table(\"sys_user\").column(\"isLogin\", isLogin).where().eq(\"id\",id).update()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"4399f2eb199b46448aa98682fe792667\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266763,\n  \"updateTime\" : 1703681585765,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1643964929030,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1643964929030\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select\n        distinct\n        su.id,\n        su.username,\n        su.name,\n        su.is_login,\n        su.phone,\n        su.create_date,\n        su.office_id,\n        su.head_portrait,\n        so.name office_name,\n        (select group_concat(sr.name) from sys_role sr left join sys_user_role sur on sr.id = sur.role_id where sr.is_del = 0 and sur.user_id = su.id) roles\n    from sys_user su\n    left join sys_office so on su.office_id = so.id\n    left join sys_user_role sur on su.id = sur.user_id\n    where su.is_del = 0\n    ?{roleId, and sur.role_id in(#{roleId.split(\',\')})}\n    ?{officeId, and su.office_id in(#{officeId.split(\',\')})}\n    ?{username, and su.username like concat(\'%\',#{username},\'%\')}\n    ?{name, and su.name like concat(\'%\',#{name},\'%\')}\n    ?{isLogin, and su.is_login = #{isLogin}}\n    ?{orderByColumn, order by su.${orderByColumn} ${direction == 0 ? \'asc\' : direction == 1 ? \'desc\' : \'\'}}\n    ?{!orderByColumn, order by su.create_date desc}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c86e4f8fd4bc4d63bfaec8a53ea333cf\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266766,\n  \"updateTime\" : 1655304921225,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\n\nif(Arrays.asList(id.split(\',\')).contains(\'1\')){\n    exit 500, \'不允许删除超级管理员\'\n}\n\nfor(userId in id.split(\',\')){\n    SqlCache.delete(`permissions:${userId}`)\n    db.table(\"sys_user\").logic().where().eq(\"id\",userId).delete();\n    db.update(\"\"\"\n        delete from sys_user_role where user_id = #{userId}\n    \"\"\")\n}\nreturn true');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/导入.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f7d2fc76c0034060bcb09d89da4c34e8\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"导入\",\n  \"createTime\" : 1719394266771,\n  \"updateTime\" : 1651932628342,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/import\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:import\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\r\\n    \\\"datas\\\": [{\\\"登录名称\\\":\\\"test1\\\",\\\"密码\\\":1,\\\"姓名/昵称\\\":\\\"test1\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393296},{\\\"登录名称\\\":\\\"test2\\\",\\\"密码\\\":2,\\\"姓名/昵称\\\":\\\"test2\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393297},{\\\"登录名称\\\":\\\"test3\\\",\\\"密码\\\":3,\\\"姓名/昵称\\\":\\\"test3\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393298},{\\\"登录名称\\\":\\\"test4\\\",\\\"密码\\\":4,\\\"姓名/昵称\\\":\\\"test4\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393299},{\\\"登录名称\\\":\\\"test5\\\",\\\"密码\\\":5,\\\"姓名/昵称\\\":\\\"test5\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393300},{\\\"登录名称\\\":\\\"test6\\\",\\\"密码\\\":6,\\\"姓名/昵称\\\":\\\"test6\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393301},{\\\"登录名称\\\":\\\"test7\\\",\\\"密码\\\":7,\\\"姓名/昵称\\\":\\\"test7\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393302},{\\\"登录名称\\\":\\\"test8\\\",\\\"密码\\\":8,\\\"姓名/昵称\\\":\\\"test8\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393303},{\\\"登录名称\\\":\\\"test9\\\",\\\"密码\\\":9,\\\"姓名/昵称\\\":\\\"test9\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393304},{\\\"登录名称\\\":\\\"test10\\\",\\\"密码\\\":10,\\\"姓名/昵称\\\":\\\"test10\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393305},{\\\"登录名称\\\":\\\"test11\\\",\\\"密码\\\":11,\\\"姓名/昵称\\\":\\\"test11\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393306},{\\\"登录名称\\\":\\\"test12\\\",\\\"密码\\\":12,\\\"姓名/昵称\\\":\\\"test12\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393307},{\\\"登录名称\\\":\\\"test13\\\",\\\"密码\\\":13,\\\"姓名/昵称\\\":\\\"test13\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393308},{\\\"登录名称\\\":\\\"test14\\\",\\\"密码\\\":14,\\\"姓名/昵称\\\":\\\"test14\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393309},{\\\"登录名称\\\":\\\"test15\\\",\\\"密码\\\":15,\\\"姓名/昵称\\\":\\\"test15\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393310},{\\\"登录名称\\\":\\\"test16\\\",\\\"密码\\\":16,\\\"姓名/昵称\\\":\\\"test16\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393311},{\\\"登录名称\\\":\\\"test17\\\",\\\"密码\\\":17,\\\"姓名/昵称\\\":\\\"test17\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393312},{\\\"登录名称\\\":\\\"test18\\\",\\\"密码\\\":18,\\\"姓名/昵称\\\":\\\"test18\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393313},{\\\"登录名称\\\":\\\"test19\\\",\\\"密码\\\":19,\\\"姓名/昵称\\\":\\\"test19\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393314},{\\\"登录名称\\\":\\\"test20\\\",\\\"密码\\\":20,\\\"姓名/昵称\\\":\\\"test20\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393315},{\\\"登录名称\\\":\\\"test21\\\",\\\"密码\\\":21,\\\"姓名/昵称\\\":\\\"test21\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393316},{\\\"登录名称\\\":\\\"test22\\\",\\\"密码\\\":22,\\\"姓名/昵称\\\":\\\"test22\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393317},{\\\"登录名称\\\":\\\"test23\\\",\\\"密码\\\":23,\\\"姓名/昵称\\\":\\\"test23\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393318},{\\\"登录名称\\\":\\\"test24\\\",\\\"密码\\\":24,\\\"姓名/昵称\\\":\\\"test24\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393319},{\\\"登录名称\\\":\\\"test25\\\",\\\"密码\\\":25,\\\"姓名/昵称\\\":\\\"test25\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393320},{\\\"登录名称\\\":\\\"test26\\\",\\\"密码\\\":26,\\\"姓名/昵称\\\":\\\"test26\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393321},{\\\"登录名称\\\":\\\"test27\\\",\\\"密码\\\":27,\\\"姓名/昵称\\\":\\\"test27\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393322},{\\\"登录名称\\\":\\\"test28\\\",\\\"密码\\\":28,\\\"姓名/昵称\\\":\\\"test28\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393323},{\\\"登录名称\\\":\\\"test29\\\",\\\"密码\\\":29,\\\"姓名/昵称\\\":\\\"test29\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393324},{\\\"登录名称\\\":\\\"test30\\\",\\\"密码\\\":30,\\\"姓名/昵称\\\":\\\"test30\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393325},{\\\"登录名称\\\":\\\"test31\\\",\\\"密码\\\":31,\\\"姓名/昵称\\\":\\\"test31\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393326},{\\\"登录名称\\\":\\\"test32\\\",\\\"密码\\\":32,\\\"姓名/昵称\\\":\\\"test32\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393327},{\\\"登录名称\\\":\\\"test33\\\",\\\"密码\\\":33,\\\"姓名/昵称\\\":\\\"test33\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393328},{\\\"登录名称\\\":\\\"test34\\\",\\\"密码\\\":34,\\\"姓名/昵称\\\":\\\"test34\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393329},{\\\"登录名称\\\":\\\"test35\\\",\\\"密码\\\":35,\\\"姓名/昵称\\\":\\\"test35\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393330},{\\\"登录名称\\\":\\\"test36\\\",\\\"密码\\\":36,\\\"姓名/昵称\\\":\\\"test36\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393331},{\\\"登录名称\\\":\\\"test37\\\",\\\"密码\\\":37,\\\"姓名/昵称\\\":\\\"test37\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393332},{\\\"登录名称\\\":\\\"test38\\\",\\\"密码\\\":38,\\\"姓名/昵称\\\":\\\"test38\\\",\\\"所属机构（编码）\\\":\\\"mxd\\\",\\\"角色（编码）\\\":\\\"admin\\\",\\\"手机号\\\":15300393333}]\\r\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 0,\\n    \\\"message\\\": \\\"登录名称已存在\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1648866276963,\\n    \\\"executeTime\\\": 21\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"datas\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"登录名称\",\n          \"value\" : \"test1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"密码\",\n          \"value\" : \"1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Integer\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"姓名/昵称\",\n          \"value\" : \"test1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"所属机构（编码）\",\n          \"value\" : \"mxd\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"角色（编码）\",\n          \"value\" : \"admin\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"手机号\",\n          \"value\" : \"15300393296\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Long\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        } ]\n      } ]\n    } ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"0\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"登录名称已存在\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1648866276963\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"21\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \"@post:/system/user/save\" as userSave;\nimport log\n\nbody.datas.each(data => {\n    var username\n    var name\n    var password\n    var phone\n    var officeId\n    var roles\n    var i = 0\n    data.each((key, value) => {\n        log.info(i + \'\')\n        if(i == 0){\n            username = value\n        }\n        if(i == 1){\n            password = value + \'\'\n        }\n        if(i == 2){\n            name = value\n        }\n        if(i == 3){\n            officeId = db.selectValue(\"\"\"\n                select id from sys_office where is_del = 0 and code = #{value}\n            \"\"\")\n            log.info(officeId)\n        }\n        if(i == 4){\n            roles = db.selectValue(\"\"\"\n                select id from sys_role where is_del = 0 and code = #{value}\n            \"\"\")\n            log.info(roles)\n        }\n        if(i == 5){\n            phone = value\n        }\n        i++\n    })\n    userSave()\n\n})\nreturn 1');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/导入数据预览.ms', '{\n  \"properties\" : { },\n  \"id\" : \"49683f16141d4a808ce925b49affff29\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"导入数据预览\",\n  \"createTime\" : 1719394266776,\n  \"updateTime\" : 1651932636716,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/import/preview\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"file\",\n    \"value\" : { },\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"MultipartFile\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"user:import:preview\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"sourceDatas\\\": \\\"[{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test1\\\\\\\",\\\\\\\"密码\\\\\\\":1,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test1\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393296},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test2\\\\\\\",\\\\\\\"密码\\\\\\\":2,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test2\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393297},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test3\\\\\\\",\\\\\\\"密码\\\\\\\":3,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test3\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393298},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test4\\\\\\\",\\\\\\\"密码\\\\\\\":4,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test4\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393299},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test5\\\\\\\",\\\\\\\"密码\\\\\\\":5,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test5\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393300},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test6\\\\\\\",\\\\\\\"密码\\\\\\\":6,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test6\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393301},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test7\\\\\\\",\\\\\\\"密码\\\\\\\":7,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test7\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393302},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test8\\\\\\\",\\\\\\\"密码\\\\\\\":8,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test8\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393303},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test9\\\\\\\",\\\\\\\"密码\\\\\\\":9,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test9\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393304},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test10\\\\\\\",\\\\\\\"密码\\\\\\\":10,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test10\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393305},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test11\\\\\\\",\\\\\\\"密码\\\\\\\":11,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test11\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393306},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test12\\\\\\\",\\\\\\\"密码\\\\\\\":12,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test12\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393307},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test13\\\\\\\",\\\\\\\"密码\\\\\\\":13,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test13\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393308},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test14\\\\\\\",\\\\\\\"密码\\\\\\\":14,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test14\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393309},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test15\\\\\\\",\\\\\\\"密码\\\\\\\":15,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test15\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393310},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test16\\\\\\\",\\\\\\\"密码\\\\\\\":16,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test16\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393311},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test17\\\\\\\",\\\\\\\"密码\\\\\\\":17,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test17\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393312},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test18\\\\\\\",\\\\\\\"密码\\\\\\\":18,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test18\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393313},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test19\\\\\\\",\\\\\\\"密码\\\\\\\":19,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test19\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393314},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test20\\\\\\\",\\\\\\\"密码\\\\\\\":20,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test20\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393315},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test21\\\\\\\",\\\\\\\"密码\\\\\\\":21,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test21\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393316},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test22\\\\\\\",\\\\\\\"密码\\\\\\\":22,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test22\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393317},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test23\\\\\\\",\\\\\\\"密码\\\\\\\":23,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test23\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393318},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test24\\\\\\\",\\\\\\\"密码\\\\\\\":24,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test24\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393319},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test25\\\\\\\",\\\\\\\"密码\\\\\\\":25,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test25\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393320},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test26\\\\\\\",\\\\\\\"密码\\\\\\\":26,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test26\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393321},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test27\\\\\\\",\\\\\\\"密码\\\\\\\":27,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test27\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393322},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test28\\\\\\\",\\\\\\\"密码\\\\\\\":28,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test28\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393323},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test29\\\\\\\",\\\\\\\"密码\\\\\\\":29,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test29\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393324},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test30\\\\\\\",\\\\\\\"密码\\\\\\\":30,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test30\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393325},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test31\\\\\\\",\\\\\\\"密码\\\\\\\":31,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test31\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393326},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test32\\\\\\\",\\\\\\\"密码\\\\\\\":32,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test32\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393327},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test33\\\\\\\",\\\\\\\"密码\\\\\\\":33,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test33\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393328},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test34\\\\\\\",\\\\\\\"密码\\\\\\\":34,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test34\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393329},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test35\\\\\\\",\\\\\\\"密码\\\\\\\":35,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test35\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393330},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test36\\\\\\\",\\\\\\\"密码\\\\\\\":36,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test36\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393331},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test37\\\\\\\",\\\\\\\"密码\\\\\\\":37,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test37\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393332},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test38\\\\\\\",\\\\\\\"密码\\\\\\\":38,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test38\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393333}]\\\",\\n        \\\"datas\\\": [{\\n            \\\"登录名称\\\": \\\"test1\\\",\\n            \\\"密码\\\": 1,\\n            \\\"姓名/昵称\\\": \\\"test1\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393296\\n        }, {\\n            \\\"登录名称\\\": \\\"test2\\\",\\n            \\\"密码\\\": 2,\\n            \\\"姓名/昵称\\\": \\\"test2\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393297\\n        }, {\\n            \\\"登录名称\\\": \\\"test3\\\",\\n            \\\"密码\\\": 3,\\n            \\\"姓名/昵称\\\": \\\"test3\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393298\\n        }, {\\n            \\\"登录名称\\\": \\\"test4\\\",\\n            \\\"密码\\\": 4,\\n            \\\"姓名/昵称\\\": \\\"test4\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393299\\n        }, {\\n            \\\"登录名称\\\": \\\"test5\\\",\\n            \\\"密码\\\": 5,\\n            \\\"姓名/昵称\\\": \\\"test5\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393300\\n        }, {\\n            \\\"登录名称\\\": \\\"test6\\\",\\n            \\\"密码\\\": 6,\\n            \\\"姓名/昵称\\\": \\\"test6\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393301\\n        }, {\\n            \\\"登录名称\\\": \\\"test7\\\",\\n            \\\"密码\\\": 7,\\n            \\\"姓名/昵称\\\": \\\"test7\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393302\\n        }, {\\n            \\\"登录名称\\\": \\\"test8\\\",\\n            \\\"密码\\\": 8,\\n            \\\"姓名/昵称\\\": \\\"test8\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393303\\n        }, {\\n            \\\"登录名称\\\": \\\"test9\\\",\\n            \\\"密码\\\": 9,\\n            \\\"姓名/昵称\\\": \\\"test9\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393304\\n        }, {\\n            \\\"登录名称\\\": \\\"test10\\\",\\n            \\\"密码\\\": 10,\\n            \\\"姓名/昵称\\\": \\\"test10\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393305\\n        }, {\\n            \\\"登录名称\\\": \\\"test11\\\",\\n            \\\"密码\\\": 11,\\n            \\\"姓名/昵称\\\": \\\"test11\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393306\\n        }, {\\n            \\\"登录名称\\\": \\\"test12\\\",\\n            \\\"密码\\\": 12,\\n            \\\"姓名/昵称\\\": \\\"test12\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393307\\n        }, {\\n            \\\"登录名称\\\": \\\"test13\\\",\\n            \\\"密码\\\": 13,\\n            \\\"姓名/昵称\\\": \\\"test13\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393308\\n        }, {\\n            \\\"登录名称\\\": \\\"test14\\\",\\n            \\\"密码\\\": 14,\\n            \\\"姓名/昵称\\\": \\\"test14\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393309\\n        }, {\\n            \\\"登录名称\\\": \\\"test15\\\",\\n            \\\"密码\\\": 15,\\n            \\\"姓名/昵称\\\": \\\"test15\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393310\\n        }, {\\n            \\\"登录名称\\\": \\\"test16\\\",\\n            \\\"密码\\\": 16,\\n            \\\"姓名/昵称\\\": \\\"test16\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393311\\n        }, {\\n            \\\"登录名称\\\": \\\"test17\\\",\\n            \\\"密码\\\": 17,\\n            \\\"姓名/昵称\\\": \\\"test17\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393312\\n        }, {\\n            \\\"登录名称\\\": \\\"test18\\\",\\n            \\\"密码\\\": 18,\\n            \\\"姓名/昵称\\\": \\\"test18\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393313\\n        }, {\\n            \\\"登录名称\\\": \\\"test19\\\",\\n            \\\"密码\\\": 19,\\n            \\\"姓名/昵称\\\": \\\"test19\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393314\\n        }, {\\n            \\\"登录名称\\\": \\\"test20\\\",\\n            \\\"密码\\\": 20,\\n            \\\"姓名/昵称\\\": \\\"test20\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393315\\n        }, {\\n            \\\"登录名称\\\": \\\"test21\\\",\\n            \\\"密码\\\": 21,\\n            \\\"姓名/昵称\\\": \\\"test21\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393316\\n        }, {\\n            \\\"登录名称\\\": \\\"test22\\\",\\n            \\\"密码\\\": 22,\\n            \\\"姓名/昵称\\\": \\\"test22\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393317\\n        }, {\\n            \\\"登录名称\\\": \\\"test23\\\",\\n            \\\"密码\\\": 23,\\n            \\\"姓名/昵称\\\": \\\"test23\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393318\\n        }, {\\n            \\\"登录名称\\\": \\\"test24\\\",\\n            \\\"密码\\\": 24,\\n            \\\"姓名/昵称\\\": \\\"test24\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393319\\n        }, {\\n            \\\"登录名称\\\": \\\"test25\\\",\\n            \\\"密码\\\": 25,\\n            \\\"姓名/昵称\\\": \\\"test25\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393320\\n        }, {\\n            \\\"登录名称\\\": \\\"test26\\\",\\n            \\\"密码\\\": 26,\\n            \\\"姓名/昵称\\\": \\\"test26\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393321\\n        }, {\\n            \\\"登录名称\\\": \\\"test27\\\",\\n            \\\"密码\\\": 27,\\n            \\\"姓名/昵称\\\": \\\"test27\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393322\\n        }, {\\n            \\\"登录名称\\\": \\\"test28\\\",\\n            \\\"密码\\\": 28,\\n            \\\"姓名/昵称\\\": \\\"test28\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393323\\n        }, {\\n            \\\"登录名称\\\": \\\"test29\\\",\\n            \\\"密码\\\": 29,\\n            \\\"姓名/昵称\\\": \\\"test29\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393324\\n        }, {\\n            \\\"登录名称\\\": \\\"test30\\\",\\n            \\\"密码\\\": 30,\\n            \\\"姓名/昵称\\\": \\\"test30\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393325\\n        }, {\\n            \\\"登录名称\\\": \\\"test31\\\",\\n            \\\"密码\\\": 31,\\n            \\\"姓名/昵称\\\": \\\"test31\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393326\\n        }, {\\n            \\\"登录名称\\\": \\\"test32\\\",\\n            \\\"密码\\\": 32,\\n            \\\"姓名/昵称\\\": \\\"test32\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393327\\n        }, {\\n            \\\"登录名称\\\": \\\"test33\\\",\\n            \\\"密码\\\": 33,\\n            \\\"姓名/昵称\\\": \\\"test33\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393328\\n        }, {\\n            \\\"登录名称\\\": \\\"test34\\\",\\n            \\\"密码\\\": 34,\\n            \\\"姓名/昵称\\\": \\\"test34\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393329\\n        }, {\\n            \\\"登录名称\\\": \\\"test35\\\",\\n            \\\"密码\\\": 35,\\n            \\\"姓名/昵称\\\": \\\"test35\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393330\\n        }, {\\n            \\\"登录名称\\\": \\\"test36\\\",\\n            \\\"密码\\\": 36,\\n            \\\"姓名/昵称\\\": \\\"test36\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393331\\n        }, {\\n            \\\"登录名称\\\": \\\"test37\\\",\\n            \\\"密码\\\": 37,\\n            \\\"姓名/昵称\\\": \\\"test37\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393332\\n        }, {\\n            \\\"登录名称\\\": \\\"test38\\\",\\n            \\\"密码\\\": 38,\\n            \\\"姓名/昵称\\\": \\\"test38\\\",\\n            \\\"所属机构（编码）\\\": \\\"马小东总公司\\\",\\n            \\\"角色（编码）\\\": \\\"管理员\\\",\\n            \\\"手机号\\\": 15300393333\\n        }]\\n    },\\n    \\\"timestamp\\\": 1648866351442,\\n    \\\"executeTime\\\": 60\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"sourceDatas\",\n        \"value\" : \"[{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test1\\\\\\\",\\\\\\\"密码\\\\\\\":1,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test1\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393296},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test2\\\\\\\",\\\\\\\"密码\\\\\\\":2,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test2\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393297},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test3\\\\\\\",\\\\\\\"密码\\\\\\\":3,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test3\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393298},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test4\\\\\\\",\\\\\\\"密码\\\\\\\":4,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test4\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393299},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test5\\\\\\\",\\\\\\\"密码\\\\\\\":5,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test5\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393300},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test6\\\\\\\",\\\\\\\"密码\\\\\\\":6,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test6\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393301},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test7\\\\\\\",\\\\\\\"密码\\\\\\\":7,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test7\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393302},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test8\\\\\\\",\\\\\\\"密码\\\\\\\":8,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test8\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393303},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test9\\\\\\\",\\\\\\\"密码\\\\\\\":9,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test9\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393304},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test10\\\\\\\",\\\\\\\"密码\\\\\\\":10,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test10\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393305},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test11\\\\\\\",\\\\\\\"密码\\\\\\\":11,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test11\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393306},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test12\\\\\\\",\\\\\\\"密码\\\\\\\":12,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test12\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393307},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test13\\\\\\\",\\\\\\\"密码\\\\\\\":13,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test13\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393308},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test14\\\\\\\",\\\\\\\"密码\\\\\\\":14,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test14\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393309},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test15\\\\\\\",\\\\\\\"密码\\\\\\\":15,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test15\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393310},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test16\\\\\\\",\\\\\\\"密码\\\\\\\":16,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test16\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393311},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test17\\\\\\\",\\\\\\\"密码\\\\\\\":17,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test17\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393312},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test18\\\\\\\",\\\\\\\"密码\\\\\\\":18,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test18\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393313},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test19\\\\\\\",\\\\\\\"密码\\\\\\\":19,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test19\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393314},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test20\\\\\\\",\\\\\\\"密码\\\\\\\":20,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test20\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393315},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test21\\\\\\\",\\\\\\\"密码\\\\\\\":21,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test21\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393316},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test22\\\\\\\",\\\\\\\"密码\\\\\\\":22,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test22\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393317},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test23\\\\\\\",\\\\\\\"密码\\\\\\\":23,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test23\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393318},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test24\\\\\\\",\\\\\\\"密码\\\\\\\":24,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test24\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393319},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test25\\\\\\\",\\\\\\\"密码\\\\\\\":25,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test25\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393320},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test26\\\\\\\",\\\\\\\"密码\\\\\\\":26,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test26\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393321},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test27\\\\\\\",\\\\\\\"密码\\\\\\\":27,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test27\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393322},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test28\\\\\\\",\\\\\\\"密码\\\\\\\":28,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test28\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393323},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test29\\\\\\\",\\\\\\\"密码\\\\\\\":29,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test29\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393324},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test30\\\\\\\",\\\\\\\"密码\\\\\\\":30,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test30\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393325},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test31\\\\\\\",\\\\\\\"密码\\\\\\\":31,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test31\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393326},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test32\\\\\\\",\\\\\\\"密码\\\\\\\":32,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test32\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393327},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test33\\\\\\\",\\\\\\\"密码\\\\\\\":33,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test33\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393328},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test34\\\\\\\",\\\\\\\"密码\\\\\\\":34,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test34\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393329},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test35\\\\\\\",\\\\\\\"密码\\\\\\\":35,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test35\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393330},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test36\\\\\\\",\\\\\\\"密码\\\\\\\":36,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test36\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393331},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test37\\\\\\\",\\\\\\\"密码\\\\\\\":37,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test37\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393332},{\\\\\\\"登录名称\\\\\\\":\\\\\\\"test38\\\\\\\",\\\\\\\"密码\\\\\\\":38,\\\\\\\"姓名/昵称\\\\\\\":\\\\\\\"test38\\\\\\\",\\\\\\\"所属机构（编码）\\\\\\\":\\\\\\\"mxd\\\\\\\",\\\\\\\"角色（编码）\\\\\\\":\\\\\\\"admin\\\\\\\",\\\\\\\"手机号\\\\\\\":15300393333}]\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"datas\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"登录名称\",\n            \"value\" : \"test1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"密码\",\n            \"value\" : \"1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Integer\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"姓名/昵称\",\n            \"value\" : \"test1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"所属机构（编码）\",\n            \"value\" : \"马小东总公司\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"角色（编码）\",\n            \"value\" : \"管理员\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"手机号\",\n            \"value\" : \"15300393296\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Long\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1648866351442\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"60\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport cn.hutool.json.JSONUtil\nimport java.io.ByteArrayInputStream\nimport java.io.InputStream\nimport cn.hutool.poi.excel.ExcelReader\nimport cn.hutool.poi.excel.ExcelUtil\nimport request\nimport log\nvar datas = ExcelUtil.getReader(new ByteArrayInputStream(request.getFile(\'file\').getBytes())).readAll()\nvar sourceDatas = datas::stringify::json\ndatas.each((data, i) => {\n    var j = 0\n    data.each((key, value) => {\n        if(j == 3){\n            data[key] = db.selectValue(\"\"\"\n                select name from sys_office where is_del = 0 and code = #{value}\n            \"\"\")\n        }\n        if(j == 4){\n            data[key] = db.selectValue(\"\"\"\n                select name from sys_role where is_del = 0 and code = #{value}\n            \"\"\")\n        }\n        j++\n    })\n})\nreturn {\n    sourceDatas,\n    datas\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/所有机构.ms', '{\n  \"properties\" : { },\n  \"id\" : \"55ddadf56dfe433baae1b5c26580cf00\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"所有机构\",\n  \"createTime\" : 1719394266792,\n  \"updateTime\" : 1680361919209,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/offices\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 500,\\n    \\\"message\\\": \\\"系统内部出现错误\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1680361909126,\\n    \\\"executeTime\\\": 175\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"500\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"系统内部出现错误\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1680361909126\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"175\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nvar toTree = (list,pid) => select t.*,toTree(list,t.key) children from list t where t.pid = pid\nvar list = toTree(db.select(\'select id \"key\",name label,pid from sys_office where is_del = 0 order by sort\'),\'0\')\n\nreturn {\n    list: list,\n    total: list.getLength()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/根据用户id获取角色列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"fc8e8dbfa2dd40e0922a22f680cde084\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"根据用户id获取角色列表\",\n  \"createTime\" : 1719394266795,\n  \"updateTime\" : 1642773983120,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/roles\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"userId\",\n    \"value\" : \"674a3aa6b1ea4d91a1f72e7879d415c3\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [],\\n    \\\"timestamp\\\": 1642773977670,\\n    \\\"executeTime\\\": 2\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1642773977670\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"2\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select role_id from sys_user_role where user_id = #{userId}\n\"\"\").map(it => {return it.roleId})');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/用户管理/获取用户信息.ms', '{\n  \"properties\" : { },\n  \"id\" : \"5f05c02a8f60480c8c81f0cac54800df\",\n  \"script\" : null,\n  \"groupId\" : \"4f0230049d7e4f39b1e0897cc0f46f9a\",\n  \"name\" : \"获取用户信息\",\n  \"createTime\" : 1719394266798,\n  \"updateTime\" : 1648431786861,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/info\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1643710751531,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1643710751531\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport \"@post:/system/security/permissions\" as authoritiesList; \n\nvar user = db.table(\"sys_user\").where().eq(\"id\",StpUtil.getLoginId()).selectOne()\nuser.authorities = authoritiesList()\nreturn user');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"组件\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/component\",\n  \"createTime\" : 1719394266352,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/保存tree.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c01db2a3b18246c89ef1a6ad6b39342c\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"保存tree\",\n  \"createTime\" : 1719394266801,\n  \"updateTime\" : 1712742368621,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save/tree\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:save:tree\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nlet data\nif(id){\n    data = {id, name}\n    if(type == \'1\'){\n        if(db.selectInt(\"select count(1) from sys_dynamic_component where is_del = 0 and type = 1 and name = #{name} and id != #{id}\") > 0){\n            exit 0, \'组件名称不能重复\'\n        }\n    }else{\n        if(\n            db.selectInt(\"\"\"\n                select count(1) from sys_dynamic_component where is_del = 0 and type = 0\n                and pid = (select pid from sys_dynamic_component where is_del = 0 and id = #{id}) and name = #{name} and id != #{id}\n            \"\"\") > 0\n            ){\n            exit 0, \'当前分组下已存在相同分组名称\'\n        }\n    }\n}else{\n    data = {pid, name}\n    if(type == \'1\'){\n        if(db.selectInt(\"select count(1) from sys_dynamic_component where is_del = 0 and type = 1 and name = #{name}\") > 0){\n            exit 0, \'组件名称不能重复\'\n        }\n    }else{\n        if(db.selectInt(\"select count(1) from sys_dynamic_component where is_del = 0 and type = 0 and pid = #{pid} and name = #{name}\") > 0){\n            exit 0, \'当前分组下已存在相同分组名称\'\n        }\n    }\n}\ndata.type = type\ndata.remark = remark\nreturn db.table(\"sys_dynamic_component\").primary(\"id\").withBlank().saveOrUpdate(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/保存代码.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ac35656c8123461e8c01e5bfa604a0ee\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"保存代码\",\n  \"createTime\" : 1719394266805,\n  \"updateTime\" : 1710083195471,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/saveCode\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:save:code\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar currentUserId = StpUtil.getLoginId()\n\nif(db.selectInt(\"select count(1) from sys_dynamic_component where id = #{id} and is_del = 0\") == 0){\n    exit 0, \'文件不存在\'\n}\n\ndb.table(\"sys_dynamic_component_history\").insert({\n    id: uuid(),\n    componentId: id,\n    sourceCode,\n    createBy: currentUserId\n})\n\nreturn db.table(\"sys_dynamic_component\").where().eq(\"id\",id).update({\n    sourceCode,\n    compileJs,\n    compileCss\n})');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"56ed96789b1e4b649265da83a7b3b8b4\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266808,\n  \"updateTime\" : 1709626054292,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [\\n        {\\n            \\\"name\\\": \\\"test\\\",\\n            \\\"compileJs\\\": \\\"const __sfc__ = {}\\\\nconst _openBlock = ___magic__import__(\'vue\', \'openBlock\');\\\\r\\\\nconst _createElementBlock = ___magic__import__(\'vue\', \'createElementBlock\');\\\\r\\\\nconst _pushScopeId = ___magic__import__(\'vue\', \'pushScopeId\');\\\\r\\\\nconst _popScopeId = ___magic__import__(\'vue\', \'popScopeId\');\\\\n\\\\nconst _withScopeId = n => (_pushScopeId(\\\\\\\"data-v-bWItc2Zj\\\\\\\"),n=n(),_popScopeId(),n)\\\\nconst _hoisted_1 = { class: \\\\\\\"qwer\\\\\\\" }\\\\nfunction render(_ctx, _cache) {\\\\n  return (_openBlock(), _createElementBlock(\\\\\\\"div\\\\\\\", _hoisted_1, \\\\\\\" 123 \\\\\\\"))\\\\n}\\\\n__sfc__.render = render\\\\n__sfc__.__scopeId = \\\\\\\"data-v-bWItc2Zj\\\\\\\"\\\\n__sfc__.__file = \\\\\\\"mb-sfc-compiler.vue\\\\\\\"\\\\nreturn __sfc__\\\",\\n            \\\"compileCss\\\": \\\".qwer[data-v-bWItc2Zj]{\\\\n    font-size: 18px;\\\\n    color: red;\\\\n}\\\"\\n        }\\n    ],\\n    \\\"timestamp\\\": 1709625945293,\\n    \\\"executeTime\\\": 30\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"name\",\n          \"value\" : \"data-test-list\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"code\",\n          \"value\" : \"\\\\n    <template>\\\\n      <mb-list ref=\\\\\\\"magicList\\\\\\\" v-bind=\\\\\\\"listOptions\\\\\\\" />\\\\n      <mb-dialog ref=\\\\\\\"formDialog\\\\\\\" @confirm-click=\\\\\\\"magicForm.save($event)\\\\\\\" width=\\\\\\\"50%\\\\\\\">\\\\n        <template #content>\\\\n          <mb-form ref=\\\\\\\"magicForm\\\\\\\" @reload=\\\\\\\"magicList.reload\\\\\\\" v-bind=\\\\\\\"formOptions\\\\\\\" />\\\\n        </template>\\\\n      </mb-dialog>\\\\n    </template>\\\\n    <script setup>\\\\n    import { ref, reactive, getCurrentInstance } from \'vue\'\\\\n    const { proxy } = getCurrentInstance()\\\\n    const formDialog = ref()\\\\n    const magicList = ref()\\\\n    const magicForm = ref()\\\\n    const listOptions = reactive({\\\\n        tools: [{\\\\n            type: \'add\',\\\\n            permission: \':data/test:save\',\\\\n            click: () => {\\\\n                formOptions.detail.formData = null\\\\n                formDialog.value.show()\\\\n            }\\\\n        }],\\\\n        table: {\\\\n            url: \'/data/test/list\',\\\\n            where: {\\\\n                name: {\\\\n                    label: \'名字\'\\\\n                },\\\\n                sex: {\\\\n                    label: \'性别\'\\\\n                },\\\\n                headPortrait: {\\\\n                    label: \'头像\'\\\\n                },\\\\n                remarks: {\\\\n                    label: \'备注\'\\\\n                }\\\\n            },\\\\n            cols: [\\\\n                {\\\\n                \\\\n                    field: \'name\',\\\\n                    label: \'名字\'\\\\n                },\\\\n                {\\\\n                    dictType: \'sex\',\\\\n                    field: \'sex\',\\\\n                    label: \'性别\'\\\\n                },\\\\n                {\\\\n                \\\\n                    field: \'headPortrait\',\\\\n                    label: \'头像\'\\\\n                },\\\\n                {\\\\n                \\\\n                    field: \'remarks\',\\\\n                    label: \'备注\'\\\\n                },{\\\\n                    label: \'操作\',\\\\n                    type: \'btns\',\\\\n                    width: 140,\\\\n                    fixed: \'right\',\\\\n                    btns: [\\\\n                        {\\\\n                            permission: \':data/test:save\',\\\\n                            label: \'修改\',\\\\n                            type: \'text\',\\\\n                            icon: \'ElEdit\',\\\\n                            click: (row) => {\\\\n                                magicForm.value.getDetail(row.id)\\\\n                                formDialog.value.show()\\\\n                            }\\\\n                        }, {\\\\n                            permission: \':data/test:delete\',\\\\n                            label: \'删除\',\\\\n                            type: \'text\',\\\\n                            icon: \'ElDelete\',\\\\n                            click: (row) => {\\\\n                                proxy.$common.handleDelete({\\\\n                                    url: \'/data/test/delete\',\\\\n                                    id: row.id,\\\\n                                    done: () => magicList.value.reload()\\\\n                                })\\\\n                            }\\\\n                        }\\\\n                    ]\\\\n                }\\\\n            ]\\\\n        }\\\\n    })\\\\n    \\\\n    const formOptions = reactive({\\\\n        detail: {\\\\n            request: {\\\\n              url: \'/data/test/get\'\\\\n            }\\\\n        },\\\\n        form: {\\\\n            request: {\\\\n                url: \\\\\\\"/data/test/save\\\\\\\",\\\\n                method: \\\\\\\"post\\\\\\\"\\\\n            },\\\\n            rows: [{\\\\n                gutter: 24,\\\\n                cols: [{\\\\n                    span: 12,\\\\n                    name: \'name\',\\\\n                    label: \'名字\',\\\\n                    component: \'input\'\\\\n                },{\\\\n                    span: 12,\\\\n                    name: \'sex\',\\\\n                    label: \'性别\',\\\\n                    component: \'radio-group\'\\\\n                },{\\\\n                    span: 12,\\\\n                    name: \'headPortrait\',\\\\n                    label: \'头像\',\\\\n                    component: \'upload-image\'\\\\n                },{\\\\n                    span: 12,\\\\n                    name: \'remarks\',\\\\n                    label: \'备注\',\\\\n                    component: \'input\',\\\\n                    props: {\\\\n                        type: \'textarea\'\\\\n                    }\\\\n      \\\\n                }]\\\\n            }]\\\\n        }\\\\n    })\\\\n\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1648608988019\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"24\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"select name, compile_js, compile_css from sys_dynamic_component where is_del = 0 and compile_js is not null\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/删除组件.ms', '{\n  \"properties\" : { },\n  \"id\" : \"da1bbeb256cf417cb26aaf2426ed58c3\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"删除组件\",\n  \"createTime\" : 1719394266816,\n  \"updateTime\" : 1710082768049,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\n\nlet recursionDelete = (list) => {\n    list.forEach(it => {\n        db.table(\"sys_dynamic_component\").logic().where().eq(\"id\",it.id).delete()\n        let children = db.select(\"select id from sys_dynamic_component where is_del = 0 and pid = #{it.id}\")\n        if(children && children.size() > 0){\n            recursionDelete(children)\n        }\n    })\n}\nrecursionDelete(db.select(\"select id from sys_dynamic_component where is_del = 0 and pid = #{id}\"))\n\nreturn db.table(\"sys_dynamic_component\").logic().where().eq(\"id\",id).delete()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/组件历史.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ddcc356a6e3d4ed6b901be999bdb90c0\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"组件历史\",\n  \"createTime\" : 1719394266819,\n  \"updateTime\" : 1710083257848,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/history\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:history:list\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"total\\\": 164,\\n        \\\"list\\\": [\\n            {\\n                \\\"id\\\": \\\"0474e1a3d44247f0ac09bcae02bdcff2\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 11:34:35\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"04b98d9889bf451d8d398cef3d32f899\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 14:09:20\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"04e7c8c5fb81490ca9e4cffc12e9a622\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 12:15:09\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"05db93da5de1442bafd1b3638693f1da\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 14:12:43\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"0749a7bbd1c4473cacf3a74175288f74\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 11:10:23\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"07b8216e94c4439688843f177f43404f\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 11:11:29\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"081394d27c8b43f98ebdf3b092265384\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 15:02:30\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"0affca0c150942e5bab5d796c4db14aa\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 14:04:52\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"0dc4027ff5e64dae91e6cbec41605e3d\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 11:16:29\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            },\\n            {\\n                \\\"id\\\": \\\"0f929ebc16d74c2488425ff46fc3d289\\\",\\n                \\\"createDate\\\": \\\"2024-03-07 14:12:30\\\",\\n                \\\"createby\\\": \\\"admin\\\"\\n            }\\n        ]\\n    },\\n    \\\"timestamp\\\": 1709803746297,\\n    \\\"executeTime\\\": 94\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select \n        id,\n        create_date,\n        (select username from sys_user where id = sdch.create_by) create_by\n    from sys_dynamic_component_history sdch\n    where component_id = #{componentId}\n    order by create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/获取历史代码详情.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f21ff197058a47e0ba1e1c6c714081ce\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"获取历史代码详情\",\n  \"createTime\" : 1719394266824,\n  \"updateTime\" : 1710083294611,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/history/detail\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:history:detail\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectValue(\"\"\"\n    select source_code from sys_dynamic_component_history where id = #{id} and is_del = 0\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/获取最后一版代码.ms', '{\n  \"properties\" : { },\n  \"id\" : \"530c445f0e69494581d1420cd5311440\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"获取最后一版代码\",\n  \"createTime\" : 1719394266827,\n  \"updateTime\" : 1710082965250,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getLastCode\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:get:last:code\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectOne(\"\"\"\n    select \n        source_code,\n        create_date,\n        (select username from sys_user where id = sdch.create_by) create_by\n    from sys_dynamic_component_history sdch where component_id = #{componentId}\n    order by create_date desc limit 1\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/获取源码.ms', '{\n  \"properties\" : { },\n  \"id\" : \"2e3a230acf004dcdb679ff3a46a8a20a\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"获取源码\",\n  \"createTime\" : 1719394266843,\n  \"updateTime\" : 1710083402784,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getSourceCode\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:get:code\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectValue(\"\"\"\n    select source_code from sys_dynamic_component where is_del = 0 and id = #{id}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组件/获取组件tree.ms', '{\n  \"properties\" : { },\n  \"id\" : \"8ba14d61082e4ba69324fdc9de080f38\",\n  \"script\" : null,\n  \"groupId\" : \"6f106ebdee21489db34b956f7770ff03\",\n  \"name\" : \"获取组件tree\",\n  \"createTime\" : 1719394266848,\n  \"updateTime\" : 1712742831654,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/tree\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"component:tree\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar toTree = (list,pid) => select t.*,toTree(list,t.id) children from list t where t.pid = pid\nvar list = toTree(db.select(\"\"\"\n    select \n        dc.id,\n        (case when dc.remark is not null and dc.remark != \'\' then concat(dc.name,\'(\',dc.remark, \')\') else dc.name end) name,\n        dc.pid,\n        (case when dc.type = 0 then 1 else 0 end) is_group\n    from sys_dynamic_component dc\n    where dc.is_del = 0 \n    order by dc.name\n\"\"\"),\'0\')\n\nreturn {\n    list: list,\n    total: list.getLength()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"组织机构\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/office\",\n  \"createTime\" : 1719394266358,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/上移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"37aaae0a84ce4e00ad4f89d704d3cb51\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"上移\",\n  \"createTime\" : 1719394266853,\n  \"updateTime\" : 1651932358086,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/up\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"office:sort:up\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_office \n    WHERE\n        is_del = 0 \n        AND pid = #{pid}\n        AND sort < ( SELECT sort FROM sys_office WHERE is_del = 0 AND id = #{id} ) \n    ORDER BY\n        sort DESC \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_office set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_office set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/下移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"5f8edf5b8045475f92049270bcf0739a\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"下移\",\n  \"createTime\" : 1719394266857,\n  \"updateTime\" : 1651932356319,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/down\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"office:sort:down\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_office \n    WHERE\n        is_del = 0 \n        AND pid = #{pid}\n        AND sort > ( SELECT sort FROM sys_office WHERE is_del = 0 AND id = #{id} )\n    ORDER BY\n        sort \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_office set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_office set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"03c2c9614e5b47f48f61f4f7759fe353\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266861,\n  \"updateTime\" : 1647615397163,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"office:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar codeCount = db.selectInt(\"select count(1) from sys_office where is_del = 0 and code = #{code} ?{id, and id != #{id}}\")\nif(codeCount > 0){\n    exit 0,\'机构编码已存在\'\n}\nreturn db.table(\"sys_office\").primary(\"id\").saveOrUpdate(data);');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f7fa03a5d8b64dbaa39387c185a21adb\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266866,\n  \"updateTime\" : 1645694064991,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/tree\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"office:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1645694060610,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1645694060610\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nvar toTree = (list,pid) => select t.*,toTree(list,t.id) children from list t where t.pid = pid\nvar list = toTree(db.select(\'select id,name,pid,type,sort,code from sys_office where is_del = 0 order by sort\'),\'0\')\n\nreturn {\n    list: list,\n    total: list.getLength()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"4f2140a0d177450da2f27e4569afb7b8\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266871,\n  \"updateTime\" : 1679552802807,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"office:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1641201245421,\\n    \\\"executeTime\\\": 7\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1641201245421\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"7\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nvar pCount = db.selectInt(\"select count(1) from sys_office where is_del = 0 and pid = #{id}\")\nif(pCount > 0){\n    exit 500,\'存在下级机构,不允许删除\'\n}\nvar userCount = db.selectInt(\"select count(1) from sys_user where is_del = 0 and office_id = #{id}\")\nif(userCount > 0){\n    exit 500, \'机构存在用户,不允许删除\'\n}\n// var root = db.selectValue(\"select pid from sys_office where is_del = 0 and id = #{id}\")\n// if(root == \'0\'){\n//     exit 500, \'不能删除根节点\'\n// }\n// db.table(\'sys_user_office\').where().eq(\"office_id\",id).delete();\nreturn db.table(\"sys_office\").logic().where().eq(\"id\",id).delete();\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/根据角色获取组织机构.ms', '{\n  \"properties\" : { },\n  \"id\" : \"dd6fd96602cb4905b5c2d79f584ab0a0\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"根据角色获取组织机构\",\n  \"createTime\" : 1719394266875,\n  \"updateTime\" : 1642080922495,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/by/role\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [],\\n    \\\"timestamp\\\": 1642080916671,\\n    \\\"executeTime\\\": 90\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1642080916671\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"90\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select office_id id from sys_role_office where role_id = #{roleId}\n\"\"\").map(it => it.id)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/组织机构/获取排序号.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f6e998eaff2c49be807fcb38a1a7d55b\",\n  \"script\" : null,\n  \"groupId\" : \"8295fc13678d4144bf7363c465247a50\",\n  \"name\" : \"获取排序号\",\n  \"createTime\" : 1719394266879,\n  \"updateTime\" : 1641732159522,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectInt(\"\"\"\n    select max(sort) + 10 from sys_office where pid = #{pid} and is_del = \'0\'\n\"\"\") || 10;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"菜单管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/menu\",\n  \"createTime\" : 1719394266363,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/上移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9817f2dbbc20419298e07bc644387f91\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"上移\",\n  \"createTime\" : 1719394266883,\n  \"updateTime\" : 1651927489059,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/up\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:sort:up\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_menu \n    WHERE\n        is_del = 0 \n        AND pid = #{pid}\n        AND sort < ( SELECT sort FROM sys_menu WHERE is_del = 0 AND id = #{id} ) \n    ORDER BY\n        sort DESC \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_menu set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_menu set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/下移.ms', '{\n  \"properties\" : { },\n  \"id\" : \"77d393db826d4ba882b7c4b1d32e2e98\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"下移\",\n  \"createTime\" : 1719394266897,\n  \"updateTime\" : 1651930976250,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort/down\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:sort:down\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nvar top = db.selectOne(\"\"\"\n    SELECT\n        id,\n        sort\n    FROM\n        sys_menu \n    WHERE\n        is_del = 0 \n        AND pid = #{pid}\n        AND sort > ( SELECT sort FROM sys_menu WHERE is_del = 0 AND id = #{id} )\n    ORDER BY\n        sort \n        LIMIT 1\n\"\"\")\nif(top){\n    db.update(\"\"\"\n        update sys_menu set sort = #{top.sort} where id = #{id}\n    \"\"\")\n    db.update(\"\"\"\n        update sys_menu set sort = #{sort} where id = #{top.id}\n    \"\"\")\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"d6d05df1e8b14a6ebc270113b2cdd1ed\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266902,\n  \"updateTime\" : 1665500740432,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : \"guyi\",\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache;\nimport \'@get:/system/menu/cache/delete\' as cacheDelete;\n\nif(data.url){\n    var urlCount = db.selectInt(\"select count(1) from sys_menu where is_del = 0 and url = #{data.url} ?{data.id, and id != #{data.id}}\")\n    if(urlCount > 0){\n        exit 0,\'菜单链接已存在\'\n    }\n}\nif(data.permission){\n    var permissionCount = db.selectInt(\"select count(1) from sys_menu where is_del = 0 and permission = #{data.permission} ?{data.id, and id != #{data.id}}\")\n    if(permissionCount > 0){\n        exit 0,\'权限标识已存在\'\n    }\n}\n\nvar result = db.table(\"sys_menu\").primary(\"id\").withBlank().saveOrUpdate(data);\n\nSqlCache.delete(\'permissions:1\')\nif(data.id){\n    var menuId = data.id\n    cacheDelete();\n}\nreturn result');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/修改是否显示.ms', '{\n  \"properties\" : { },\n  \"id\" : \"62020bd7a49949378e90ce2d14fef8f7\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"修改是否显示\",\n  \"createTime\" : 1719394266907,\n  \"updateTime\" : 1651931012437,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/change\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:change\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\"sys_menu\").primary(\"id\").update(data)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"3564ad867beb48898f85c44bd3f7aa3f\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266911,\n  \"updateTime\" : 1712806455648,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ {\n    \"name\" : \"id\",\n    \"value\" : \"b1851d1b13594e71840103c11a37a669\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1641201245421,\\n    \\\"executeTime\\\": 7\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1641201245421\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"7\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\nvar userIds = db.select(\"\"\"\n    select user_id from sys_user_role where role_id in (\n        select role_id from sys_role_menu where menu_id = #{id}\n    ) and user_id is not null\n\"\"\")\nfor(item in userIds){\n    SqlCache.delete(`permissions:${item.userId}`)\n}\nSqlCache.delete(\'permissions:1\')\n\nlet recursionDelete = (list) => {\n    list.forEach(it => {\n        db.table(\'sys_role_menu\').where().eq(\"menu_id\",it.id).delete();\n        db.table(\"sys_menu\").logic().where().eq(\"id\",it.id).delete()\n        let children = db.select(\"select id from sys_menu where is_del = 0 and pid = #{it.id}\")\n        if(children && children.size() > 0){\n            recursionDelete(children)\n        }\n    })\n}\nrecursionDelete(db.select(\"select id from sys_menu where is_del = 0 and pid = #{id}\"))\n\ndb.table(\'sys_role_menu\').where().eq(\"menu_id\",id).delete();\nreturn db.table(\"sys_menu\").logic().where().eq(\"id\",id).delete();');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/当前用户菜单.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f608811b430f4a3cb82feed4067cde71\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"当前用户菜单\",\n  \"createTime\" : 1719394266915,\n  \"updateTime\" : 1712022801179,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/current/menus\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"notLayoutMenus\\\": [\\n            {\\n                \\\"openMode\\\": \\\"0\\\",\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"name\\\": \\\"区域管理\\\",\\n                \\\"path\\\": \\\"/system/area\\\",\\n                \\\"subCount\\\": 0,\\n                \\\"keepAlive\\\": 0\\n            },\\n            {\\n                \\\"openMode\\\": \\\"1\\\",\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"name\\\": \\\"动态组件\\\",\\n                \\\"path\\\": \\\"/examples/sfc-component\\\",\\n                \\\"subCount\\\": 0,\\n                \\\"keepAlive\\\": 0\\n            },\\n            {\\n                \\\"openMode\\\": \\\"1\\\",\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"name\\\": \\\"接口管理\\\",\\n                \\\"path\\\": \\\"/lowcode/magic-editor\\\",\\n                \\\"subCount\\\": 0,\\n                \\\"keepAlive\\\": 1\\n            }\\n        ],\\n        \\\"layoutMenus\\\": [\\n            {\\n                \\\"id\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                \\\"title\\\": \\\"系统设置\\\",\\n                \\\"pid\\\": \\\"0\\\",\\n                \\\"isShow\\\": 1,\\n                \\\"url\\\": \\\"/system\\\",\\n                \\\"sort\\\": 10,\\n                \\\"icon\\\": \\\"SettingsSharp\\\",\\n                \\\"keepAlive\\\": 0,\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"openMode\\\": \\\"0\\\",\\n                \\\"component\\\": \\\"Layout\\\",\\n                \\\"path\\\": \\\"/system\\\",\\n                \\\"meta\\\": {\\n                    \\\"title\\\": \\\"系统设置\\\",\\n                    \\\"icon\\\": \\\"SettingsSharp\\\",\\n                    \\\"keepAlive\\\": false,\\n                    \\\"openMode\\\": \\\"0\\\",\\n                    \\\"path\\\": \\\"/system\\\"\\n                },\\n                \\\"redirect\\\": \\\"noRedirect\\\",\\n                \\\"alwaysShow\\\": true,\\n                \\\"children\\\": [\\n                    {\\n                        \\\"id\\\": \\\"39be13ef6f0745568c80bf35202ddb2b\\\",\\n                        \\\"title\\\": \\\"菜单管理\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/menu/menu-list\\\",\\n                        \\\"sort\\\": 10,\\n                        \\\"icon\\\": \\\"Menu\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/menu/menu-list\\\",\\n                        \\\"path\\\": \\\"/system/menu/menu-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"菜单管理\\\",\\n                            \\\"icon\\\": \\\"Menu\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/menu/menu-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"6f3594d0-5445-41e1-a13c-890a57485036\\\",\\n                        \\\"title\\\": \\\"组织机构\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/office/office-list\\\",\\n                        \\\"sort\\\": 20,\\n                        \\\"icon\\\": \\\"Organization12Filled\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/office/office-list\\\",\\n                        \\\"path\\\": \\\"/system/office/office-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"组织机构\\\",\\n                            \\\"icon\\\": \\\"Organization12Filled\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/office/office-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"8e9455740091486c914495cfb0c7faa5\\\",\\n                        \\\"title\\\": \\\"角色管理\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/role/role-list\\\",\\n                        \\\"sort\\\": 40,\\n                        \\\"icon\\\": \\\"Accessibility\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/role/role-list\\\",\\n                        \\\"path\\\": \\\"/system/role/role-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"角色管理\\\",\\n                            \\\"icon\\\": \\\"Accessibility\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/role/role-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"06b8a427e4cd4c1ba11752070f565f20\\\",\\n                        \\\"title\\\": \\\"用户管理\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/user/user-list\\\",\\n                        \\\"sort\\\": 50,\\n                        \\\"icon\\\": \\\"People\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/user/user-list\\\",\\n                        \\\"path\\\": \\\"/system/user/user-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"用户管理\\\",\\n                            \\\"icon\\\": \\\"People\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/user/user-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"c5f407478c4e4c9cbcdbee6389d2c909\\\",\\n                        \\\"title\\\": \\\"数据字典\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/dict/dict-list\\\",\\n                        \\\"sort\\\": 60,\\n                        \\\"icon\\\": \\\"BookLetter24Filled\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/dict/dict-list\\\",\\n                        \\\"path\\\": \\\"/system/dict/dict-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"数据字典\\\",\\n                            \\\"icon\\\": \\\"BookLetter24Filled\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/dict/dict-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"10fc3bdde0c642aea2af34d281a49cf9\\\",\\n                        \\\"title\\\": \\\"测试数据\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/test/test-list\\\",\\n                        \\\"sort\\\": 100,\\n                        \\\"icon\\\": \\\"home\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"data-test-list\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/test/test-list\\\",\\n                        \\\"path\\\": \\\"/system/test/test-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试数据\\\",\\n                            \\\"icon\\\": \\\"home\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/test/test-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"7ad229f12c8f4b57bbb9349e2ffd8932\\\",\\n                        \\\"title\\\": \\\"配置中心\\\",\\n                        \\\"pid\\\": \\\"b1851d1b13594e71840103c11a37a669\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/configure/configure-list\\\",\\n                        \\\"sort\\\": 110,\\n                        \\\"icon\\\": \\\"ContentSettings24Filled\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/configure/configure-list\\\",\\n                        \\\"path\\\": \\\"/system/configure/configure-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"配置中心\\\",\\n                            \\\"icon\\\": \\\"ContentSettings24Filled\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/configure/configure-list\\\"\\n                        }\\n                    }\\n                ]\\n            },\\n            {\\n                \\\"id\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                \\\"title\\\": \\\"一些例子\\\",\\n                \\\"pid\\\": \\\"0\\\",\\n                \\\"isShow\\\": 1,\\n                \\\"url\\\": \\\"/examples\\\",\\n                \\\"sort\\\": 20,\\n                \\\"icon\\\": \\\"ClipboardCode24Filled\\\",\\n                \\\"keepAlive\\\": 0,\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"openMode\\\": \\\"0\\\",\\n                \\\"component\\\": \\\"Layout\\\",\\n                \\\"path\\\": \\\"/examples\\\",\\n                \\\"meta\\\": {\\n                    \\\"title\\\": \\\"一些例子\\\",\\n                    \\\"icon\\\": \\\"ClipboardCode24Filled\\\",\\n                    \\\"keepAlive\\\": false,\\n                    \\\"openMode\\\": \\\"0\\\",\\n                    \\\"path\\\": \\\"/examples\\\"\\n                },\\n                \\\"redirect\\\": \\\"noRedirect\\\",\\n                \\\"alwaysShow\\\": true,\\n                \\\"children\\\": [\\n                    {\\n                        \\\"id\\\": \\\"dc332875-831e-4937-86ff-0c7420915ce9\\\",\\n                        \\\"title\\\": \\\"三级联动\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/three-linkage\\\",\\n                        \\\"sort\\\": 10,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/three-linkage\\\",\\n                        \\\"path\\\": \\\"/examples/three-linkage\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"三级联动\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/three-linkage\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"f09410d5-5043-4164-9f68-8d135de71b29\\\",\\n                        \\\"title\\\": \\\"上传文件\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/upload-file\\\",\\n                        \\\"sort\\\": 20,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/upload-file\\\",\\n                        \\\"path\\\": \\\"/examples/upload-file\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"上传文件\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/upload-file\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"74c852ea-be4b-4533-b146-cfbd776045d5\\\",\\n                        \\\"title\\\": \\\"富文本\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/ueditor-example\\\",\\n                        \\\"sort\\\": 30,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/ueditor-example\\\",\\n                        \\\"path\\\": \\\"/examples/ueditor-example\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"富文本\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/ueditor-example\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"91bdb7d742a64a8c8a8fdc6d3bb61581\\\",\\n                        \\\"title\\\": \\\"可编辑表格\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/editor-table\\\",\\n                        \\\"sort\\\": 40,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/editor-table\\\",\\n                        \\\"path\\\": \\\"/examples/editor-table\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"可编辑表格\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/editor-table\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"2664b76cb2904227bce5b0f7d1dd6e7b\\\",\\n                        \\\"title\\\": \\\"下拉框\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/select-example\\\",\\n                        \\\"sort\\\": 60,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/select-example\\\",\\n                        \\\"path\\\": \\\"/examples/select-example\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"下拉框\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/select-example\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"c50388914fab408c8b74f83d0d43e557\\\",\\n                        \\\"title\\\": \\\"测试列表\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/test-mb-list\\\",\\n                        \\\"sort\\\": 70,\\n                        \\\"icon\\\": null,\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": null,\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/test-mb-list\\\",\\n                        \\\"path\\\": \\\"/examples/test-mb-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试列表\\\",\\n                            \\\"icon\\\": null,\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/test-mb-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"713626516eaa4ba98c9daf55009b481e\\\",\\n                        \\\"title\\\": \\\"测试表单\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/test-mb-form\\\",\\n                        \\\"sort\\\": 80,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/test-mb-form\\\",\\n                        \\\"path\\\": \\\"/examples/test-mb-form\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试表单\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/test-mb-form\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"9385945c7f5f476ab38885976907db2a\\\",\\n                        \\\"title\\\": \\\"测试外链\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"http://baidu.com\\\",\\n                        \\\"sort\\\": 90,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"1\\\",\\n                        \\\"component\\\": \\\"http://baidu.com\\\",\\n                        \\\"path\\\": \\\"http://baidu.com\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试外链\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"1\\\",\\n                            \\\"path\\\": \\\"http://baidu.com\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"a1564eaf9fb249a788d15bb4bce609a8\\\",\\n                        \\\"title\\\": \\\"穿梭表格\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/shuttle-table\\\",\\n                        \\\"sort\\\": 100,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/shuttle-table\\\",\\n                        \\\"path\\\": \\\"/examples/shuttle-table\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"穿梭表格\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/shuttle-table\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"b4e9009b24d14233a59029ec57681e2c\\\",\\n                        \\\"title\\\": \\\"下拉表格\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/select-table\\\",\\n                        \\\"sort\\\": 110,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/select-table\\\",\\n                        \\\"path\\\": \\\"/examples/select-table\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"下拉表格\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/select-table\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"ff651d9c2bf94179b04f821802f4022e\\\",\\n                        \\\"title\\\": \\\"test-sfc\\\",\\n                        \\\"pid\\\": \\\"641253af-8ea1-4b5d-8bc3-a7165ef60ff2\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/test-sfc-compiler\\\",\\n                        \\\"sort\\\": 120,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/examples/test-sfc-compiler\\\",\\n                        \\\"path\\\": \\\"/examples/test-sfc-compiler\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"test-sfc\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/examples/test-sfc-compiler\\\"\\n                        }\\n                    }\\n                ]\\n            },\\n            {\\n                \\\"id\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                \\\"title\\\": \\\"低代码\\\",\\n                \\\"pid\\\": \\\"0\\\",\\n                \\\"isShow\\\": 1,\\n                \\\"url\\\": \\\"/lowcode\\\",\\n                \\\"sort\\\": 30,\\n                \\\"icon\\\": \\\"ClipboardCode24Filled\\\",\\n                \\\"keepAlive\\\": 1,\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"openMode\\\": \\\"0\\\",\\n                \\\"component\\\": \\\"Layout\\\",\\n                \\\"path\\\": \\\"/lowcode\\\",\\n                \\\"meta\\\": {\\n                    \\\"title\\\": \\\"低代码\\\",\\n                    \\\"icon\\\": \\\"ClipboardCode24Filled\\\",\\n                    \\\"keepAlive\\\": true,\\n                    \\\"openMode\\\": \\\"0\\\",\\n                    \\\"path\\\": \\\"/lowcode\\\"\\n                },\\n                \\\"redirect\\\": \\\"noRedirect\\\",\\n                \\\"alwaysShow\\\": true,\\n                \\\"children\\\": [\\n                    {\\n                        \\\"id\\\": \\\"c7445e2ac6144a15a76d723607fbfb9d\\\",\\n                        \\\"title\\\": \\\"接口管理\\\",\\n                        \\\"pid\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/lowcode/magic-editor\\\",\\n                        \\\"sort\\\": 20,\\n                        \\\"icon\\\": \\\"interface\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"1\\\",\\n                        \\\"component\\\": \\\"/lowcode/magic-editor\\\",\\n                        \\\"path\\\": \\\"/lowcode/magic-editor\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"接口管理\\\",\\n                            \\\"icon\\\": \\\"interface\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"1\\\",\\n                            \\\"path\\\": \\\"/lowcode/magic-editor\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"99c6e9aeb6694c349f5db66e2516f069\\\",\\n                        \\\"title\\\": \\\"代码生成\\\",\\n                        \\\"pid\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/lowcode/code-gen-list\\\",\\n                        \\\"sort\\\": 30,\\n                        \\\"icon\\\": \\\"examples\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/lowcode/code-gen-list\\\",\\n                        \\\"path\\\": \\\"/lowcode/code-gen-list\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"代码生成\\\",\\n                            \\\"icon\\\": \\\"examples\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/lowcode/code-gen-list\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"bf5c1e44546341de9acee52d148d5a76\\\",\\n                        \\\"title\\\": \\\"测试生成\\\",\\n                        \\\"pid\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/data/test\\\",\\n                        \\\"sort\\\": 40,\\n                        \\\"icon\\\": null,\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"data-test-list\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/data/test\\\",\\n                        \\\"path\\\": \\\"/data/test\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试生成\\\",\\n                            \\\"icon\\\": null,\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/data/test\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"f23e1fefbc534100915d430b5f956355\\\",\\n                        \\\"title\\\": \\\"动态组件\\\",\\n                        \\\"pid\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/examples/sfc-component\\\",\\n                        \\\"sort\\\": 120,\\n                        \\\"icon\\\": \\\"component\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"1\\\",\\n                        \\\"component\\\": \\\"/examples/sfc-component\\\",\\n                        \\\"path\\\": \\\"/examples/sfc-component\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"动态组件\\\",\\n                            \\\"icon\\\": \\\"component\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"1\\\",\\n                            \\\"path\\\": \\\"/examples/sfc-component\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"51aefb57c65b493f9d38e10523d1615e\\\",\\n                        \\\"title\\\": \\\"测试动态组件\\\",\\n                        \\\"pid\\\": \\\"d7f8d052d4864bd285c575c3cf2dce69\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/testaaaaaa\\\",\\n                        \\\"sort\\\": 130,\\n                        \\\"icon\\\": \\\"\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"d7604783f8c4499ab9a6b1817e7649a2\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/testaaaaaa\\\",\\n                        \\\"path\\\": \\\"/testaaaaaa\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试动态组件\\\",\\n                            \\\"icon\\\": \\\"\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/testaaaaaa\\\"\\n                        }\\n                    }\\n                ]\\n            },\\n            {\\n                \\\"id\\\": \\\"4a57f57fc7324c94b6390f1a2dd1f49a\\\",\\n                \\\"title\\\": \\\"系统监控\\\",\\n                \\\"pid\\\": \\\"0\\\",\\n                \\\"isShow\\\": 1,\\n                \\\"url\\\": \\\"/system/monitor\\\",\\n                \\\"sort\\\": 40,\\n                \\\"icon\\\": \\\"Camera\\\",\\n                \\\"keepAlive\\\": 0,\\n                \\\"componentName\\\": \\\"\\\",\\n                \\\"openMode\\\": \\\"0\\\",\\n                \\\"component\\\": \\\"Layout\\\",\\n                \\\"path\\\": \\\"/system/monitor\\\",\\n                \\\"meta\\\": {\\n                    \\\"title\\\": \\\"系统监控\\\",\\n                    \\\"icon\\\": \\\"Camera\\\",\\n                    \\\"keepAlive\\\": false,\\n                    \\\"openMode\\\": \\\"0\\\",\\n                    \\\"path\\\": \\\"/system/monitor\\\"\\n                },\\n                \\\"redirect\\\": \\\"noRedirect\\\",\\n                \\\"alwaysShow\\\": true,\\n                \\\"children\\\": [\\n                    {\\n                        \\\"id\\\": \\\"4fc65edbe0544c369b58fdfed1523537\\\",\\n                        \\\"title\\\": \\\"操作日志\\\",\\n                        \\\"pid\\\": \\\"4a57f57fc7324c94b6390f1a2dd1f49a\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/monitor/oper\\\",\\n                        \\\"sort\\\": 10,\\n                        \\\"icon\\\": \\\"oper-log\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"Layout\\\",\\n                        \\\"path\\\": \\\"/system/monitor/oper\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"操作日志\\\",\\n                            \\\"icon\\\": \\\"oper-log\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/monitor/oper\\\"\\n                        },\\n                        \\\"redirect\\\": \\\"noRedirect\\\",\\n                        \\\"alwaysShow\\\": true,\\n                        \\\"children\\\": [\\n                            {\\n                                \\\"id\\\": \\\"5e53c7ada9a0456dbc949c5c5d6abc41\\\",\\n                                \\\"title\\\": \\\"操作日志\\\",\\n                                \\\"pid\\\": \\\"4fc65edbe0544c369b58fdfed1523537\\\",\\n                                \\\"isShow\\\": 1,\\n                                \\\"url\\\": \\\"/system/monitor/opera\\\",\\n                                \\\"sort\\\": 10,\\n                                \\\"icon\\\": \\\"\\\",\\n                                \\\"keepAlive\\\": 0,\\n                                \\\"componentName\\\": \\\"\\\",\\n                                \\\"openMode\\\": \\\"0\\\",\\n                                \\\"component\\\": \\\"Layout\\\",\\n                                \\\"path\\\": \\\"/system/monitor/opera\\\",\\n                                \\\"meta\\\": {\\n                                    \\\"title\\\": \\\"操作日志\\\",\\n                                    \\\"icon\\\": \\\"\\\",\\n                                    \\\"keepAlive\\\": false,\\n                                    \\\"openMode\\\": \\\"0\\\",\\n                                    \\\"path\\\": \\\"/system/monitor/opera\\\"\\n                                },\\n                                \\\"redirect\\\": \\\"noRedirect\\\",\\n                                \\\"alwaysShow\\\": true,\\n                                \\\"children\\\": [\\n                                    {\\n                                        \\\"id\\\": \\\"77469b38dedf4b398c0cea424be89c3f\\\",\\n                                        \\\"title\\\": \\\"zx\\\",\\n                                        \\\"pid\\\": \\\"5e53c7ada9a0456dbc949c5c5d6abc41\\\",\\n                                        \\\"isShow\\\": 1,\\n                                        \\\"url\\\": \\\"/system/monitor/oper-log\\\",\\n                                        \\\"sort\\\": 10,\\n                                        \\\"icon\\\": \\\"\\\",\\n                                        \\\"keepAlive\\\": 0,\\n                                        \\\"componentName\\\": \\\"\\\",\\n                                        \\\"openMode\\\": \\\"0\\\",\\n                                        \\\"component\\\": \\\"/system/monitor/oper-log\\\",\\n                                        \\\"path\\\": \\\"/system/monitor/oper-log\\\",\\n                                        \\\"meta\\\": {\\n                                            \\\"title\\\": \\\"zx\\\",\\n                                            \\\"icon\\\": \\\"\\\",\\n                                            \\\"keepAlive\\\": false,\\n                                            \\\"openMode\\\": \\\"0\\\",\\n                                            \\\"path\\\": \\\"/system/monitor/oper-log\\\"\\n                                        }\\n                                    }\\n                                ]\\n                            }\\n                        ]\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"eee27ca353fb440aa5ac0bd7b38cad1d\\\",\\n                        \\\"title\\\": \\\"登录日志\\\",\\n                        \\\"pid\\\": \\\"4a57f57fc7324c94b6390f1a2dd1f49a\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/monitor/login-log\\\",\\n                        \\\"sort\\\": 20,\\n                        \\\"icon\\\": \\\"login-log\\\",\\n                        \\\"keepAlive\\\": 1,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/monitor/login-log\\\",\\n                        \\\"path\\\": \\\"/system/monitor/login-log\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"登录日志\\\",\\n                            \\\"icon\\\": \\\"login-log\\\",\\n                            \\\"keepAlive\\\": true,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/monitor/login-log\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"3a0e3107402449698d86ee3cbc5272c0\\\",\\n                        \\\"title\\\": \\\"数据库监控\\\",\\n                        \\\"pid\\\": \\\"4a57f57fc7324c94b6390f1a2dd1f49a\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/monitor/druid\\\",\\n                        \\\"sort\\\": 30,\\n                        \\\"icon\\\": \\\"database\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/monitor/druid\\\",\\n                        \\\"path\\\": \\\"/system/monitor/druid\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"数据库监控\\\",\\n                            \\\"icon\\\": \\\"database\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/monitor/druid\\\"\\n                        }\\n                    },\\n                    {\\n                        \\\"id\\\": \\\"fdbdcf8b8d674ae38154bc1e57498a91\\\",\\n                        \\\"title\\\": \\\"在线用户\\\",\\n                        \\\"pid\\\": \\\"4a57f57fc7324c94b6390f1a2dd1f49a\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/system/monitor/online-user\\\",\\n                        \\\"sort\\\": 40,\\n                        \\\"icon\\\": \\\"user\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/system/monitor/online-user\\\",\\n                        \\\"path\\\": \\\"/system/monitor/online-user\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"在线用户\\\",\\n                            \\\"icon\\\": \\\"user\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/system/monitor/online-user\\\"\\n                        }\\n                    }\\n                ]\\n            },\\n            {\\n                \\\"icon\\\": \\\"component\\\",\\n                \\\"isShow\\\": 1,\\n                \\\"component\\\": \\\"Layout\\\",\\n                \\\"redirect\\\": \\\"/ssssss\\\",\\n                \\\"children\\\": [\\n                    {\\n                        \\\"id\\\": \\\"ce0762348d35495887b27774967a150f\\\",\\n                        \\\"title\\\": \\\"测试图标\\\",\\n                        \\\"pid\\\": \\\"0\\\",\\n                        \\\"isShow\\\": 1,\\n                        \\\"url\\\": \\\"/ssssss\\\",\\n                        \\\"sort\\\": 50,\\n                        \\\"icon\\\": \\\"component\\\",\\n                        \\\"keepAlive\\\": 0,\\n                        \\\"componentName\\\": \\\"\\\",\\n                        \\\"openMode\\\": \\\"0\\\",\\n                        \\\"component\\\": \\\"/ssssss\\\",\\n                        \\\"path\\\": \\\"/ssssss\\\",\\n                        \\\"meta\\\": {\\n                            \\\"title\\\": \\\"测试图标\\\",\\n                            \\\"icon\\\": \\\"component\\\",\\n                            \\\"keepAlive\\\": false,\\n                            \\\"openMode\\\": \\\"0\\\",\\n                            \\\"path\\\": \\\"/ssssss\\\"\\n                        }\\n                    }\\n                ]\\n            }\\n        ]\\n    },\\n    \\\"timestamp\\\": 1709626583089,\\n    \\\"executeTime\\\": 48\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"id\",\n          \"value\" : \"b1851d1b13594e71840103c11a37a669\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"title\",\n          \"value\" : \"系统设置\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"pid\",\n          \"value\" : \"0\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"isShow\",\n          \"value\" : \"1\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Integer\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"url\",\n          \"value\" : \"/system\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"sort\",\n          \"value\" : \"10\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Integer\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"icon\",\n          \"value\" : \"settings\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"keepAlive\",\n          \"value\" : \"0\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Integer\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"componentName\",\n          \"value\" : \"null\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"openMode\",\n          \"value\" : \"0\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"component\",\n          \"value\" : \"Layout\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"path\",\n          \"value\" : \"/system\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"meta\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"title\",\n            \"value\" : \"系统设置\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"icon\",\n            \"value\" : \"settings\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"keepAlive\",\n            \"value\" : \"false\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Boolean\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        }, {\n          \"name\" : \"redirect\",\n          \"value\" : \"noRedirect\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"String\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"alwaysShow\",\n          \"value\" : \"true\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Boolean\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ ]\n        }, {\n          \"name\" : \"children\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Array\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"\",\n            \"value\" : \"\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"Object\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ {\n              \"name\" : \"id\",\n              \"value\" : \"39be13ef6f0745568c80bf35202ddb2b\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"title\",\n              \"value\" : \"菜单管理\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"pid\",\n              \"value\" : \"b1851d1b13594e71840103c11a37a669\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"isShow\",\n              \"value\" : \"1\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"Integer\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"url\",\n              \"value\" : \"/system/menu/menu-list\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"sort\",\n              \"value\" : \"10\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"Integer\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"icon\",\n              \"value\" : \"menu\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"keepAlive\",\n              \"value\" : \"1\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"Integer\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"componentName\",\n              \"value\" : \"null\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"Object\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"openMode\",\n              \"value\" : \"0\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"component\",\n              \"value\" : \"/system/menu/menu-list\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"path\",\n              \"value\" : \"/system/menu/menu-list\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"String\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ ]\n            }, {\n              \"name\" : \"meta\",\n              \"value\" : \"\",\n              \"description\" : \"\",\n              \"required\" : false,\n              \"dataType\" : \"Object\",\n              \"type\" : null,\n              \"defaultValue\" : null,\n              \"validateType\" : \"\",\n              \"error\" : \"\",\n              \"expression\" : \"\",\n              \"children\" : [ {\n                \"name\" : \"title\",\n                \"value\" : \"菜单管理\",\n                \"description\" : \"\",\n                \"required\" : false,\n                \"dataType\" : \"String\",\n                \"type\" : null,\n                \"defaultValue\" : null,\n                \"validateType\" : \"\",\n                \"error\" : \"\",\n                \"expression\" : \"\",\n                \"children\" : [ ]\n              }, {\n                \"name\" : \"icon\",\n                \"value\" : \"menu\",\n                \"description\" : \"\",\n                \"required\" : false,\n                \"dataType\" : \"String\",\n                \"type\" : null,\n                \"defaultValue\" : null,\n                \"validateType\" : \"\",\n                \"error\" : \"\",\n                \"expression\" : \"\",\n                \"children\" : [ ]\n              }, {\n                \"name\" : \"keepAlive\",\n                \"value\" : \"true\",\n                \"description\" : \"\",\n                \"required\" : false,\n                \"dataType\" : \"Boolean\",\n                \"type\" : null,\n                \"defaultValue\" : null,\n                \"validateType\" : \"\",\n                \"error\" : \"\",\n                \"expression\" : \"\",\n                \"children\" : [ ]\n              } ]\n            } ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1657368503505\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"18\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar userId = StpUtil.getLoginId()\n\n// 查出所有隐藏或者打开方式为“页签”和“iframe”的菜单（排除http地址和静态页面）\nvar notLayoutMenus = db.select(\"\"\"\n    select * from (\n        select\n            sm.open_mode,\n            sdc.name as component_name,\n            sm.name,\n            sm.url as path,\n            -- 查询下级是否还有菜单（不包含按钮权限）\n            (\n                select count(1) from sys_menu where is_del = 0 and is_show = 1 and pid = sm.id and \n                ((component_id is not null and component_id != \'\') or (url is not null and url != \'\'))\n            ) sub_count,\n            sm.keep_alive\n        from sys_menu sm left join sys_dynamic_component sdc on sdc.id = sm.component_id\n        where sm.is_del = 0 and ((sm.component_id is not null and sm.component_id != \'\') or (\n            sm.url is not null and sm.url != \'\'\n            -- 排除不需要加载路由的菜单\n            and sm.url not like \'http%\'\n            and sm.url not like \'%.htm\'\n            and sm.url not like \'%.html\'\n        ))\n        and \n        (\n            -- 查出来隐藏的需要加载的路由\n            sm.is_show = 0\n            or\n            -- 新标签页和iframe\n            sm.open_mode in (\'1\', \'2\')  \n        )\n        ?{userId != \'1\',\n            and sm.id in (\n                select menu_id from sys_role_menu where role_id in (\n                    select role_id from sys_user_role where user_id = #{userId}\n                )\n            )\n        } \n    ) smm where sub_count = 0\n\"\"\")\n\n// 查出所有显示的菜单\nvar menus = db.select(\"\"\"\n    select\n        sm.id,\n        sm.name title,\n        sm.pid,\n        sm.is_show,\n        sm.url,\n        sm.sort,\n        sm.icon,\n        sm.keep_alive,\n        sdc.name as component_name,\n        sm.open_mode\n    from sys_menu sm left join sys_dynamic_component sdc on sdc.id = sm.component_id\n    where 1=1\n    ?{userId != \'1\',\n        and sm.id in (\n            select menu_id from sys_role_menu where role_id in (\n                select role_id from sys_user_role where user_id = #{userId}\n            )\n        )\n    } and sm.is_del = \'0\' and sm.is_show = 1 order by sm.sort\n\"\"\")\n\nfor(menu in menus){\n    menu.component = (menu.url || \"Layout\");\n    menu.path = (menu.component == \'Layout\' ? \"/\" : menu.component);\n    menu.meta = {}\n    menu.meta.componentName = menu.componentName\n    menu.meta.title = menu.title\n    menu.meta.icon = menu.icon\n    menu.meta.keepAlive = (menu.keepAlive == \'1\' ? true : false)\n    menu.meta.openMode = menu.openMode\n    menu.meta.path = menu.path\n}\nvar nodes = menus.toMap(it => it.id)\nnodes.each((key, node) => {\n    if (nodes.containsKey(node.pid)) {\n        nodes[node.pid].redirect = \"noRedirect\";\n        nodes[node.pid].component = \"Layout\";\n        nodes[node.pid].alwaysShow = true;\n        if(!nodes[node.pid].children){\n            nodes[node.pid].children = []\n        }\n        nodes[node.pid].children.push(node)\n    }\n})\nvar layoutMenus = []\nnodes.each((key, node) => {\n    if(node.pid == \'0\'){\n        if(node.component != \'Layout\'){\n            node = {\n                icon: node.icon,\n                isShow: 1,\n                component: \'Layout\',\n                redirect: node.path,\n                children: [node]\n            }\n        }\n        layoutMenus.push(node)\n    }\n})\n\nreturn {\n    notLayoutMenus,\n    layoutMenus\n}\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/根据菜单id清除缓存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"96336e6177d143c1a2259685f71cd615\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"根据菜单id清除缓存\",\n  \"createTime\" : 1719394266939,\n  \"updateTime\" : 1646493562232,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/cache/delete\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\nvar userIds = db.select(\"\"\"\n    select user_id from sys_user_role where role_id in (\n        select role_id from sys_role_menu where menu_id = #{menuId}\n    ) and user_id is not null\n\"\"\")\nfor(item in userIds){\n    SqlCache.delete(`permissions:${item.userId}`)\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/根据角色获取菜单.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9f4ebd1f444341c593a3d2a79d1a3356\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"根据角色获取菜单\",\n  \"createTime\" : 1719394266944,\n  \"updateTime\" : 1646552458043,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/by/role\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"roleId\",\n    \"value\" : \"4d80f40315f747768d5b14095a0a7336\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": [\\\"b1851d1b13594e71840103c11a37a669\\\", \\\"39be13ef6f0745568c80bf35202ddb2b\\\", \\\"414e5d31-fe05-4e69-9983-217c10b9740a\\\", \\\"d7e5280a2a8f4fb3b9e2f4a3e3093a38\\\", \\\"833b204d5f2c402190bfca677421cfeb\\\"],\\n    \\\"timestamp\\\": 1642080903333,\\n    \\\"executeTime\\\": 4\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Array\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"\",\n        \"value\" : \"b1851d1b13594e71840103c11a37a669\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Object\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1642080903333\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"4\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select menu_id id from sys_role_menu where role_id = #{roleId}\n\"\"\").map(it => it.id)');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/获取排序号.ms', '{\n  \"properties\" : { },\n  \"id\" : \"4f966df34dbe41ff8b9941da4671eb2d\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"获取排序号\",\n  \"createTime\" : 1719394266949,\n  \"updateTime\" : 1641732167291,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/sort\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectInt(\"\"\"\n    select max(sort) + 10 from sys_menu where pid = #{pid} and is_del = \'0\'\n\"\"\") || 10;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/菜单管理/获取菜单tree.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ffb6988226d14e6789cc30193e008183\",\n  \"script\" : null,\n  \"groupId\" : \"67b2ce258e24491194b74992958c74aa\",\n  \"name\" : \"获取菜单tree\",\n  \"createTime\" : 1719394266952,\n  \"updateTime\" : 1709801228981,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/tree\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"menu:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1709773777522,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634309660370\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nvar toTree = (list,pid) => select t.*,toTree(list,t.id) children from list t where t.pid = pid\nvar list = toTree(db.select(\"\"\"\n    select \n        sm.id,\n        sm.name,\n        sm.pid,\n        sm.is_show, \n        sm.url,\n        sm.sort,\n        sm.permission,\n        sm.desc_ribe,\n        sm.icon,\n        sm.keep_alive,\n        sdc.name component_name,\n        sm.component_id,\n        sm.open_mode \n    from sys_menu sm left join sys_dynamic_component sdc on sm.component_id = sdc.id\n    where sm.is_del = 0 order by sm.sort\n\"\"\"),\'0\')\n\nreturn {\n    list: list,\n    total: list.getLength()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"角色管理\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/role\",\n  \"createTime\" : 1719394266367,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f9a5956afdfd4492966b1a3c04dbadf6\",\n  \"script\" : null,\n  \"groupId\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266957,\n  \"updateTime\" : 1665500810912,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : \"guyi\",\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"role:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'@get:/system/role/cache/delete\' as cacheDelete\n\nvar codeCount = db.selectInt(\"select count(1) from sys_role where is_del = 0 and code = #{code} ?{id, and id != #{id}}\")\nif(codeCount > 0){\n    exit 0,\'角色编码已存在\'\n}\n\nvar role = {\n    code,\n    permission,\n    descRibe,\n    type,\n    name,\n    sort,\n    id\n}\nif(id){\n    db.table(\"sys_role_menu\").where().eq(\"role_id\",id).delete()\n}\nid = db.table(\"sys_role\").primary(\"id\").saveOrUpdate(role);\nfor(menuId in menus.split(\',\')){\n    db.table(\"sys_role_menu\").column(\"menu_id\",menuId).column(\"role_id\", id).insert();\n}\ndb.table(\"sys_role_office\").where().eq(\"role_id\",id).delete()\nif(offices && permission == 1){\n    for(officeId in offices.split(\',\')){\n        db.table(\"sys_role_office\").column(\"office_id\",officeId).column(\"role_id\", id).insert();\n    }\n}\nif(id){\n    // 先删除数据库 后删除缓存 不然拦截器会请求查询数据库 查到的还是老数据\n    var roleId = id\n    cacheDelete()\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/全部.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9fe8956f3e79479c825e50dc314bb9bd\",\n  \"script\" : null,\n  \"groupId\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"全部\",\n  \"createTime\" : 1719394266961,\n  \"updateTime\" : 1646555166829,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/all\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.select(\"\"\"\n    select name label, id value from sys_role where is_del = 0\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9a204a5c8a8243f7b07e842f87d4d65b\",\n  \"script\" : null,\n  \"groupId\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266964,\n  \"updateTime\" : 1646552461206,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"role:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": {\\n        \\\"total\\\": 1,\\n        \\\"list\\\": [\\n            {\\n                \\\"id\\\": \\\"1\\\",\\n                \\\"name\\\": \\\"管理员\\\"\\n            }\\n        ]\\n    },\\n    \\\"timestamp\\\": 1634309991187,\\n    \\\"executeTime\\\": 5\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ {\n        \"name\" : \"total\",\n        \"value\" : \"1\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Integer\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ ]\n      }, {\n        \"name\" : \"list\",\n        \"value\" : \"\",\n        \"description\" : \"\",\n        \"required\" : false,\n        \"dataType\" : \"Array\",\n        \"type\" : null,\n        \"defaultValue\" : null,\n        \"validateType\" : \"\",\n        \"error\" : \"\",\n        \"expression\" : \"\",\n        \"children\" : [ {\n          \"name\" : \"\",\n          \"value\" : \"\",\n          \"description\" : \"\",\n          \"required\" : false,\n          \"dataType\" : \"Object\",\n          \"type\" : null,\n          \"defaultValue\" : null,\n          \"validateType\" : \"\",\n          \"error\" : \"\",\n          \"expression\" : \"\",\n          \"children\" : [ {\n            \"name\" : \"id\",\n            \"value\" : \"1\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          }, {\n            \"name\" : \"name\",\n            \"value\" : \"管理员\",\n            \"description\" : \"\",\n            \"required\" : false,\n            \"dataType\" : \"String\",\n            \"type\" : null,\n            \"defaultValue\" : null,\n            \"validateType\" : \"\",\n            \"error\" : \"\",\n            \"expression\" : \"\",\n            \"children\" : [ ]\n          } ]\n        } ]\n      } ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1634309991187\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"5\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id, name, code, permission, desc_ribe from sys_role where is_del = 0\n    ?{name, and name like concat(\'%\',#{name},\'%\')}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"633b78b93bba43fba785c71c1c18d7f7\",\n  \"script\" : null,\n  \"groupId\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266968,\n  \"updateTime\" : 1665500606275,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : \"guyi\",\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"role:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"{\\n\\n}\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ ]\n  },\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport \'@get:/system/role/cache/delete\' as cacheDelete\n\nvar userCount = db.selectInt(\"select count(1) from sys_user_role where role_id = #{id}\")\nif(userCount > 0){\n    exit 500, \'角色已分配,不允许删除\'\n}\n\ndb.table(\"sys_role_menu\").where().eq(\"role_id\",id).delete()\nvar result = db.table(\"sys_role\").logic().where().eq(\"id\",id).delete();\n\nvar roleId = id\ncacheDelete()\nreturn result');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/角色管理/根据角色id删除缓存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"598efb2903ec4e0491fa99e8df0222f9\",\n  \"script\" : null,\n  \"groupId\" : \"89130d496f6f467c88b22ae4a7f688eb\",\n  \"name\" : \"根据角色id删除缓存\",\n  \"createTime\" : 1719394266972,\n  \"updateTime\" : 1646493560974,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/cache/delete\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\nvar userIds = db.select(\"\"\"\n    select user_id from sys_user_role where role_id = #{roleId} and user_id is not null\n\"\"\")\nfor(item in userIds){\n    SqlCache.delete(`permissions:${item.userId}`)\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"5c36bdc1de454d6e9d1a464d87c96091\",\n  \"name\" : \"配置\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/config\",\n  \"createTime\" : 1719394266372,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置/获取所有配置.ms', '{\n  \"properties\" : { },\n  \"id\" : \"cd127e22d1de486780316887a73996f0\",\n  \"script\" : null,\n  \"groupId\" : \"5c36bdc1de454d6e9d1a464d87c96091\",\n  \"name\" : \"获取所有配置\",\n  \"createTime\" : 1719394266976,\n  \"updateTime\" : 1680319729597,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1646391479074,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1646391479074\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport env\n\nreturn {\n    ossBucket: env.get(\'oss.bucket\'),\n    bucketDomain: env.get(\'oss.bucketDomain\')\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置/获取是否开启验证码.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ae64d7727a6741f08d32fae2de687f1b\",\n  \"script\" : null,\n  \"groupId\" : \"5c36bdc1de454d6e9d1a464d87c96091\",\n  \"name\" : \"获取是否开启验证码\",\n  \"createTime\" : 1719394266981,\n  \"updateTime\" : 1680441437023,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getCodeEnable\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"require_login\",\n    \"value\" : \"false\",\n    \"description\" : \"该接口需要登录才允许访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": \\\"true\\\",\\n    \\\"timestamp\\\": 1680441407916,\\n    \\\"executeTime\\\": 29\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"true\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1680441407916\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"29\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport \'@/configure/getBykey\' as configure;\nreturn configure(\'verification-code.enable\')');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"0295f2b4af9145f5a0ea29fa4b797214\",\n  \"name\" : \"配置中心\",\n  \"type\" : \"api\",\n  \"parentId\" : \"acff5ad7aae64de2acb03e1d16a58ce2\",\n  \"path\" : \"/configure\",\n  \"createTime\" : 1719394266377,\n  \"updateTime\" : 1653097733635,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/保存.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ad9bf694f8834e50a7ef35ddb543e06d\",\n  \"script\" : null,\n  \"groupId\" : \"0295f2b4af9145f5a0ea29fa4b797214\",\n  \"name\" : \"保存\",\n  \"createTime\" : 1719394266985,\n  \"updateTime\" : 1679725946724,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/save\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ {\n    \"name\" : \"configureType\",\n    \"value\" : \"1\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureName\",\n    \"value\" : \"2\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureValue\",\n    \"value\" : \"3\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureCondition\",\n    \"value\" : \"2\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureDescRibe\",\n    \"value\" : \"24\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"remarks\",\n    \"value\" : \"12\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureKey\",\n    \"value\" : \"32323\",\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"configure:save\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"wrap_request_parameter\",\n    \"value\" : \"data\",\n    \"description\" : \"包装请求参数到一个变量中\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ {\n    \"name\" : \"token\",\n    \"value\" : \"75812f57-129d-4714-a615-571142631484\",\n    \"description\" : null,\n    \"required\" : true,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 200,\\n    \\\"message\\\": \\\"success\\\",\\n    \\\"data\\\": \\\"a500d23dd1274b4086d55a01a768caec\\\",\\n    \\\"timestamp\\\": 1653119020859,\\n    \\\"executeTime\\\": 1729\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"200\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"success\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"a500d23dd1274b4086d55a01a768caec\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1653119020859\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"1729\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nimport org.ssssssss.magicapi.modules.db.cache.SqlCache\n\nSqlCache.delete(`configure:${configureKey}${configureCondition}`)\nSqlCache.delete(`configure:${configureKey}`)\nreturn db.table(\'sys_configure\').primary(\'id\').withBlank().saveOrUpdate(data)\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"3add3a4fbc924d00911677c8edac01f7\",\n  \"script\" : null,\n  \"groupId\" : \"0295f2b4af9145f5a0ea29fa4b797214\",\n  \"name\" : \"列表\",\n  \"createTime\" : 1719394266990,\n  \"updateTime\" : 1653634268957,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/list\",\n  \"method\" : \"POST\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"configure:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : \"{\\n    \\\"code\\\": 402,\\n    \\\"message\\\": \\\"凭证已过期\\\",\\n    \\\"data\\\": null,\\n    \\\"timestamp\\\": 1653102795972,\\n    \\\"executeTime\\\": null\\n}\",\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : {\n    \"name\" : \"\",\n    \"value\" : \"\",\n    \"description\" : \"\",\n    \"required\" : false,\n    \"dataType\" : \"Object\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : \"\",\n    \"error\" : \"\",\n    \"expression\" : \"\",\n    \"children\" : [ {\n      \"name\" : \"code\",\n      \"value\" : \"402\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Integer\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"message\",\n      \"value\" : \"凭证已过期\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"String\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"data\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"timestamp\",\n      \"value\" : \"1653102795972\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Long\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    }, {\n      \"name\" : \"executeTime\",\n      \"value\" : \"null\",\n      \"description\" : \"\",\n      \"required\" : false,\n      \"dataType\" : \"Object\",\n      \"type\" : null,\n      \"defaultValue\" : null,\n      \"validateType\" : \"\",\n      \"error\" : \"\",\n      \"expression\" : \"\",\n      \"children\" : [ ]\n    } ]\n  }\n}\r\n================================\r\nreturn db.page(\"\"\"\n    select id,configure_condition,configure_key,configure_value,configure_name,configure_type,configure_desc_ribe,remarks,create_date from sys_configure\n    where is_del = 0\n    ?{configureCondition, and configure_condition like concat(\'%\',#{configureCondition},\'%\')}\n    ?{configureKey, and configure_key like concat(\'%\',#{configureKey},\'%\')}\n    ?{configureValue, and configure_value like concat(\'%\',#{configureValue},\'%\')}\n    order by create_date desc\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/删除.ms', '{\n  \"properties\" : { },\n  \"id\" : \"368c6debc18342c6abb46e795336d573\",\n  \"script\" : null,\n  \"groupId\" : \"0295f2b4af9145f5a0ea29fa4b797214\",\n  \"name\" : \"删除\",\n  \"createTime\" : 1719394266993,\n  \"updateTime\" : 1653129244605,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/delete\",\n  \"method\" : \"DELETE\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"configure:delete\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.table(\'sys_configure\').logic().where().eq(\'id\', id).delete()');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/api/系统管理/配置中心/详情.ms', '{\n  \"properties\" : { },\n  \"id\" : \"4b6d4d2d5b8c4292a41b2404fab70640\",\n  \"script\" : null,\n  \"groupId\" : \"0295f2b4af9145f5a0ea29fa4b797214\",\n  \"name\" : \"详情\",\n  \"createTime\" : 1719394266995,\n  \"updateTime\" : 1653129248115,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/get\",\n  \"method\" : \"GET\",\n  \"parameters\" : [ ],\n  \"options\" : [ {\n    \"name\" : \"permission\",\n    \"value\" : \"configure:view\",\n    \"description\" : \"允许拥有该权限的访问\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ],\n  \"requestBody\" : \"\",\n  \"headers\" : [ ],\n  \"paths\" : [ ],\n  \"responseBody\" : null,\n  \"description\" : null,\n  \"requestBodyDefinition\" : null,\n  \"responseBodyDefinition\" : null\n}\r\n================================\r\nreturn db.selectOne(\"\"\"\n     select id,configure_condition,configure_key,configure_value,configure_name,configure_type,configure_desc_ribe,remarks,create_date from sys_configure where id = #{id}\n\"\"\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/datasource/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/任务/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/任务/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"07213facdab54280b6ba7b4637732337\",\n  \"name\" : \"任务\",\n  \"type\" : \"function\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/task\",\n  \"createTime\" : 1719394266382,\n  \"updateTime\" : 1713024590379,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/任务/保存任务正文内容.ms', '{\n  \"properties\" : { },\n  \"id\" : \"50aa4204a27c40198e30d90a1dc96956\",\n  \"script\" : null,\n  \"groupId\" : \"07213facdab54280b6ba7b4637732337\",\n  \"name\" : \"保存任务正文内容\",\n  \"createTime\" : 1719394266997,\n  \"updateTime\" : 1713227092348,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/saveContent\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"content\",\n    \"value\" : null,\n    \"description\" : \"内容\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"type\",\n    \"value\" : null,\n    \"description\" : \"操作类型  add-添加 update 更新 \",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport log\nimport \'cn.hutool.http.HtmlUtil\';\nimport \'cn.hutool.core.util.ReUtil\';\nimport \'org.ssssssss.magicboot.utils.MinioUtil\';\nimport \'org.ssssssss.magicboot.utils.FileUtils\';\nimport cn.hutool.core.util.StrUtil;\n\nlog.info(\"获取的content value is \" + content)\nlog.info(\"获取的type value is \" + type)\n//先处理\n\nlet textWithoutHtml = HtmlUtil.cleanHtmlTag(content);\nlog.info(textWithoutHtml)\n\n\n// path = \"uploads/task/content/\" + now() + \"/\" + taskId + \"/\"; //基础的地址，修改成按月份\nregex = \"<img\\\\s+src=\\\"data:image/(png|jpg|jpeg|webp);base64,(.*?)\\\"\";\n\nlet allList = []\nReUtil.findAll(regex, content, 0, allList) //全部\nfor (item in allList) {\n    log.info(\"allList -->\" + item)\n}\n\nlet group1List = []\nReUtil.findAll(regex, content, 1, group1List) //类型\nfor (item in group1List) {\n    log.info(\"group1List -->\" + item)\n}\n\nlet group2List = []\nReUtil.findAll(regex, content, 2, group2List) //base64\nlog.info(\"group2List size  -->\" + group2List.size())\n\nfor (index, item in group2List) {\n    log.info(\"group2List -->\" + item)\n    var url = MinioUtil.uploadBase64(item)\n    log.info(\"保存图片到minio中\" + url)\n    prewUrl = MinioUtil.preview(url)\n    log.info(\"图片真实地址:\" + prewUrl)\n    preview = StrUtil.replaceChars(prewUrl,\"task-minio\",\"82.157.62.190\")\n    log.info(\"处理后的图片真实地址:\" + prewUrl)\n  \n\n    // let imgInfo = FileUtils.getImageSize(\'https://s2.51cto.com/blog/activity/bride/DetailsBride.gif?x-oss-process=image/ignore-error,1\')\n    var imgInfo = FileUtils.getImageSize(prewUrl)\n    //组装url\n    lastUrl = \'<img src=\"\' + prewUrl + \'\" original-width=\"\' + imgInfo[0] + \'\" original-height=\"\' + imgInfo[1] + \'\"\'\n    log.info(\"lastUrl-->\" + lastUrl)\n    content = content.replace(allList[index], lastUrl)\n}\n\n\n//这里不需要进行替换操作了，直接展示吧\n//TODO minio保存文件的方法\ntextUrl = MinioUtil.uploadTxt(content)\nlog.info(\"textUrl\" + textUrl)\n// resultUrl = MinioUtil.preview(textUrl) //TODO URL这里不处理了。直接按资源名，这样子才能取得\nresultUrl = textUrl\nlog.info(\"resultUrl Url\"+resultUrl)\n\n// var result = db.table(\'project_task_contents\').primary(\'project_id\').primary(\'task_id\').update({\n//     project_id: project_id,\n//     task_id: task_id,\n//     content: contentValue::json //  这里存json\n// })\n// log.info(\"insert ->result:\", result)\n\nreturn resultUrl\n\n//TODO 文件存储操作\n\n// $path = \'uploads/task/content/\' . date(\"Ym\") . \'/\' . $task_id . \'/\';\n//     //\n//     preg_match_all(\"/<img\\s+src=\\\"data:image\\/(png|jpg|jpeg|webp);base64,(.*?)\\\"/s\", $content, $matchs);\n//     foreach ($matchs[2] as $key => $text) {\n//         $tmpPath = $path . \'attached/\';\n//         Base::makeDir(public_path($tmpPath));\n//         $tmpPath .= md5($text) . \".\" . $matchs[1][$key];\n//         if (Base::saveContentImage(public_path($tmpPath), base64_decode($text))) {\n//             $paramet = getimagesize(public_path($tmpPath));\n//             $content = str_replace($matchs[0][$key], \'<img src=\"{{RemoteURL}}\' . $tmpPath . \'\" original-width=\"\' . $paramet[0] . \'\" original-height=\"\' . $paramet[1] . \'\"\', $content);\n//         }\n//     }\n//     $pattern = \'/<img(.*?)src=(\"|\\\')https*:\\/\\/(.*?)\\/(uploads\\/task\\/content\\/(.*?))\\2/is\';\n//     $content = preg_replace($pattern, \'<img$1src=$2{{RemoteURL}}$4$2\', $content);\n//     //\n//     $filePath = $path . md5($content);\n//     $publicPath = public_path($filePath);\n//     Base::makeDir(dirname($publicPath));\n//     file_put_contents($publicPath, $content);\n//     //\n//     return $filePath;\n\n// log.info(\'content ->\' + body.content);\n// log.info(\'contentValue ->\' + contentValue);\n// var result = db.table(\'project_task_contents\').insert({\n//     project_id: useTask.project_id,\n//     task_id: useTask.task_id,\n//     content: contentValue\n// })\n// log.info(\"插入详细描述\", result)\n// var logDetail = \'修改任务详细描述\'\n// var project_log = db.table(\'project_logs\').insert({\n//     project_id: useTask.project_id,\n//     column_id: 0,\n//     task_id: useTask.task_id,\n//     userid: userid,\n//     detail: logDetail\n// })\n// log.info(\"插入详细描述日志\", project_log)\n\n\n//TODO $updateMarking[\'is_update_content\'] = true;\n// //处理详情描述\n// var contentValue = {}\n\n// contentValue.url = \'\'\n// var contentId = db.table(\'project_task_contents\').primary(\'project_id\').primary(\'task_id\').update({\n//     project_id: project_id,\n//     task_id: task_id,\n//     content: contentValue::json //  这里存json\n// })\n\n\n// return \"调用保存内容正文正确\"');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/任务/归档或还原任务-未完成.ms', '{\n  \"properties\" : { },\n  \"id\" : \"05a6cfb2c0de4d2082834597ca8d86bd\",\n  \"script\" : null,\n  \"groupId\" : \"07213facdab54280b6ba7b4637732337\",\n  \"name\" : \"归档或还原任务-未完成\",\n  \"createTime\" : 1719394267002,\n  \"updateTime\" : 1713024595276,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/archivedTask\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"archived_at\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nvar userid = StpUtil.getLoginId()\nimport \'@/project/log\' as log\n//TODO 判断权限部分\n\n// primary(\"id\").primary\n\nvar val = db.transaction(() => {\n    if (archived_at == null) {\n        db.table(\"project_tasks\").where().eq(\"project_id\", project_id).eq(\"id\", task_id).update({\n            archived_at: null,\n            archived_follow: 0,\n        })\n        log(\'任务取消归档\')\n    } else {\n        //任务归档\n        db.table(\"project_tasks\").where().eq(\"project_id\", project_id).eq(\"id\", task_id).update({\n            archived_at: archived_at,\n            archived_follow: 1,\n        })\n        log(\'任务归档\')\n        //推送归档的通知\n    }\n    db.table(\"projects\").primary(\"id\").update({\n        id: project_id,\n        archived_at: archived_at,\n        archived_userid: userid\n    })\n\n});');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/任务/添加任务日志-未完成.ms', '{\n  \"properties\" : { },\n  \"id\" : \"7a537422c5e54c02a7dcd651f37028b2\",\n  \"script\" : null,\n  \"groupId\" : \"07213facdab54280b6ba7b4637732337\",\n  \"name\" : \"添加任务日志-未完成\",\n  \"createTime\" : 1719394267004,\n  \"updateTime\" : 1713024595362,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/log\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log\n\nvar userid = StpUtil.getLoginId()\nlog.info(\'userid is \' + userid)\n\nif (userid == null) {\n    log.info(\'userid is null\')\n    exit 400, \'用户未登录\'\n}\nlog.info(\'logDetail value：\' + logDetail)\n\nvar result = db.table(\'project_logs\').insert({\n    project_id: project_id,\n    column_id: 0,\n    task_id: 0,\n    userid: userid,\n    detail: logDetail\n})\n\nlog.info(\'日志插入\' + result)\nreturn result');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"文件\",\n  \"type\" : \"function\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/file\",\n  \"createTime\" : 1719394266387,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/上传知识库.ms', '{\n  \"properties\" : { },\n  \"id\" : \"b185b1f67d9840149dee60d17cfa2fcd\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"上传知识库\",\n  \"createTime\" : 1719394267006,\n  \"updateTime\" : 1720519044521,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/uploadkb\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"fileUrl\",\n    \"value\" : null,\n    \"description\" : \"文件url\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport log\nimport http\nimport cn.hutool.http.HttpRequest;\nimport cn.hutool.http.HttpResponse;\nimport org.ssssssss.magicboot.utils.MinioUtil\nimport cn.hutool.core.io.FileUtil;\nimport cn.hutool.http.HttpUtil;\nimport cn.hutool.core.io.IoUtil;\n\nvar know = db.table(\"settings\").where().eq(\"name\", \"know\").selectOne();\nif (know === null) {\n    log.info(\"知识库未配置\")\n    return \"知识库未配置\"\n} else {\n    if (know != null && know.setting) {\n        var result = know.setting::json\n        if (result.auto_upload != \"open\") {\n            return \"自动上传未开启\"\n        }\n        var apiUrl = result.linkUrl\n        var user = result.user\n        var pwd = result.pwd\n        var dataSetId = result.appid\n\n         log.info(\"result-->\" + result)\n         log.info(\"user-->\" + user)\n         log.info(\"pwd-->\" + pwd)\n        if (apiUrl != null && user != null && pwd != null && dataSetId != null) {\n            //执行登录\n            var responseEntity = http.connect(apiUrl + \'/api/user/login\').contentType(\'application/json\').body({\n                username: user,\n                password: pwd,\n            }).post().getBody();\n            log.info(\"获取登录返回：\" + responseEntity)\n            if (responseEntity.code == 200) {\n                log.info(\"登录成功\")\n                var token = responseEntity.data;\n                log.info(\"token-->\" + token)\n                var firstIndex = fileUrl.indexOf(\".\")\n                var prefix = fileUrl.substring(0, firstIndex)\n                var suffix = fileUrl.substring(firstIndex, fileUrl.length())\n                log.info(\"prefix-->\" + prefix)\n                log.info(\"suffix-->\" + suffix)\n\n                File tempFile = FileUtil.createTempFile(prefix, suffix, FileUtil.getTmpDir());\n                FileUtil.writeBytes(MinioUtil.download(fileUrl), tempFile);\n                log.info(\"临时文件已创建: \" + tempFile.getAbsolutePath());\n                var url = apiUrl + \"/api/dataset/document/split\";\n                HttpRequest request = HttpRequest.post(url);\n                request.form(\"file\", tempFile);\n                request.header(\"Authorization\", token);\n                HttpResponse execute = request.execute();\n                boolean ok = execute.isOk();\n                String body = execute.body();\n                log.info(\"request execute.body-->\" + body)\n                var result = body::json.data\n                String name = result[0].name;\n                var content = result[0].content;\n                log.info(\"request execute.body content-->\" + content)\n                //TODO 单文件自动上传只是取[0]是否正确\n                //正式导入\n                //处理数据\n                var bodyData = [];\n                var par = {};\n                par.name = name;\n                par.paragraphs = content\n                bodyData.push(par)\n                var responseEntity = http.connect(apiUrl + \"/api/dataset/\" + dataSetId + \"/document/_bach\").header(\"Authorization\", token).contentType(\'application/json\').body(bodyData).post().getBody();\n                log.info(\"获取bach返回：\" + responseEntity)\n            }\n\n        }\n    }\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/保存文件(夹)之前的操作.ms', '{\n  \"properties\" : { },\n  \"id\" : \"2bf8450fa0df42b0833ea294e98b3e1d\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"保存文件(夹)之前的操作\",\n  \"createTime\" : 1719394267009,\n  \"updateTime\" : 1716604533339,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/saveBefore\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"file\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\n\r\n\r\nreturn \'Hello magic-api\'');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/处理文件重命名.ms', '{\n  \"properties\" : { },\n  \"id\" : \"2308e266c5b84ba58da6c365d5d33b63\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"处理文件重命名\",\n  \"createTime\" : 1719394267011,\n  \"updateTime\" : 1711784127593,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/handleDuplicateName\",\n  \"description\" : \"处理名称重复的情况，返回新的名称\",\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"pid\",\n    \"value\" : null,\n    \"description\" : \"父id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"userid\",\n    \"value\" : null,\n    \"description\" : \"用户id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"ext\",\n    \"value\" : null,\n    \"description\" : \"后缀\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"name\",\n    \"value\" : null,\n    \"description\" : \"文件名称\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport java.util.Random;\nimport java.util.regex.Pattern;\n\nvar nameNum = db.table(\"files\")\n    .where()\n    .isNull(\'deleted_at\')\n    .eq(\'pid\', pid)\n    .eq(\'userid\', userid)\n    .eq(\'ext\', ext)\n    .eq(\'name\', name)\n    .count();\n\nif (nameNum == 0) {\n    // 未重名，不需要处理\n    return name;\n}\n\n// 发现重名，开始自动重命名\nvar nextNum = 2;\n// 如果文件名符合 \"文件名 (数字)\" 格式，则提取文件名前缀和数字部分\nif (Pattern.matches(\"(.*?)(\\\\s+\\\\(\\\\d+\\\\))*$\", name)) {\n    // 使用正则表达式提取文件名前缀\n    String preName = name.replaceAll(\"(.*?)(\\\\s+\\\\(\\\\d+\\\\))*$\", \"$1\");\n    // 查询已存在的类似文件名的数量\n    nextNum = db.selectInt(\"\"\"select count(1) from files where name like CONCAT(#{preName},\'%\') and deleted_at is null\"\"\") + 1;\n}\n\n// 组合新的文件名\nString newName = name + \" (\" + nextNum + \")\";\n\nvar nameIsExists = db.select(\"\"\"\nSELECT EXISTS (SELECT 1 FROM files WHERE name = #{newName} and deleted_at is null) as nameIsExists;\n\"\"\");\n\n// 如果新文件名已存在，则随机生成数字直到新文件名唯一\nwhile (nameIsExists.nameIsExists == 1) {\n    nextNum = new Random().nextInt(9900) + 100; // 生成 100-9999 之间的随机数\n    newName = name + \" (\" + nextNum + \")\";\n    nameIsExists = db.select(\"\"\"\n    SELECT EXISTS (SELECT 1 FROM files WHERE name = #{newName} and deleted_at is null) as nameIsExists;\n    \"\"\");\n}\n\nreturn newName;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/根据文件后缀获取文件类型.ms', '{\n  \"properties\" : { },\n  \"id\" : \"0afbe3c925ec495689209382c321c529\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"根据文件后缀获取文件类型\",\n  \"createTime\" : 1719394267014,\n  \"updateTime\" : 1712062916634,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getFileTypeByExt\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"ext\",\n    \"value\" : null,\n    \"description\" : \"文件后缀\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nvar typeMap = {\n    \'text\': \'document\',\n    \'md\': \'document\',\n    \'markdown\': \'document\',\n    \'drawio\': \'drawio\',\n    \'mind\': \'mind\',\n    \'doc\': \'word\',\n    \'docx\': \'word\',\n    \'xls\': \'excel\',\n    \'xlsx\': \'excel\',\n    \'ppt\': \'ppt\',\n    \'pptx\': \'ppt\',\n    \'wps\': \'wps\',\n    \'jpg\': \'picture\',\n    \'jpeg\': \'picture\',\n    \'webp\': \'picture\',\n    \'png\': \'picture\',\n    \'gif\': \'picture\',\n    \'bmp\': \'picture\',\n    \'ico\': \'picture\',\n    \'raw\': \'picture\',\n    \'svg\': \'picture\',\n    \'rar\': \'archive\',\n    \'zip\': \'archive\',\n    \'jar\': \'archive\',\n    \'7-zip\': \'archive\',\n    \'tar\': \'archive\',\n    \'gzip\': \'archive\',\n    \'7z\': \'archive\',\n    \'gz\': \'archive\',\n    \'apk\': \'archive\',\n    \'dmg\': \'archive\',\n    \'tif\': \'tif\',\n    \'tiff\': \'tif\',\n    \'dwg\': \'cad\',\n    \'dxf\': \'cad\',\n    \'ofd\': \'ofd\',\n    \'pdf\': \'pdf\',\n    \'txt\': \'txt\',\n    \'htaccess\': \'code\',\n    \'htgroups\': \'code\',\n    \'htpasswd\': \'code\',\n    \'conf\': \'code\',\n    \'bat\': \'code\',\n    \'cmd\': \'code\',\n    \'cpp\': \'code\',\n    \'c\': \'code\',\n    \'cc\': \'code\',\n    \'cxx\': \'code\',\n    \'h\': \'code\',\n    \'hh\': \'code\',\n    \'hpp\': \'code\',\n    \'ino\': \'code\',\n    \'cs\': \'code\',\n    \'css\': \'code\',\n    \'dockerfile\': \'code\',\n    \'go\': \'code\',\n    \'golang\': \'code\',\n    \'html\': \'code\',\n    \'htm\': \'code\',\n    \'xhtml\': \'code\',\n    \'vue\': \'code\',\n    \'we\': \'code\',\n    \'wpy\': \'code\',\n    \'java\': \'code\',\n    \'js\': \'code\',\n    \'jsm\': \'code\',\n    \'jsx\': \'code\',\n    \'json\': \'code\',\n    \'jsp\': \'code\',\n    \'less\': \'code\',\n    \'lua\': \'code\',\n    \'makefile\': \'code\',\n    \'gnumakefile\': \'code\',\n    \'ocamlmakefile\': \'code\',\n    \'make\': \'code\',\n    \'mysql\': \'code\',\n    \'nginx\': \'code\',\n    \'ini\': \'code\',\n    \'cfg\': \'code\',\n    \'prefs\': \'code\',\n    \'m\': \'code\',\n    \'mm\': \'code\',\n    \'pl\': \'code\',\n    \'pm\': \'code\',\n    \'p6\': \'code\',\n    \'pl6\': \'code\',\n    \'pm6\': \'code\',\n    \'pgsql\': \'code\',\n    \'php\': \'code\',\n    \'inc\': \'code\',\n    \'phtml\': \'code\',\n    \'shtml\': \'code\',\n    \'php3\': \'code\',\n    \'php4\': \'code\',\n    \'php5\': \'code\',\n    \'phps\': \'code\',\n    \'phpt\': \'code\',\n    \'aw\': \'code\',\n    \'ctp\': \'code\',\n    \'module\': \'code\',\n    \'ps1\': \'code\',\n    \'py\': \'code\',\n    \'r\': \'code\',\n    \'rb\': \'code\',\n    \'ru\': \'code\',\n    \'gemspec\': \'code\',\n    \'rake\': \'code\',\n    \'guardfile\': \'code\',\n    \'rakefile\': \'code\',\n    \'gemfile\': \'code\',\n    \'rs\': \'code\',\n    \'sass\': \'code\',\n    \'scss\': \'code\',\n    \'sh\': \'code\',\n    \'bash\': \'code\',\n    \'bashrc\': \'code\',\n    \'sql\': \'code\',\n    \'sqlserver\': \'code\',\n    \'swift\': \'code\',\n    \'ts\': \'code\',\n    \'typescript\': \'code\',\n    \'str\': \'code\',\n    \'vbs\': \'code\',\n    \'vb\': \'code\',\n    \'v\': \'code\',\n    \'vh\': \'code\',\n    \'sv\': \'code\',\n    \'svh\': \'code\',\n    \'xml\': \'code\',\n    \'rdf\': \'code\',\n    \'rss\': \'code\',\n    \'wsdl\': \'code\',\n    \'xslt\': \'code\',\n    \'atom\': \'code\',\n    \'mathml\': \'code\',\n    \'mml\': \'code\',\n    \'xul\': \'code\',\n    \'xbl\': \'code\',\n    \'xaml\': \'code\',\n    \'yaml\': \'code\',\n    \'yml\': \'code\',\n    \'asp\': \'code\',\n    \'properties\': \'code\',\n    \'gitignore\': \'code\',\n    \'log\': \'code\',\n    \'bas\': \'code\',\n    \'prg\': \'code\',\n    \'python\': \'code\',\n    \'ftl\': \'code\',\n    \'aspx\': \'code\',\n    \'plist\': \'code\',\n    \'mp3\': \'media\',\n    \'wav\': \'media\',\n    \'mp4\': \'media\',\n    \'flv\': \'media\',\n    \'avi\': \'media\',\n    \'mov\': \'media\',\n    \'wmv\': \'media\',\n    \'mkv\': \'media\',\n    \'3gp\': \'media\',\n    \'rm\': \'media\',\n    \'xmind\': \'xmind\',\n    \'rp\': \'axure\',\n};\n\nvar result = typeMap.get(ext)\n\nreturn result == null ? \"\" : result;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/根据自身权限获取列表.ms', '{\n  \"properties\" : { },\n  \"id\" : \"ae703ad1ce374d38b44fe5d7826ed46b\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"根据自身权限获取列表\",\n  \"createTime\" : 1719394267019,\n  \"updateTime\" : 1718958303500,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getFileListByPermission\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"name\",\n    \"value\" : null,\n    \"description\" : \"文件名称,关键词\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Object\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"fileId\",\n    \"value\" : null,\n    \"description\" : \"文件id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"userId\",\n    \"value\" : null,\n    \"description\" : \"用户id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"pid\",\n    \"value\" : null,\n    \"description\" : \"父id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport org.ssssssss.magicboot.utils.MinioUtil;\nimport cn.hutool.core.util.ObjectUtil;\nimport cn.hutool.core.util.StrUtil;\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log;\n\n\nvar fileList = db.select(\"\"\"\nSELECT\n    f.id,\n    f.pid,\n    f.id_path,\n    f.cid,\n    f.name,\n    f.type,\n    f.ext,\n    f.size,\n    f.userid,\n    f.pshare,\n    f.share,\n    f.created_id,\n    f.created_at,\n    f.url,\n    f.updated_at,\n    f.deleted_at,\n    CASE\n        WHEN f.userid =  #{userId} OR f.created_id =  #{userId} THEN 1000\n        WHEN pu.max_permission IS NOT NULL THEN pu.max_permission\n        ELSE COALESCE((SELECT MAX(fu.permission) FROM file_users fu WHERE fu.file_id = f.pshare), 0)\n    END AS permission\nFROM\n    files f\nLEFT JOIN (\n    SELECT file_id, MAX(permission) AS max_permission\n    FROM file_users\n    GROUP BY file_id\n) pu ON f.id = pu.file_id\nWHERE\n    f.deleted_at IS NULL\n    <if test=\"fileId != null\">\n		AND f.id = #{fileId}\n	</if>\n	<if test=\"pid != null\">\n		AND f.pid = #{pid}\n	</if>\n    <if test=\"key != null and key != \'\'\">\n        AND f.name like concat(\'%\',#{key},\'%\')\n    </if>\n    AND (\n        f.userid =  #{userId}\n        OR f.created_id =  #{userId}\n        OR EXISTS (\n            SELECT 1 FROM file_users fu1 WHERE fu1.userid IN ( #{userId}, -1) AND fu1.file_id IN (SELECT f1.id FROM files f1 WHERE f1.id_path LIKE CONCAT(f.id_path, \'%\'))\n        )\n        OR (\n            f.pshare <> 0  AND EXISTS (SELECT 1 FROM file_users WHERE file_id = f.pshare AND (userid =  #{userId} OR userid = -1))\n        )\n    )\nORDER BY\n    f.created_at DESC;\n    \"\"\")\nlog.info(\"fileList-->\" + fileList)\n\n// 如果是图片，需要补充一下image_url,拼接域名部分：image_url = 域名部分+数据存的\n// 数据库存的是：/uploads/file/picture/202403/36000/d24665e11caac178d1ac6de6ab1c8564.png\n// 拼接域名部分：\"https://autoopm.com\"，不固定，通过配置文件读取\nfor (file in fileList) {\n    // 处理时间\n    file.created_at = date_format(file.created_at);\n    file.updated_at = date_format(file.updated_at);\n    file.deleted_at = date_format(file.deleted_at);\n    log.info(\"file.type---->\"+file.type)\n    // 是图片才需要拼接\n    if (StrUtil.isNotEmpty(file.url) && StrUtil.isNotEmpty(file.type) && \"picture\".equals(file.type)) {\n        file.put(\"image_url\", \'http://192.168.31.130:8087/file/preview/\' + file.id);\n        log.info(\"file.type image_url---->\"+file)\n    }\n\n}\n\nreturn fileList;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/检查复制文件名.ms', '{\n  \"properties\" : { },\n  \"id\" : \"74de858268e543a5a4deb99f8865fd87\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"检查复制文件名\",\n  \"createTime\" : 1719394267024,\n  \"updateTime\" : 1718173619053,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/checkCopy\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"file_url\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\n\n// import org.ssssssss.magicboot.utils.MinioUtil;\n// let fileName = file_url.substring(0, file_url.lastIndexOf(\'.\'));\n// let fileExtension = file_url.substring(file_url.lastIndexOf(\'.\'));\n// let counter = 1;\n\n//   let fileName = `${baseName}_copy${extension}`;  \n\n//   // 假设我们有一个函数来检查文件是否已存在（这通常是不可能的，除非你有FileSystem API权限）  \n//   // 这里我们只是模拟检查过程  \n//   function checkFileExists(fileName) {  \n//     // 这是一个模拟函数，实际情况中你需要根据具体情况来实现检查逻辑  \n//     // 例如，你可能需要发送一个请求到服务器来检查文件是否存在  \n//     // 这里我们简单地根据counter值来判断  \n//     return counter > 1; // 假设除了第一个文件外，其他都“存在”  \n//   }  \n  \n//   // 循环直到找到一个不存在的文件名  \n//   while (checkFileExists(fileName)) {  \n//     fileName = `${baseName}_copy${counter++}${extension}`;  \n//   }  \n  \n//   // 返回带有目标目录（如果需要）的完整文件名  \n//   return `${targetDir}${fileName}`;  \n\n\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/获取文件并检测权限.ms', '{\n  \"properties\" : { },\n  \"id\" : \"242dcf301d07402289536c41d9d35aee\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"获取文件并检测权限\",\n  \"createTime\" : 1719394267027,\n  \"updateTime\" : 1720519522913,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/permissionFind\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"userId\",\n    \"value\" : null,\n    \"description\" : \"用户id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"fileId\",\n    \"value\" : null,\n    \"description\" : \"文件id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"limit\",\n    \"value\" : null,\n    \"description\" : \"期望的权限\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport cn.hutool.core.util.ObjectUtil\nimport cn.hutool.core.collection.CollUtil\nimport \'@/file/getFileListByPermission\' as getFileListByPermission\nimport log;\nimport java.util.LinkedHashMap;\n\n// 先查文件是否存在\nvar num = db.table(\'files\').where().eq(\'id\', fileId).isNull(\'deleted_at\').count()\nif (num == 0) {\n    exit 400, \'文件不存在或已被删除\';\n}\n// 验证权限\nvar file = getFileListByPermission(null, fileId, userId, null);\nif (CollUtil.isEmpty(file)) {\n    exit 400, \'没有查看访问权限\';\n}\n\nlog.info(\"file\" + file)\nlog.info(\"file 0 \" + file[0])\nvar permission = file[0].permission;\nlog.info(\"file 0 permission \" + file[0].permission)\nlog.info(\" limit--> \" + limit)\nif (permission == null) {\n    exit 400, \'没有查看访问权限2\';\n}\n\nif (permission < limit) {\n    if (limit == 1000) {\n        exit 400, \'仅限所有者或创建者操作\';\n    } else if (permission == 1) {\n        exit 400, \'没有修改写入权限\';\n    } else {\n        exit 400, \'没有查看访问权限3\';\n    }\n}\nlog.info(\" limit--> \" + limit)\nif (file.size() > 0) {\n    return file[0];\n} else {\n    return null;\n}\n//返回第一个文件');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/获取用户对文件(夹)是否有访问权限.ms', '{\n  \"properties\" : { },\n  \"id\" : \"338a7d440b4946a9805a5cd45b60ae71\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"获取用户对文件(夹)是否有访问权限\",\n  \"createTime\" : 1719394267031,\n  \"updateTime\" : 1711251238001,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getPermission\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"fileId\",\n    \"value\" : null,\n    \"description\" : \"文件id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"userId\",\n    \"value\" : null,\n    \"description\" : \"用户id\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Number\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nvar permission = db.selectValue(\"\"\"\nSELECT\nCASE\n		\n	WHEN\n		( f.userid = #{userId} OR f.created_id =  #{userId} ) THEN\n			1000 ELSE COALESCE ( MAX( fu.permission ), 0 ) \n			END AS permission \n	FROM\n		files f\n		LEFT JOIN file_users fu ON f.id = fu.file_id \n		AND fu.userid IN (  #{userId}, - 1 ) \n	WHERE\n		((\n				f.userid =  #{userId} \n				OR f.created_id =  #{userId}\n				) \n			OR EXISTS (\n			SELECT\n				1 \n			FROM\n				file_users fu1 \n			WHERE\n				fu1.userid IN (  #{userId}, - 1 ) \n				AND fu1.file_id IN ( SELECT f1.id FROM files f1 WHERE f1.id_path LIKE CONCAT( f.id_path, \'%\' ) ) \n			) \n		) \n		AND f.deleted_at IS NULL \n		AND f.id = #{fileId} \n	GROUP BY\n		f.id \n\"\"\")\n\n\nreturn permission;');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/文件/设置或者关闭共享(同时遍历取消里面的共享).ms', '{\n  \"properties\" : { },\n  \"id\" : \"b8dece243258482c948712201c860e08\",\n  \"script\" : null,\n  \"groupId\" : \"89c986b52b04478a95630c451428ab00\",\n  \"name\" : \"设置或者关闭共享(同时遍历取消里面的共享)\",\n  \"createTime\" : 1719394267034,\n  \"updateTime\" : 1711796466266,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/updataShare\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"file\",\n    \"value\" : null,\n    \"description\" : \"文件实体\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.util.Map\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\n  import log;\n  // 如果没有共享用户，则设置共享状态为0；否则设置为1（共享）\n  var share = db.table(\'file_users\').where().eq(\'file_id\', id).count() == 0 ? 0 : 1;\n  // 检查当前文件的共享状态是否需要更新\n  if (share != file.share) {\n      // 更新当前文件的共享状态\n      db.table(\'files\').primary(\'id\').update({\n          id: id,\n          share: share\n      })\n      // 如果文件被共享，设置pshare为当前文件ID，否则设置为0\n      var pshareValue = share == 1 ? file.id : 0;\n      log.info(\"file=\",file);\n      db.update(\"\"\"\n                update files \n                set share = 0,pshare = #{pshareValue} \n                where id_path LIKE CONCAT(#{file.id_path}, \'%\') and deleted_at is null and id <> #{file.id}\n            \"\"\")\n\n      // 如果文件的共享状态被设置为0（非共享），则删除所有相关的共享用户记录\n      if (share == 0) {\n          // 删除指定共享成员\n          db.table(\'file_users\')\n              .where()\n              .eq(\'file_id\', file.id)\n              .delete();\n          // 同时删除成员分享的链接\n          db.table(\'file_links\')\n              .where()\n              .eq(\'file_id\', file.id)\n              .delete();\n      }\n\n  }\n  return \'Hello magic-api\'');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/权限/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/权限/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"41922e26ef57421f8819fe6c59f14d63\",\n  \"name\" : \"权限\",\n  \"type\" : \"function\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/permission\",\n  \"createTime\" : 1719394266391,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/权限/组织机构.ms', '{\n  \"properties\" : { },\n  \"id\" : \"a5f80b11b7fb4f3c97252331c80bcf85\",\n  \"script\" : null,\n  \"groupId\" : \"41922e26ef57421f8819fe6c59f14d63\",\n  \"name\" : \"组织机构\",\n  \"createTime\" : 1719394267037,\n  \"updateTime\" : 1642327198030,\n  \"lock\" : \"0\",\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/office\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : \"/permission/office\",\n  \"parameters\" : [ ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar currentUserId = StpUtil.getLoginId()\n//查出当前用户有多少角色\nvar roles = db.select(\"\"\"\n    select permission from sys_role where is_del = 0 and id in (select role_id from sys_user_role where user_id = #{currentUserId})\n\"\"\")\nvar userIds = []\nfor(role in roles){\n    if(role.permission == \'0\'){\n        return []\n    }else if(role.permission == \'1\'){\n        userIds.addAll(db.select(\"\"\"\n            select id from sys_user where is_del = 0 and office_id in (\n                select office_id from sys_role_office where role_id in (\n                    select role_id from sys_user_role where user_id = #{currentUserId}\n                )\n            )\n        \"\"\").map(it => it.id))\n    }else{\n        var officeId = db.selectValue(\"select office_id from sys_user where id = #{currentUserId}\")\n        var offices = []\n        offices.push(officeId)\n        var getOfficeId = (list,pid) => {\n            var ids = select t.id from list t where t.pid = pid;\n            for(it in ids){\n                offices.push(it.id)\n                getOfficeId(list,it.id)\n            }\n        }\n        getOfficeId(db.select(\'select id, pid from sys_office where is_del = 0 order by sort\'),officeId)\n        userIds.addAll(db.select(\"select id from sys_user where office_id in (#{offices})\").map(it => it.id))\n    }\n}\n\nreturn userIds');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/配置中心/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/配置中心/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"7e31035eb8d4471b9fc2923ea1d966c3\",\n  \"name\" : \"配置中心\",\n  \"type\" : \"function\",\n  \"parentId\" : \"0\",\n  \"path\" : \"configure\",\n  \"createTime\" : 1719394266395,\n  \"updateTime\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/配置中心/根据keyAndcondition获取数据值.ms', '{\n  \"properties\" : { },\n  \"id\" : \"copy1653111178446d65648\",\n  \"script\" : null,\n  \"groupId\" : \"7e31035eb8d4471b9fc2923ea1d966c3\",\n  \"name\" : \"根据keyAndcondition获取数据值\",\n  \"createTime\" : 1719394267041,\n  \"updateTime\" : 1653118303409,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getBykeyCondition\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"configureKey\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureCondition\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nvar configure = db.cache(`configure:${configureKey}${configureCondition}`).selectOne(\"\"\"\n     select configure_value from sys_configure where configure_key = #{configureKey} \n     ?{configureCondition, and configure_condition = #{configureCondition}}\n\"\"\")\n\nreturn configure == null ? \"\" : configure.get(\"configureValue\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/配置中心/根据keyLikeCondition获取数据值.ms', '{\n  \"properties\" : { },\n  \"id\" : \"copy1653112036134d44643\",\n  \"script\" : null,\n  \"groupId\" : \"7e31035eb8d4471b9fc2923ea1d966c3\",\n  \"name\" : \"根据keyLikeCondition获取数据值\",\n  \"createTime\" : 1719394267044,\n  \"updateTime\" : 1653118334978,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getLikeCondition\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"configureKey\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"configureCondition\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nvar configure = db.cache(`configure:${configureKey}${configureCondition}`).selectOne(\"\"\"\n     select configure_value from sys_configure where configure_key = #{configureKey} \n     ?{configureCondition, and configure_condition like concat(\'%\',#{configureCondition},\'%\')}\n\"\"\")\n\nreturn configure == null ? \"\" : configure.get(\"configureValue\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/配置中心/根据key获取数据值.ms', '{\n  \"properties\" : { },\n  \"id\" : \"3a21cd5fcd9b4e96b870a2268088266d\",\n  \"script\" : null,\n  \"groupId\" : \"7e31035eb8d4471b9fc2923ea1d966c3\",\n  \"name\" : \"根据key获取数据值\",\n  \"createTime\" : 1719394267047,\n  \"updateTime\" : 1653119091752,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/getBykey\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"configureKey\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nvar configure = db.cache(`configure:${configureKey}`).selectOne(\"\"\"\n     select configure_value from sys_configure where configure_key = #{configureKey}\n\"\"\")\nreturn configure == null ? \"\" : configure.get(\"configureValue\")');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/group.json', '{\n  \"properties\" : { },\n  \"id\" : \"f1893ea1928d488999804afc6c84e785\",\n  \"name\" : \"项目\",\n  \"type\" : \"function\",\n  \"parentId\" : \"0\",\n  \"path\" : \"/project\",\n  \"createTime\" : 1719394266400,\n  \"updateTime\" : 1713024590542,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"paths\" : [ ],\n  \"options\" : [ ]\n}');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/归档项目或取消归档.ms', '{\n  \"properties\" : { },\n  \"id\" : \"f8514c3cb7634c71a8160d4428884eab\",\n  \"script\" : null,\n  \"groupId\" : \"f1893ea1928d488999804afc6c84e785\",\n  \"name\" : \"归档项目或取消归档\",\n  \"createTime\" : 1719394267050,\n  \"updateTime\" : 1713024595523,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/archivedProject\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"archived_at\",\n    \"value\" : null,\n    \"description\" : \"归档时间\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : null,\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nvar userid = StpUtil.getLoginId()\nimport \'@/project/log\' as log\n\nvar val = db.transaction(() => {\n    if (archived_at == null) {\n        //项目取消归档\n        //推送取消归档的通知\n        db.table(\"project_tasks\").primary(\"project_id\").primary(\"archived_follow\").update({\n            project_id: project_id,\n            archived_follow: 1,\n            archived_at: null,\n            archived_follow: 0,\n\n        })\n        log(\'项目取消归档\')\n    } else {\n        //项目归档\n        db.table(\"project_tasks\").primary(\"project_id\").primary(\"archived_at\").update({\n            project_id: project_id,\n            archived_at: null,\n            archived_at: archived_at,\n            archived_follow: 1,\n        })\n        log(\'项目归档\')\n        //推送归档的通知\n    }\n\n    db.table(\"projects\").primary(\"id\").update({\n        id: project_id,\n        archived_at: archived_at,\n        archived_userid: userid\n    })\n\n});');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/检查项目.ms', '{\n  \"properties\" : { },\n  \"id\" : \"c92e6b48b9294e26b398c7bf271425bc\",\n  \"script\" : null,\n  \"groupId\" : \"f1893ea1928d488999804afc6c84e785\",\n  \"name\" : \"检查项目\",\n  \"createTime\" : 1719394267054,\n  \"updateTime\" : 1713024595607,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/use\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\n\nvar useProject = db.table(\"projects\").where().eq(\"id\", project_id).notNull(\"archived_at\").selectOne()\nif (useProject == null) {\n    exit 400, \'项目不存在或已归档\'\n}\nreturn useProject\n\n\n');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/添加工作流.ms', '{\n  \"properties\" : { },\n  \"id\" : \"631d203dee1042fea99547aa0168e4fb\",\n  \"script\" : null,\n  \"groupId\" : \"f1893ea1928d488999804afc6c84e785\",\n  \"name\" : \"添加工作流\",\n  \"createTime\" : 1719394267057,\n  \"updateTime\" : 1713024595683,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/addFlow\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"flows\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.util.Collection\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  }, {\n    \"name\" : \"projectId\",\n    \"value\" : null,\n    \"description\" : null,\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.Object\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport log\nlog.info(\"this project_id --> \" + projectId)\nlog.info(\"this flows --> \" + flows)\nvar val = db.transaction(() => {\n    //判断是否存在了工作流  \n    var projectFlowId\n    projectFlow = db.table(\"project_flows\").where().eq(\"project_id\", projectId).selectOne()\n    if (!projectFlow) {\n        log.info(\"项目流程不存在则创建\")\n        //创建工作流, 这样能不能等于还是未知\n        projectFlowId = db.table(\'project_flows\').insert({\n            project_id: projectId,\n            name: \'Default\',\n        })\n        if (!projectFlowId) {\n            exit 400, \'工作流创建失败\'\n        }\n    } else {\n        projectFlowId = projectFlow.id\n    }\n    //一个项目只存在一个流程\n    projectFlow = db.table(\"project_flows\").where().eq(\"project_id\", projectId).selectOne()\n\n    idc = []\n    upTaskList = []\n    ids = [];\n    hasStart = false //是否有开始状态\n    hasEnd = false //是否有结束状态\n    sort = -1 //排序\n\n    for (item in flows) {\n        sort = sort + 1\n        item_id = item.id\n        log.info(\'item_id： \' + item_id)\n        item_usertype = item.usertype\n        item_userids = item.userids //TODO 判断空值\n        item_userlimit = item.userlimit\n        item_turns = item.turns //TODO 判断空值\n        if (usertype == \'replace\' && item_userids.size() < 1) {\n            exit 400, \"状态[\" + item.name + \']设置错误，设置流转模式时必须填写状态负责人\'\n        }\n        if (usertype == \'merge\' && item_userids.size() < 1) {\n            exit 400, \"状态[\" + item.name + \']设置错误，设置剔除模式时必须填写状态负责人\'\n        }\n        if (userlimit && item_userids.size() < 1) {\n            exit 400, \"状态[\" + item.name + \']设置错误，设置限制负责人时必须填写状态负责人\'\n        }\n        log.info(\"projectFlowId is\" + projectFlowId)\n        log.info(\'turns is \' + item_turns)\n        log.info(\'item_userids \' + item_userids)\n\n        updateInsertResult = 0\n        //更新或插入数据库，怎么判断呢？\n        if (item.id > 0) { //更新操作\n            //更新数据库\n            ids.push(item.id) // 在这里直接添加了\n            result = db.table(\'project_flow_items\').primary(\"id\").save({\n                id: item.id,\n                flow_id: projectFlowId,\n                project_id: projectId,\n                name: item.name,\n                status: item.status,\n                sort: sort, // 暴力排序\n                usertype: item_usertype,\n                userlimit: item_userlimit,\n                turns: item_turns::string,\n                userids: item_userids,\n            })\n        } else { //新建操作\n            result = db.table(\'project_flow_items\').insert({\n                flow_id: projectFlowId,\n                project_id: projectId,\n                name: item.name,\n                status: item.status,\n                sort: sort, // 暴力排序\n                usertype: item_usertype,\n                userlimit: item_userlimit,\n                turns: item_turns::string,\n                userids: item_userids,\n            })\n            log.info(\"新建操作的返回值->\" + result)\n            ids.push(result)\n        }\n\n        // //插入数据库\n        // var insertId = db.table(\'project_flow_items\').insert({\n        //     name: item.name,\n        //     status: item.status,\n        //     sort: sort, // 暴力排序\n        //     flow_id: projectFlowId,\n        //     project_id: projectId,\n        //     usertype: item_usertype,\n        //     userlimit: item_userlimit,\n        //     turns: item_turns,\n        //     userids: item_userids,\n        // })\n\n        // log.info(\"updateInsertResult value :\" + updateInsertResult)\n        // if (updateInsertResult > 0) {\n        // ids.push(updateInsertResult)\n        // log.info(\"插入或更新成功 :\" + updateInsertResult + \"|\" + ids)\n        // $ids[] = $flow->id;\n        //         if ($flow->id != $id) {\n        //             $idc[$id] = $flow->id;\n        //         }\n        if (item.status == \'start\') {\n            hasStart = true\n        }\n        if (item.status == \'end\') {\n            hasEnd = true\n        }\n        //记录哪些任务的状态描述需要更新，插入为新值的不用管，新状态因为任务还没存在\n        if (item.id > 0) {\n            upTaskList.push({\n                flow_id: item.id,\n                statusStr: item.status + \"|\" + item.name\n            })\n            log.info(\"upTaskList\", upTaskList::string)\n        }\n        // }\n    }\n    if (!hasStart) {\n        exit 400, \'至少需要1个开始状态\'\n    }\n    if (!hasEnd) {\n        exit 400, \'至少需要1个结束状态\'\n    }\n\n    // 查询工作流项中没有的，进行删除操作\n    noInFlowItems = db.table(\"project_flow_items\").where().eq(\"project_id\", projectId).notIn(\"id\", ids).select()\n    for (item in noInFlowItems) {\n        result = db.table(\"project_flow_items\").where().eq(\"project_id\", projectId).eq(\"id\", item.id).delete()\n        log.info(\"删除不存在的项 result\" + result)\n    }\n\n    //修改任务表中该状态的状态显示\n    for (item in upTaskList) {\n        result = db.table(\"project_tasks\").primary(\"flow_item_id\").update({\n            flow_item_id: item.flow_id,\n            flow_item_name: item.statusStr\n        })\n        log.info(\"修改任务的状态显示\" + result)\n    }\n\n    //重新排序\n    ids = ids.sort((a, b) => a - b);\n    log.info(\"ids 重新排序\" + ids::string)\n\n    //修改成最新的\n    for (item in ids) {\n        db.table(\'project_flow_items\').primary(\'id\').update({\n            id: item,\n            turns: ids::string,\n        })\n    }\n\n\n\n    // //取出所有的item项\n    // flowItemList = db.table(\"project_flow_items\").where().eq(\"project_id\", projectId).orderBy(\"sort\").select()\n    // let itemIds = []\n    // for (item in flowItemList) {\n    //     itemIds.push(item.id)\n    // }\n\n    // log.info(\"itemIds\" + itemIds)\n    //将idc进行排序\n    // for (item in flowItemList) {\n    //排序\n    // itemIds = itemIds.sort((a, b) => a - b); //从小到大\n    // log.info(\"itemIds 重新排序\" + itemIds::string) //TODO 能不能放到循环外面呢\n    // foreach ($idc as $oid => $nid) {\n    //             if (in_array($oid, $turns)) {\n    //                 $turns = array_diff($turns, [$oid]);\n    //                 $turns[] = $nid;\n    //             }\n    //         }\n    //         if (!in_array($item->id, $turns)) {\n    //             $turns[] = $item->id;\n    //         }\n    //         $turns = array_values(array_filter(array_unique(array_intersect($turns, $itemIds))));\n    //         sort($turns);\n    //         $item->turns = $turns;\n    //更新\n    flowItemList = db.table(\"project_flow_items\").where().eq(\"project_id\", projectId).orderBy(\"sort\").select()\n    for (item in flowItemList) {\n        log.info(\"flowItemList  item ------\" + item)\n    }\n    // return flowItemList\n    projectFlow.project_flow_item = flowItemList\n    return projectFlow\n});\nreturn val\n\n\n//排序后再返回\n// //更新turns的值\n// log.info(\"ids\" + ids)\n// for (item in ids) {\n//     db.table(\'project_flow_items\').primary(\'id\').update({\n//         id: item,\n//         turns: ids::string,\n//     })\n// }\n\n// return val;\n\n// return []');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/function/项目/添加项目日志.ms', '{\n  \"properties\" : { },\n  \"id\" : \"9fe6c92a4e334d5198e3cacd1923cc1e\",\n  \"script\" : null,\n  \"groupId\" : \"f1893ea1928d488999804afc6c84e785\",\n  \"name\" : \"添加项目日志\",\n  \"createTime\" : 1719394267063,\n  \"updateTime\" : 1713024595760,\n  \"lock\" : null,\n  \"createBy\" : null,\n  \"updateBy\" : null,\n  \"path\" : \"/log\",\n  \"description\" : null,\n  \"returnType\" : null,\n  \"mappingPath\" : null,\n  \"parameters\" : [ {\n    \"name\" : \"detail\",\n    \"value\" : null,\n    \"description\" : \"日志内容\",\n    \"required\" : false,\n    \"dataType\" : \"String\",\n    \"type\" : \"java.lang.String\",\n    \"defaultValue\" : null,\n    \"validateType\" : null,\n    \"error\" : null,\n    \"expression\" : null,\n    \"children\" : null\n  } ]\n}\r\n================================\r\nimport \'cn.dev33.satoken.stp.StpUtil\';\nimport log\n\nvar userid = StpUtil.getLoginId()\nlog.info(\'userid is \' + userid)\n\nif (userid == null) {\n    log.info(\'userid is null\')\n    exit 400, \'用户未登录\'\n}\nlog.info(\'logDetail value：\' + logDetail)\n\nvar result = db.table(\'project_logs\').insert({\n    project_id: project_id,\n    column_id: 0,\n    task_id: 0,\n    userid: userid,\n    detail: logDetail\n})\n\nlog.info(\'日志插入\' + result)\nreturn result');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('/magic-api/task/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('magic-api/api/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('magic-api/datasource/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('magic-api/function/', 'this is directory');
INSERT INTO `magic_api_file_v2` (`file_path`, `file_content`) VALUES ('magic-api/task/', 'this is directory');
COMMIT;

SET FOREIGN_KEY_CHECKS = 1;
