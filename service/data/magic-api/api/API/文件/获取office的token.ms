{
  "properties" : { },
  "id" : "4d239358ed414d5193e77d041e4eb536",
  "script" : null,
  "groupId" : "7cc0839b044d4ab3a208aaf2142fbd7f",
  "name" : "获取office的token",
  "createTime" : 1717060653299,
  "updateTime" : 1716776089446,
  "lock" : "1",
  "createBy" : null,
  "updateBy" : null,
  "path" : "/office/token",
  "method" : "GET",
  "parameters" : [ {
    "name" : "documentFileType",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "documentTitle",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "documentKey",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "documentUrl",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigMode",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigLang",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigUserId",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigUserName",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigCustomizationUiTheme",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigCustomizationForcesave",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigCustomizationHelp",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "editorConfigCustomizationCallbackUrl",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  }, {
    "name" : "eventsOnDocumentReady",
    "value" : null,
    "description" : null,
    "required" : false,
    "dataType" : "String",
    "type" : null,
    "defaultValue" : null,
    "validateType" : null,
    "error" : null,
    "expression" : null,
    "children" : null
  } ],
  "options" : [ ],
  "requestBody" : "",
  "headers" : [ ],
  "paths" : [ ],
  "responseBody" : "{\n    \"code\": 200,\n    \"message\": \"success\",\n    \"data\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJkb2N1bWVudCI6eyJmaWxlVHlwZSI6ImRvY3giLCJ0aXRsZSI6IuacquWRveWQjSAoMykuZG9jeCIsImtleSI6ImRvY3gtMzU4NTMtMTcxMzI0OTQxNCIsInVybCI6Imh0dHA6Ly9uZ2lueC9hcGkvZmlsZS9jb250ZW50Lz9pZD0zNTg1MyZ0b2tlbj1ZSUc4QU5DOHEyUWZRTXE4SlRUTHBTV1pIajB2aGJOMG9sWjJ0bF8xVlo4eW16cFc5b0xKcW9QaGt1cTkxakNOQktXUVZKU2dXX2VRSnpMMV9pZWtQQzVQa0YtZ1hfNTk2Sy1OZXZMaW55Qm9EcXR2d2FWaURzV3VMZlZNUzlTQk9wOC0xc2huakMwIn0sImVkaXRvckNvbmZpZyI6eyJtb2RlIjoiZWRpdCIsImxhbmciOiJ6aCIsInVzZXIiOnsiaWQiOiIyNzE4IiwibmFtZSI6InJvbyoqKkBkb290YXNrLmNvbSJ9LCJjdXN0b21pemF0aW9uIjp7InVpVGhlbWUiOiJ0aGVtZS1jbGFzc2ljLWxpZ2h0IiwiZm9yY2VzYXZlIjoidHJ1ZSIsImhlbHAiOiJmYWxzZSJ9LCJjYWxsYmFja1VybCI6Imh0dHA6Ly9uZ2lueC9hcGkvZmlsZS9jb250ZW50L29mZmljZT9pZD0zNTg1MyZkb290YXNrLXRva2VuPVlJRzhBTkM4cTJRZlFNcThKVFRMcFNXWkhqMHZoYk4wb2xaMnRsXzFWWjh5bXpwVzlvTEpxb1Boa3VxOTFqQ05CS1dRVkpTZ1dfZVFKekwxX2lla1BDNVBrRi1nWF81OTZLLU5ldkxpbnlCb0RxdHZ3YVZpRHNXdUxmVk1TOVNCT3A4LTFzaG5qQzAifSwiZXZlbnRzIjp7Im9uRG9jdW1lbnRSZWFkeSI6ImZ1bmN0aW9uICgpIHsgW25hdGl2ZSBjb2RlXSB9In19.s6NPbLhYL3Aaf3SDct5WX2xU6t1j98ymkDYTQARZzBo\",\n    \"timestamp\": 1714014539164,\n    \"executeTime\": 4\n}",
  "description" : null,
  "requestBodyDefinition" : null,
  "responseBodyDefinition" : null
}
================================
import cn.hutool.jwt.JWTUtil;
import log;
import request;
var secret = "10000";

var payload = {
    "document": {
        "fileType": documentFileType,
        "title": documentTitle,
        "key": documentKey,
        "url": documentUrl
    },
    "editorConfig": {
        "mode": editorConfigMode,
        "lang": editorConfigLang,
        "user": {
            "id": editorConfigUserId,
            "name": editorConfigUserName
        },
        "customization": {
            "uiTheme": editorConfigCustomizationUiTheme,
            "forcesave": editorConfigCustomizationForcesave,
            "help": editorConfigCustomizationHelp
        },
        "callbackUrl": editorConfigCustomizationCallbackUrl
    },
    "events": {
        "onDocumentReady": eventsOnDocumentReady
    }
};

try {
    return {
        "token": JWTUtil.createToken(payload, secret.getBytes())
    };
} catch (e) {
    return "";
}